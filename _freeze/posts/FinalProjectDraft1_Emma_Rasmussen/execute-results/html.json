{
  "hash": "528848ade54449f9d3e941cfc66eb6ec",
  "result": {
    "markdown": "---\ntitle: \"FinalProject\"\nauthor: \"Emma Rasmussen\"\ndescription: \"FinalProjectDRAFT1\"\ndate: \"08/26/2022\"\nformat:\n  html:\n    toc: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - final project\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(googlesheets4)\nlibrary(lubridate)\nlibrary(stringr)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\nReading In the Data\n\n::: {.cell}\n\n```{.r .cell-code}\n#creating a vector of new column names\nmass_names<- c(\"incident_id\", \"incident_date\", \"state\", \"city_or_county\", \"address\", \"number_killed\", \"number_injured\", \"delete\")\n\n#creating a function to read in the data sets with new column names, skip the first row, and remove the \"operation\" column which contains links to news articles in original data source, and creating a \"Year\" column for ease of analysis\nread_shootings<-function(sheet_name){read_sheet(\"https://docs.google.com/spreadsheets/d/1rCnIYPQSkcZDCulp5KXAxmZUBad4QtrERi4_7tUMXqs/edit#gid=10931567\", \n                                                sheet=sheet_name,\n                                                col_names=mass_names, \n                                                skip=1) %>%\n    mutate(\"YearSheet\"=sheet_name) %>% \n    mutate(Year=recode(YearSheet, \"MassShootings2014\"=\"2014\", \"MassShootings2015\"=\"2015\", \"MassShootings2016\"=\"2016\", \"MassShootings2017\"=\"2017\", \"MassShootings2018\"=\"2018\", \"MassShootings2019\"=\"2019\", \"MassShootings2020\"=\"2020\", \"MassShootings2021\"=\"2021\", \"MassShootings2022\"=\"2022\")) %>% \n  select(-delete, -YearSheet)\n           }\n\n#using purrr/map_dfr to join data sheets for 2014 through 2021, applying the function read_shootings for consistent formatting\nmass_shootings_all <- map_dfr(\n  sheet_names(\"https://docs.google.com/spreadsheets/d/1rCnIYPQSkcZDCulp5KXAxmZUBad4QtrERi4_7tUMXqs/edit#gid=10931567\")[1:9],\n  read_shootings)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `gs4_auth()`:\n! Can't get Google credentials.\nℹ Are you running googlesheets4 in a non-interactive session? Consider:\n• Call `gs4_deauth()` to prevent the attempt to get credentials.\n• Call `gs4_auth()` directly with all necessary specifics.\nℹ See gargle's \"Non-interactive auth\" vignette for more details:\nℹ <https://gargle.r-lib.org/articles/non-interactive-auth.html>\n```\n:::\n\n```{.r .cell-code}\n#sanity check\nmass_shootings_all\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'mass_shootings_all' not found\n```\n:::\n:::\n\nThe number of rows in the df is equal to the sum of the rows from the original google sheets data (-9 for column names in google sheets)\n\n::: {.cell}\n\n```{.r .cell-code}\n#Can now use \"year\" column to easily analyze data by year\nfilter(mass_shootings_all, Year==\"2014\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(mass_shootings_all, Year == \"2014\"): object 'mass_shootings_all' not found\n```\n:::\n\n```{.r .cell-code}\n#Counting number of shootings per year and generating a new table\nmass_shootings_all_hist<-mass_shootings_all %>%\n    group_by(Year) %>%\n    summarise(Count = n())\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in group_by(., Year): object 'mass_shootings_all' not found\n```\n:::\n\n```{.r .cell-code}\n#creating plot of shootings/year\nggplot(mass_shootings_all_hist, aes(x=Year, y=Count))+\n  geom_bar(stat=\"identity\")+\n  labs(title=\"Mass Shootings 2014-2022*\", caption=\"*2022 data goes up to August 27, 2022\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(mass_shootings_all_hist, aes(x = Year, y = Count)): object 'mass_shootings_all_hist' not found\n```\n:::\n\n```{.r .cell-code}\n#converting S3: POSIXc to date format\nmass_shootings_all$incident_date_new<-as.Date(mass_shootings_all$incident_date)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in as.Date(mass_shootings_all$incident_date): object 'mass_shootings_all' not found\n```\n:::\n\n```{.r .cell-code}\nmass_shootings_all\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'mass_shootings_all' not found\n```\n:::\n\n```{.r .cell-code}\n#creating a month column and converting to factors\nmass_shootings_all<-mass_shootings_all %>% \n  mutate(month=as.factor(month(incident_date_new)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in mutate(., month = as.factor(month(incident_date_new))): object 'mass_shootings_all' not found\n```\n:::\n\n```{.r .cell-code}\n#creating a new table with month data\nmass_shootings_all_months<-mass_shootings_all %>%\n    group_by(month) %>%\n    summarise(Count = n())\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in group_by(., month): object 'mass_shootings_all' not found\n```\n:::\n\n```{.r .cell-code}\nmass_shootings_all_months\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'mass_shootings_all_months' not found\n```\n:::\n\n```{.r .cell-code}\n#creating plot by month\nggplot(mass_shootings_all_months, aes(x=month, y=Count))+geom_bar(stat=\"identity\")+labs(title=\"Mass Shootings 2014-2022 By Month\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(mass_shootings_all_months, aes(x = month, y = Count)): object 'mass_shootings_all_months' not found\n```\n:::\n:::\n\nIn addition to mass shootings increasing over time, it appears that shootings could be correlated with temperature/season given the data set when filtered by month is highest in summer months an lowest in winter months. \n\nI am curious if a less seasonally varying state would have the same distrubtion. Below I create the same plot for FL and MA\n\n::: {.cell}\n\n```{.r .cell-code}\n#Doing above for 1 State\n#creating a new table with month data for FL\nmass_shootings_all_florida<-filter(mass_shootings_all, state==\"Florida\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(mass_shootings_all, state == \"Florida\"): object 'mass_shootings_all' not found\n```\n:::\n\n```{.r .cell-code}\nmass_shootings_all_florida\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'mass_shootings_all_florida' not found\n```\n:::\n\n```{.r .cell-code}\nmass_shootings_all_months_FL<-mass_shootings_all_florida %>%\n    group_by(month, .drop=FALSE) %>%\n    summarise(Count = n())\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in group_by(., month, .drop = FALSE): object 'mass_shootings_all_florida' not found\n```\n:::\n\n```{.r .cell-code}\nmass_shootings_all_months_FL\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'mass_shootings_all_months_FL' not found\n```\n:::\n\n```{.r .cell-code}\nggplot(mass_shootings_all_months_FL, aes(x=month, y=Count))+geom_bar(stat=\"identity\")+labs(title=\"Mass Shootings 2014-2022 By Month in Florida\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(mass_shootings_all_months_FL, aes(x = month, y = Count)): object 'mass_shootings_all_months_FL' not found\n```\n:::\n\n```{.r .cell-code}\n#Doing same as FL for MA\nmass_shootings_all_mass<-filter(mass_shootings_all, state==\"Massachusetts\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(mass_shootings_all, state == \"Massachusetts\"): object 'mass_shootings_all' not found\n```\n:::\n\n```{.r .cell-code}\nmass_shootings_all_mass\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'mass_shootings_all_mass' not found\n```\n:::\n\n```{.r .cell-code}\nmass_shootings_all_months_MA<-mass_shootings_all_mass %>%\n    group_by(month, .drop=FALSE) %>%\n    summarise(Count = n())\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in group_by(., month, .drop = FALSE): object 'mass_shootings_all_mass' not found\n```\n:::\n\n```{.r .cell-code}\nmass_shootings_all_months_MA\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'mass_shootings_all_months_MA' not found\n```\n:::\n\n```{.r .cell-code}\nggplot(mass_shootings_all_months_MA, aes(x=month, y=Count))+geom_bar(stat=\"identity\")+labs(title=\"Mass Shootings 2014-2022 By Month in Massachusetts\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(mass_shootings_all_months_MA, aes(x = month, y = Count)): object 'mass_shootings_all_months_MA' not found\n```\n:::\n:::\n\nGoing forward, I think I will try to create these plots for different states to see if this trend holds true across different states. I am also curious if i can find a dataset with typical temp ranges/state and seeing if there is correlation between temp variation and mass shootings.Am also curious to figure out what kind of distribution best describes the graph with all states.\n\nWhats going on??? rant:\nThere are a number of confounding factors that could explain the apparent correlation with season/temp- people more/less likely to leave the house based on weather, more public gatherings during seasons with higher temps... also wondering if covid affects this. I could create the same graph by state and year (but there probaly isnt enough events to see a correlation, but maybe for a state with a high population?) And wondering if the average number killed also increases with higher temperatures as there may be more opportunities/gatherings of people\n\n::: {.cell}\n\n```{.r .cell-code}\nn_distinct(mass_shootings_all, \"Year\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in list2(...): object 'mass_shootings_all' not found\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}