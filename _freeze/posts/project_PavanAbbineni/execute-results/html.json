{
  "hash": "010e8c521770e6b140a612f0e86fdd40",
  "result": {
    "markdown": "---\ntitle: \"Final Project\"\nauthor: \"Pavan Datta Abbineni \"\ndesription: \"Final Project\"\ndate: \"08/28/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - Final Project\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(magrittr)\nlibrary(tidyverse)\nlibrary(\"viridis\")\nlibrary(glue)\nlibrary(leaflet)\nlibrary(ggplot2)\nlibrary(plotrix)\nlibrary(lubridate)\nlibrary(scales)\nlibrary(plyr)\nrequire(mosaic)\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n\n\n\n### Introduction\nAccording to the World Health Organization (WHO) stroke is the 2nd leading cause of death globally, responsible for approximately 11% of total deaths. This dataset is used to predict whether a patient is likely to get stroke based on the input parameters like gender, age, various diseases, and smoking status. Each row in the data provides relavant information about the patient.\n\n### Dataset \n\n#### About the Data\nData for this project originates from the Electronic Health Record (EHR) controlled by McKinsey & Company. This data is a well refined and filtered dataset of the original dataset which was collected over a course of several years in Bangladesh. \n\n#### Project Goals\n\nMy main objective in this project is focused on finding the best lifestyle choices with the help of the attribute analysis in this dataset, inorder to prevent stroke.\n\n#### Import the data\n\nThe HealthCareStrokeDataset is imported into R for cleaning, wrangling,exploration and analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhealthCareStrokeData<-read_csv(\"_data/healthcare-dataset-stroke-data.csv\",\n                        show_col_types = FALSE)\n```\n:::\n\n\n#### Attribute Information\n\n* id (int, categorical): unique identifier\n* gender (str, categorical): “Male”, “Female” or “Other”\n* age (int, numerical): age of the patient\n* hypertension (int, categorical): 0 if the patient doesn’t have hypertension, 1 if the patient has hypertension\n* heart_disease (int, categorical): 0 if the patient doesn’t have any heart diseases, 1 if the patient has a heart disease\n* ever_married (str, categorical): “No” or “Yes”\n* work_type (str, categorical): “children”, “Govt_jov”, “Never_worked”, “Private” or “Self-employed”\n* Residence_type (str, categorical): “Rural” or “Urban”\n* avg_glucose_level (int, numerical): average glucose level in blood\n* bmi (str, numerical): body mass index*\n* smoking_status (str, categorical): “formerly smoked”, “never smoked”, “smokes” or “Unknown”*\n* stroke (int, categorical): 1 if the patient had a stroke or 0 if not\n\nNote: “Unknown, NA” in smoking_status and bmi means that the information is unavailable for this\npatient\n\n#### Tidy the data\n\nTo learn more about the dataset let's get an idea of the column names, data dimensions, statistical summary comprised of min,max,median,mean and interquartile range.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(healthCareStrokeData)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       id           gender               age         hypertension    \n Min.   :   67   Length:5110        Min.   : 0.08   Min.   :0.00000  \n 1st Qu.:17741   Class :character   1st Qu.:25.00   1st Qu.:0.00000  \n Median :36932   Mode  :character   Median :45.00   Median :0.00000  \n Mean   :36518                      Mean   :43.23   Mean   :0.09746  \n 3rd Qu.:54682                      3rd Qu.:61.00   3rd Qu.:0.00000  \n Max.   :72940                      Max.   :82.00   Max.   :1.00000  \n heart_disease     ever_married        work_type         Residence_type    \n Min.   :0.00000   Length:5110        Length:5110        Length:5110       \n 1st Qu.:0.00000   Class :character   Class :character   Class :character  \n Median :0.00000   Mode  :character   Mode  :character   Mode  :character  \n Mean   :0.05401                                                           \n 3rd Qu.:0.00000                                                           \n Max.   :1.00000                                                           \n avg_glucose_level     bmi            smoking_status         stroke       \n Min.   : 55.12    Length:5110        Length:5110        Min.   :0.00000  \n 1st Qu.: 77.25    Class :character   Class :character   1st Qu.:0.00000  \n Median : 91.89    Mode  :character   Mode  :character   Median :0.00000  \n Mean   :106.15                                          Mean   :0.04873  \n 3rd Qu.:114.09                                          3rd Qu.:0.00000  \n Max.   :271.74                                          Max.   :1.00000  \n```\n:::\n\n```{.r .cell-code}\ndim(healthCareStrokeData)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5110   12\n```\n:::\n\n```{.r .cell-code}\nnames(healthCareStrokeData)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"id\"                \"gender\"            \"age\"              \n [4] \"hypertension\"      \"heart_disease\"     \"ever_married\"     \n [7] \"work_type\"         \"Residence_type\"    \"avg_glucose_level\"\n[10] \"bmi\"               \"smoking_status\"    \"stroke\"           \n```\n:::\n:::\n\n\nTo get a further insight into the dataset lets print in three different ways \n\n* Head of the dataset,\n* Tail of the dataset and\n* Randomly print 'n' elements from the dataset.\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(healthCareStrokeData)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 12\n     id gender   age hypertension heart_…¹ ever_…² work_…³ Resid…⁴ avg_g…⁵ bmi  \n  <dbl> <chr>  <dbl>        <dbl>    <dbl> <chr>   <chr>   <chr>     <dbl> <chr>\n1  9046 Male      67            0        1 Yes     Private Urban      229. 36.6 \n2 51676 Female    61            0        0 Yes     Self-e… Rural      202. N/A  \n3 31112 Male      80            0        1 Yes     Private Rural      106. 32.5 \n4 60182 Female    49            0        0 Yes     Private Urban      171. 34.4 \n5  1665 Female    79            1        0 Yes     Self-e… Rural      174. 24   \n6 56669 Male      81            0        0 Yes     Private Urban      186. 29   \n# … with 2 more variables: smoking_status <chr>, stroke <dbl>, and abbreviated\n#   variable names ¹​heart_disease, ²​ever_married, ³​work_type, ⁴​Residence_type,\n#   ⁵​avg_glucose_level\n# ℹ Use `colnames()` to see all variable names\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntail(healthCareStrokeData)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 12\n     id gender   age hypertension heart_…¹ ever_…² work_…³ Resid…⁴ avg_g…⁵ bmi  \n  <dbl> <chr>  <dbl>        <dbl>    <dbl> <chr>   <chr>   <chr>     <dbl> <chr>\n1 14180 Female    13            0        0 No      childr… Rural     103.  18.6 \n2 18234 Female    80            1        0 Yes     Private Urban      83.8 N/A  \n3 44873 Female    81            0        0 Yes     Self-e… Urban     125.  40   \n4 19723 Female    35            0        0 Yes     Self-e… Rural      83.0 30.6 \n5 37544 Male      51            0        0 Yes     Private Rural     166.  25.6 \n6 44679 Female    44            0        0 Yes     Govt_j… Urban      85.3 26.2 \n# … with 2 more variables: smoking_status <chr>, stroke <dbl>, and abbreviated\n#   variable names ¹​heart_disease, ²​ever_married, ³​work_type, ⁴​Residence_type,\n#   ⁵​avg_glucose_level\n# ℹ Use `colnames()` to see all variable names\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrandomlySelectedData <- healthCareStrokeData[sample(1:nrow(healthCareStrokeData), 5), ]\nrandomlySelectedData\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 12\n     id gender   age hypertension heart_…¹ ever_…² work_…³ Resid…⁴ avg_g…⁵ bmi  \n  <dbl> <chr>  <dbl>        <dbl>    <dbl> <chr>   <chr>   <chr>     <dbl> <chr>\n1 48425 Male   21               0        0 No      Private Rural      89.3 23.4 \n2 22706 Female  0.88            0        0 No      childr… Rural      88.1 15.5 \n3 26154 Male   56               0        0 Yes     Private Rural      82.4 34.5 \n4 49815 Female 17               0        0 No      Govt_j… Rural     116.  23.3 \n5 60675 Female 48               1        0 Yes     Govt_j… Rural     221.  57.2 \n# … with 2 more variables: smoking_status <chr>, stroke <dbl>, and abbreviated\n#   variable names ¹​heart_disease, ²​ever_married, ³​work_type, ⁴​Residence_type,\n#   ⁵​avg_glucose_level\n# ℹ Use `colnames()` to see all variable names\n```\n:::\n:::\n\n\nWe can see that each row in our dataset is a unique observation which represents a unique persons lifestyle and if they had a stroke or not.\n\nEach variable is seen as one consistent data type, thus some variables are numeric and some are categorical. The datatype of each column is elaborated below.\n\n* Categorical : Gender, Ever_married, Work_type, Residence_type, smoking_status\n* Categorical ( Boolean ) : Hypertension, Heart_disease, stroke_label\n* Quantitative (continuous) :  avg_glucose_level, bmi\n* Quantitative (discrete) : age\n\nLet's check for any na values in our dataset.\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(healthCareStrokeData))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n\nNext lets check our dataset for any duplicate rows.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnOccur <- data.frame(table(healthCareStrokeData$id))\nnOccur[nOccur$Freq > 1,]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] Var1 Freq\n<0 rows> (or 0-length row.names)\n```\n:::\n:::\n\nFrom the above result we can confirm that there are no duplicates in our dataset.\n\n\nFrom the datatype of bmi we can see that it is in string format, we need to convert into numeric.\n\n::: {.cell}\n\n```{.r .cell-code}\nhealthCareStrokeData$bmi <- as.numeric(healthCareStrokeData$bmi)\n```\n:::\n\nAs we can see there are NA values introduced by coercion, so let's drop all the NA values before going to the next step.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(healthCareStrokeData))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 201\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhealthCareStrokeData <- na.omit(healthCareStrokeData)\n```\n:::\n\n\nAs our main interest in this project are only the people who had a stroke lets filter our dataset to only contain who had a stroke.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhealthCareOnlyStroke <- healthCareStrokeData %>% filter(stroke == 1)\n```\n:::\n\n\nLet's do a , statistical summary comprised of min,max,median,mean and interquartile range,column names, data dimensions for our target dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(healthCareOnlyStroke)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       id           gender               age         hypertension   \n Min.   :  210   Length:209         Min.   :14.00   Min.   :0.0000  \n 1st Qu.:17308   Class :character   1st Qu.:58.00   1st Qu.:0.0000  \n Median :36857   Mode  :character   Median :70.00   Median :0.0000  \n Mean   :37546                      Mean   :67.71   Mean   :0.2871  \n 3rd Qu.:56939                      3rd Qu.:78.00   3rd Qu.:1.0000  \n Max.   :72918                      Max.   :82.00   Max.   :1.0000  \n heart_disease    ever_married        work_type         Residence_type    \n Min.   :0.0000   Length:209         Length:209         Length:209        \n 1st Qu.:0.0000   Class :character   Class :character   Class :character  \n Median :0.0000   Mode  :character   Mode  :character   Mode  :character  \n Mean   :0.1914                                                           \n 3rd Qu.:0.0000                                                           \n Max.   :1.0000                                                           \n avg_glucose_level      bmi        smoking_status         stroke \n Min.   : 56.11    Min.   :16.90   Length:209         Min.   :1  \n 1st Qu.: 80.43    1st Qu.:26.40   Class :character   1st Qu.:1  \n Median :106.58    Median :29.70   Mode  :character   Median :1  \n Mean   :134.57    Mean   :30.47                      Mean   :1  \n 3rd Qu.:196.92    3rd Qu.:33.70                      3rd Qu.:1  \n Max.   :271.74    Max.   :56.60                      Max.   :1  \n```\n:::\n\n```{.r .cell-code}\ndim(healthCareOnlyStroke)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 209  12\n```\n:::\n:::\n\n### Data Analysis and Visualization\nNow that our dataset has been imported, cleaned, and tidied it can be used for further visualization and analysis. Let's begin our analysis with the most basic questions like the mean and median of our age, bmi and avg_glucose_level. \n\nAs stated above the main variables I'm going to focus on are : \n* age\n* bmi and\n* avg_glucose_level\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstrokeLabels  = table(healthCareStrokeData$stroke)\npie(strokeLabels,labels = strokeLabels, main = \"Number of people who had a stroke\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/stroke-piechart-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhistogramStrokeData<-healthCareStrokeData\nhistogramStrokeData$stroke <- factor(histogramStrokeData$stroke,\n                         levels = c(0,1),\n                         labels = c(\"Didn't have a stroke\",\"Had a Stroke\"))\nggplot(histogramStrokeData, aes(stroke,))+\n  geom_bar(fill=c(\"aquamarine2\",\"pink3\")) +\n  theme_bw()+\n  theme(plot.title = element_text(hjust = 0.5))+\n  xlab(\"Stroke Analysis\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/stroke-piechart-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfavstats((healthCareStrokeData %>% filter(stroke == 0))$age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  min Q1 median Q3 max     mean       sd    n missing\n 0.08 24     43 59  82 41.76045 22.26813 4700       0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfavstats((healthCareStrokeData %>% filter(stroke == 1))$age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n min Q1 median Q3 max     mean       sd   n missing\n  14 58     70 78  82 67.71292 12.40285 209       0\n```\n:::\n:::\n\n#### Effect of Age\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstrokeAgeLabels<-(healthCareStrokeData %>% filter(stroke == 1))$age\nhist(strokeAgeLabels,\n     main = \"Age Histogram of all the people who had strokes\",\n     xlab = \"Age\",\n     col = \"white\",\n     border = 4)\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/strokeAge-histogram-1.png){width=672}\n:::\n:::\n\nWe can see that the risk of having a stroke is a lot higher in the 70-80 age bracket.But age is something we cannot overcome so let's have a detailed analysis of other attributes.\n\n#### Effect of heart_disease\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatasetForHeartAnalysis<-healthCareStrokeData\ndatasetForHeartAnalysis$heart_disease[datasetForHeartAnalysis$heart_disease == 0]<-\"No Heart Disease\"\ndatasetForHeartAnalysis$heart_disease[datasetForHeartAnalysis$heart_disease == 1]<-\"Has Heart Disease\"\ndatasetForHeartAnalysis$stroke[healthCareStrokeData$stroke == 0]<-\"Didn't have a Stroke\"\ndatasetForHeartAnalysis$stroke[healthCareStrokeData$stroke == 1]<-\"Had a Stroke\"\n\ndatasetForHeartAnalysis %>% filter(stroke==\"Had a Stroke\")%>% \n                        ggplot(aes(age, fill=heart_disease)) + \n                        geom_density(alpha=0.3) + \n                        ggtitle(\"Stroke by Age and heart_disease\") + \n                        xlab(\"Age\") + \n                        ylab(\"Density\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/heartDisease-ggplot-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = datasetForHeartAnalysis,\n       aes(x=heart_disease,\n           fill=stroke,)) + \n          geom_bar() +\n          ggtitle(\"Stacked barchart for Heart Diseases v/s Stroke\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/heartDisease-ggplot-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntableDatasetForHeartAnalysis<-datasetForHeartAnalysis%>%filter(heart_disease==\"Has Heart Disease\")\ntable(tableDatasetForHeartAnalysis$stroke)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nDidn't have a Stroke         Had a Stroke \n                 203                   40 \n```\n:::\n\n```{.r .cell-code}\ntableDatasetForHeartAnalysis<-datasetForHeartAnalysis%>%filter(heart_disease==\"No Heart Disease\")\ntable(tableDatasetForHeartAnalysis$stroke)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nDidn't have a Stroke         Had a Stroke \n                4497                  169 \n```\n:::\n:::\n\nWe have a 16% chance to have a stroke if you have a heart disease and a 3.6% chance to have a stroke if you don't have a heart disease.\n\nFrom the above data/plots it is clearly evident that the people with heart diseases are more likely to have a stroke as they age.\n\n#### Effect of hypertension\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatasetForHypertensionAnalysis<-healthCareStrokeData\ndatasetForHypertensionAnalysis$hypertension[datasetForHypertensionAnalysis$hypertension == 0]<-\"No Hypertension\"\ndatasetForHypertensionAnalysis$hypertension[datasetForHypertensionAnalysis$hypertension == 1]<-\"Has Hypertension\"\ndatasetForHypertensionAnalysis$stroke[datasetForHypertensionAnalysis$stroke == 0]<-\"Didn't have a Stroke\"\ndatasetForHypertensionAnalysis$stroke[datasetForHypertensionAnalysis$stroke == 1]<-\"Had a Stroke\"\n\ndatasetForHypertensionAnalysis %>% filter(stroke==\"Had a Stroke\")%>% \n                        ggplot(aes(age, fill=hypertension)) + \n                        geom_density(alpha=0.3) + \n                        ggtitle(\"Stroke by Age and hypertension \") + \n                        xlab(\"Age\") + \n                        ylab(\"Density\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/hypertension-ggplot-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = datasetForHypertensionAnalysis,\n       aes(x=hypertension,\n           fill=stroke,stat=\"count\")) + \n          geom_bar() +\n          ggtitle(\"Stacked barchart for Heart Diseases v/s Stroke\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/hypertension-ggplot-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntableDatasetForHypertension<-datasetForHypertensionAnalysis%>%filter(hypertension==\"Has Hypertension\")\ntable(tableDatasetForHypertension$stroke)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nDidn't have a Stroke         Had a Stroke \n                 391                   60 \n```\n:::\n\n```{.r .cell-code}\ntableDatasetForHypertension<-datasetForHypertensionAnalysis%>%filter(hypertension==\"No Hypertension\")\ntable(tableDatasetForHypertension$stroke)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nDidn't have a Stroke         Had a Stroke \n                4309                  149 \n```\n:::\n:::\n\nWe have a 13.33% chance to have a stroke if you have a heart disease and a 3.34% chance to have a stroke if you don't hypertension\n\nWe can see that we are at a higher chance ( approximately 4 times ) of having a stroke if you have hypertension.\n\nWhat if a person has both hypertension and heart disease?\n\n::: {.cell}\n\n```{.r .cell-code}\ntableForDualAnalysis<-healthCareStrokeData%>%filter(hypertension==1 & heart_disease==1)\ntable(tableForDualAnalysis$stroke)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n 0  1 \n47 11 \n```\n:::\n:::\n\nWe can see that a person having both hypertension and heart disease has a 19% chance to have a stroke. \n\n#### Effect of bmi\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(healthCareStrokeData$bmi,col=viridis(12,0.5),xlab = \"Average Glucose Level\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/bmi-ggplot-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndatasetForbmiAnalysis<-healthCareStrokeData\ndatasetForbmiAnalysis$stroke[datasetForbmiAnalysis$stroke == 0]<-\"No Stroke\"\ndatasetForbmiAnalysis$stroke[datasetForbmiAnalysis$stroke == 1]<-\"Had a Stroke\"\ndatasetForbmiAnalysis %>% ggplot(aes(bmi, fill=stroke)) + geom_density(alpha=0.3) + ggtitle(\"Stroke by bmi\") + xlab(\"BMI\") + ylab(\"Density\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/bmi-ggplot-2.png){width=672}\n:::\n\n```{.r .cell-code}\nhealthCareOnlyStroke %>% ggplot(aes(age, bmi, color=gender)) + geom_point() + ggtitle(\"Stroke and bmi over Time\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/bmi-ggplot-3.png){width=672}\n:::\n:::\n\nWe can see that if you have a bmi greater than 25( overweight ) then you are more likely to have a stroke.\n\n#### Effect of Glucose Level\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(healthCareStrokeData$avg_glucose_level,col=viridis(12,0.5),xlab = \"Average Glucose Level\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/glucose-ggplot-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndatasetForGlucoseAnalysis<-healthCareStrokeData\ndatasetForGlucoseAnalysis$stroke[datasetForGlucoseAnalysis$stroke == 0]<-\"No Stroke\"\ndatasetForGlucoseAnalysis$stroke[datasetForGlucoseAnalysis$stroke == 1]<-\"Had a Stroke\"\ndatasetForGlucoseAnalysis %>% ggplot(aes(avg_glucose_level, fill=stroke)) + geom_density(alpha=0.3) + ggtitle(\"Stroke by glucoselevel\") + xlab(\"avg_glucose_level\") + ylab(\"Density\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/glucose-ggplot-2.png){width=672}\n:::\n:::\n\nSimilar to the case of bmi the chances of having a stroke is higher at higher glucose levels.\n\n#### Effect of Smoking\n\n::: {.cell}\n\n```{.r .cell-code}\ndatasetForSmokingAnalysis<-healthCareStrokeData\ndatasetForSmokingAnalysis$stroke[datasetForSmokingAnalysis$stroke == 0]<-\"No Stroke\"\ndatasetForSmokingAnalysis$stroke[datasetForSmokingAnalysis$stroke == 1]<-\"Had a Stroke\"\n\nggplot(datasetForSmokingAnalysis,\n       aes(x=smoking_status,\n           fill=stroke,)) +\n  geom_bar() + ggtitle(\"Stacked barchart for Smoking Status v/s Stroke\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/smoking-ggplot-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndatasetForSmokingAnalysis %>% \n  filter(stroke == \"Had a Stroke\" & age<70 &smoking_status!=\"Unknown\")%>%\n  ggplot(aes(age, fill=smoking_status)) + \n  geom_density(alpha=0.3) + \n  ggtitle(\"Stroke by Age and Smoking Status\") + \n  xlab(\"Smoking Status\") + ylab(\"Density\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/smoking-ggplot-2.png){width=672}\n:::\n:::\n\nFrom the plot we can conclude that former smokers and a person who smokes is more likely to have a stroke when compared to a person who doesn't smoke.\n\n#### Effect of Gender\n\n::: {.cell}\n\n```{.r .cell-code}\nhealthCareOnlyStroke  %>% ggplot(aes(age, fill=gender)) + geom_density(alpha=0.3) + ggtitle(\"Stroke by Age in Male and Female\")\n```\n\n::: {.cell-output-display}\n![](project_PavanAbbineni_files/figure-html/gender-ggplot-1.png){width=672}\n:::\n:::\n\nWe can see that as the age increases women tend to be prone to having a stroke at an earlier age while men develop it over time.\n\n### Conclusion\n\nNow that we have a detailed analysis of all the indicators that cause a stroke in our dataset, you can check for yourself how close you are to having a stroke. One thing we have no control over is age as everyone ages, but the rest of the attributes give us a lucid understanding of what to do to decrease our chances of having a stroke. A good start would be to quit smoking, Manage Stress, Normalize bmi, having low glucose level and having a better heart health.\n\nI hope this study helps you make a data-driven decision about your health and lifestyle in order to prevent strokes.\n\n\n### Bibliography/ References\n\n[1] https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=9264165\n[2] https://ggplot2.tidyverse.org\n[3] https://r-graph-gallery.com/stacked-barplot.html\n[4] https://education.rstudio.com/learn/beginner/\n",
    "supporting": [
      "project_PavanAbbineni_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}