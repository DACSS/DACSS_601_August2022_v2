<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Saaradhaa M">
<meta name="dcterms.date" content="2022-08-31">
<meta name="description" content="Crime, Drug Usage and Demographics">

<title>- Final Project [WIP] Update 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="styles.css">
<meta name="twitter:title" content="- Final Project [WIP] Update 3">
<meta name="twitter:description" content="Crime, Drug Usage and Demographics">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <img src="../images/UMass White Wordmark Horiz.png" alt="">
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/DACSS_601_August2022_v2">August 2022 Posts</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">Contributors</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss">DACSS</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS/DACSS_601_August2022_v2"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#read-in-data" id="toc-read-in-data" class="nav-link" data-scroll-target="#read-in-data">Read In Data</a></li>
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data">Tidy Data</a></li>
  <li><a href="#analysis-question-1" id="toc-analysis-question-1" class="nav-link" data-scroll-target="#analysis-question-1">Analysis: Question 1</a></li>
  <li><a href="#additional-analysis-question-1" id="toc-additional-analysis-question-1" class="nav-link" data-scroll-target="#additional-analysis-question-1">Additional Analysis: Question 1</a></li>
  <li><a href="#analysis-question-2" id="toc-analysis-question-2" class="nav-link" data-scroll-target="#analysis-question-2">Analysis: Question 2</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography">Bibliography</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final Project [WIP] Update 3</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">final_project</div>
    <div class="quarto-category">tidyverse</div>
    <div class="quarto-category">ggplot2</div>
    <div class="quarto-category">summarytools</div>
    <div class="quarto-category">lubridate</div>
    <div class="quarto-category">sf</div>
  </div>
  </div>

<div>
  <div class="description">
    Crime, Drug Usage and Demographics
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Saaradhaa M </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 31, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chisq.posthoc.test)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapview)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Brooklyn Nine-Nine, which is about a police precinct in New York City, is one of my favourite TV shows. It made me want to learn more about actual crime statistics in the city.</p>
<p>Specifically, this project examines how crime intersects with other social issues. The disparities in arrest rates across demographic groups have been well-documented (Jahn et al., 2022; Schleiden et al., 2020). Past research has also revealed a positive association between crime and drug usage (Pierce et al., 2017).</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Research Questions
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>What is the demographic profile of those arrested for drug-related crimes? Does it differ from that of general offenders?</li>
<li>Suppose you were walking through a borough in New York City, and you see syringe litter. Does this necessarily mean that the borough in question is unsafe – or is this merely a bias that we have? <em>In simpler terms: where are syringes likely to be found? Is there an overlap with where crimes (especially drug-related crimes) occur?</em></li>
</ol>
</div>
</div>
<p>Crime is operationalized as <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Arrest-Data-Year-to-Date-/uip8-fykc">arrest</a> <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Arrests-Data-Historic-/8h9b-rp9u">data</a> (New York Police Department, 2022a; New York Police Department, 2022b), and drug usage as <a href="https://data.cityofnewyork.us/Public-Safety/Summary-of-Syringe-Data-in-NYC-Parks/t8xi-d5wb">syringe litter data</a> (NYC Parks, 2022a). The data spans from 2017 to 2022. Codebooks are provided <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Arrest-Data-Year-to-Date-/uip8-fykc">here</a> (New York Police Department, 2022a) and <a href="https://docs.google.com/spreadsheets/d/1VSUqd1peSc-4D2XnBZNiLdxa0Jg4z62D/edit#gid=150342678">here</a> (NYC Parks, 2022b).</p>
</section>
<section id="read-in-data" class="level2">
<h2 class="anchored" data-anchor-id="read-in-data">Read In Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in 3 main datasets.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>arrest_historic <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/Desktop/umass/601final/historic.csv"</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show_col_types =</span> <span class="cn">FALSE</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"del"</span>, <span class="st">"date"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"a_desc"</span>, <span class="st">"del"</span>, <span class="st">"a_offenselevel"</span>, <span class="st">"a_boro"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"a_age"</span>, <span class="st">"a_sex"</span>, <span class="st">"a_race"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"a_lat"</span>, <span class="st">"a_long"</span>, <span class="st">"del"</span>), <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"del"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: '~/Desktop/umass/601final/historic.csv' does not exist.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>arrest_ytd <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/Desktop/umass/601final/ytd.csv"</span>, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show_col_types =</span> <span class="cn">FALSE</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"del"</span>, <span class="st">"date"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"a_desc"</span>, <span class="st">"del"</span>, <span class="st">"a_offenselevel"</span>, <span class="st">"a_boro"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"a_age"</span>, <span class="st">"a_sex"</span>, <span class="st">"a_race"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"a_lat"</span>, <span class="st">"a_long"</span>, <span class="st">"del"</span>), <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"del"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: '~/Desktop/umass/601final/ytd.csv' does not exist.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>arrest_ytd<span class="sc">$</span>a_offenselevel <span class="ot">&lt;-</span> <span class="fu">na_if</span>(arrest_ytd<span class="sc">$</span>a_offenselevel, <span class="st">"9"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in length_x %in% c(1L, n): object 'arrest_ytd' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>syringe <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/Desktop/umass/601final/syringe.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"del"</span>, <span class="st">"gispropnum"</span>, <span class="st">"del"</span>, <span class="st">"date"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"s_location"</span>, <span class="st">"s_groundsyringes"</span>, <span class="st">"s_kiosksyringes"</span>, <span class="st">"s_totalsyringes"</span>, <span class="st">"del"</span>, <span class="st">"s_kiosktype"</span>, <span class="st">"del"</span>, <span class="st">"s_boro"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"s_kioskavailable"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>), <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"del"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(s_totalsyringes <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: '~/Desktop/umass/601final/syringe.csv' does not exist.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make any implicit missing values explicit.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>arrest_historic <span class="ot">&lt;-</span> <span class="fu">complete</span>(arrest_historic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in complete(arrest_historic): object 'arrest_historic' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>arrest_ytd <span class="ot">&lt;-</span> <span class="fu">complete</span>(arrest_ytd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in complete(arrest_ytd): object 'arrest_ytd' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>syringe <span class="ot">&lt;-</span> <span class="fu">complete</span>(syringe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in complete(syringe): object 'syringe' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarise the 3 datasets.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(arrest_historic, <span class="at">varnumbers =</span> <span class="cn">FALSE</span>, <span class="at">plain.ascii =</span> <span class="cn">FALSE</span>, <span class="at">graph.magnif =</span> <span class="fl">0.30</span>, <span class="at">style =</span> <span class="st">"grid"</span>, <span class="at">valid.col =</span> <span class="cn">FALSE</span>), </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'render'</span>, <span class="at">table.classes =</span> <span class="st">'table-condensed'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in dfSummary(arrest_historic, varnumbers = FALSE, plain.ascii = FALSE, : object 'arrest_historic' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(arrest_ytd, <span class="at">varnumbers =</span> <span class="cn">FALSE</span>, <span class="at">plain.ascii =</span> <span class="cn">FALSE</span>, <span class="at">graph.magnif =</span> <span class="fl">0.30</span>, <span class="at">style =</span> <span class="st">"grid"</span>, <span class="at">valid.col =</span> <span class="cn">FALSE</span>), </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'render'</span>, <span class="at">table.classes =</span> <span class="st">'table-condensed'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in dfSummary(arrest_ytd, varnumbers = FALSE, plain.ascii = FALSE, : object 'arrest_ytd' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(syringe, <span class="at">varnumbers =</span> <span class="cn">FALSE</span>, <span class="at">plain.ascii =</span> <span class="cn">FALSE</span>, <span class="at">graph.magnif =</span> <span class="fl">0.30</span>, <span class="at">style =</span> <span class="st">"grid"</span>, <span class="at">valid.col =</span> <span class="cn">FALSE</span>), </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'render'</span>, <span class="at">table.classes =</span> <span class="st">'table-condensed'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in dfSummary(syringe, varnumbers = FALSE, plain.ascii = FALSE, graph.magnif = 0.3, : object 'syringe' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read in shapefile for syringe dataset.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>park <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"_data/ParksProperties"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">"gispropnum"</span>, <span class="st">"geometry"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: Cannot open "_data/ParksProperties"; The file doesn't seem to exist.</code></pre>
</div>
</div>
<p>In the code chunk above, all datasets have been loaded, unnecessary columns removed, columns renamed where needed and all missing values labelled NA. Some missing values were labelled “9” in <strong>arrest_ytd</strong> and have also been converted to NA.</p>
<p><strong>arrest_historic</strong> contains 5,308,876 rows, while <strong>arrest_ytd</strong> contains 93,238 rows. Each row represents a single arrest and associated information (e.g., description of crime, arrest location, demographic profile of suspect). Both have the same 9 columns and only differ in time frame - <strong>arrest_historic</strong> contains data from Jan 2006 to Dec 2021, while <strong>arrest_ytd</strong> contains data from Jan to Jun 2022.</p>
<p>I will interpret their descriptive statistics again after combining them, but these are some initial observations:</p>
<ul>
<li><p>Dangerous drugs are in the list of top 5 offenses in both datasets, highlighting the importance of our research question.</p></li>
<li><p>Arrests seem to occur the least often in Staten Island - it would be interesting to see if this is where the least number of syringes are collected as well.</p></li>
<li><p>Black individuals represent ~50% of all arrests in both datasets, despite only being ~20% of the population in NYC (U.S. Census Bureau, 2022).</p></li>
</ul>
<p>Meanwhile, <strong>syringe</strong> contains 17,531 rows and 9 columns. Rows where <strong>s_totalsyringes</strong> were 0 were removed in the read-in step, as they do not contain meaningful information for analysis. The dataset ranges from Jan 2017 to Jul 2022. It contains information on syringe collection, including date, location and number of syringes. Each row does not yet represent a single date/location combination where syringes were collected, so it needs to be tidied before descriptives can be interpreted. The one thing that stands out to me is that <u>no syringes were collected in Brooklyn</u> - hopefully the analysis later can unpack why this might be the case.</p>
<p>I have also loaded the <a href="https://data.cityofnewyork.us/Recreation/Parks-Properties/enfh-gkve"><strong>park</strong></a> shapefile (Department of Parks and Recreation, 2022), which will be used derive location coordinates for <strong>syringe</strong>.</p>
</section>
<section id="tidy-data" class="level2">
<h2 class="anchored" data-anchor-id="tidy-data">Tidy Data</h2>
<p><u>Steps to tidy <strong>arrest_historic</strong> and <strong>arrest_ytd</strong>:</u></p>
<ol type="1">
<li><p>Convert <em>date</em> to “date” column type.</p></li>
<li><p>Create a separate column, <em>year</em>.</p></li>
<li><p>Remove rows before 2017 in <strong>arrest_historic</strong>.</p></li>
<li><p>Join both datasets into <strong>arrest</strong> dataset (93,238 + 1,043,535 = 1,136,773 rows; 9 + 1 = 10 columns).</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change 'date' to date column type.</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>arrest_historic <span class="ot">&lt;-</span> arrest_historic <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as_date</span>(<span class="fu">parse_date_time</span>(date, <span class="fu">c</span>(<span class="st">'mdy'</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., date = as_date(parse_date_time(date, c("mdy")))): object 'arrest_historic' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>arrest_ytd <span class="ot">&lt;-</span> arrest_ytd <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as_date</span>(<span class="fu">parse_date_time</span>(date, <span class="fu">c</span>(<span class="st">'mdy'</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., date = as_date(parse_date_time(date, c("mdy")))): object 'arrest_ytd' not found</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create 'year'.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>arrest_historic<span class="sc">$</span><span class="st">"year"</span> <span class="ot">&lt;-</span> <span class="fu">year</span>(arrest_historic<span class="sc">$</span>date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in year(arrest_historic$date): object 'arrest_historic' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>arrest_ytd<span class="sc">$</span><span class="st">"year"</span> <span class="ot">&lt;-</span> <span class="fu">year</span>(arrest_ytd<span class="sc">$</span>date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in year(arrest_ytd$date): object 'arrest_ytd' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove rows before 2017 in arrest_historic.</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>arrest_historic <span class="ot">&lt;-</span> arrest_historic <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">&gt;</span> <span class="dv">2016</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in filter(., year &gt; 2016): object 'arrest_historic' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># join datasets.</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>arrest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(arrest_historic, arrest_ytd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in rbind(arrest_historic, arrest_ytd): object 'arrest_historic' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># spell out borough names in full.</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>arrest<span class="sc">$</span>a_boro <span class="ot">&lt;-</span> <span class="fu">recode</span>(arrest<span class="sc">$</span>a_boro, <span class="at">B =</span> <span class="st">'Bronx'</span>, <span class="at">S =</span> <span class="st">'Staten Island'</span>, <span class="at">K =</span> <span class="st">'Brooklyn'</span>, <span class="at">M =</span> <span class="st">'Manhattan'</span>, <span class="at">Q =</span> <span class="st">'Queens'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in recode(arrest$a_boro, B = "Bronx", S = "Staten Island", K = "Brooklyn", : object 'arrest' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sanity check.</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(arrest, <span class="at">varnumbers =</span> <span class="cn">FALSE</span>, <span class="at">plain.ascii =</span> <span class="cn">FALSE</span>, <span class="at">graph.magnif =</span> <span class="fl">0.30</span>, <span class="at">style =</span> <span class="st">"grid"</span>, <span class="at">valid.col =</span> <span class="cn">FALSE</span>), </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'render'</span>, <span class="at">table.classes =</span> <span class="st">'table-condensed'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in dfSummary(arrest, varnumbers = FALSE, plain.ascii = FALSE, graph.magnif = 0.3, : object 'arrest' not found</code></pre>
</div>
</div>
<p>The sanity check demonstrates that steps 1 to 4 are complete.</p>
<p><u>Steps to tidy <strong>syringe</strong>:</u></p>
<ol type="1">
<li><p>Convert <em>date</em> to “date” type.</p></li>
<li><p>Sum syringe count values in <strong>syringe</strong> into 1 row per date/location combination.</p></li>
<li><p>Extract latitude and longitude columns from <strong>park</strong> shapefile and convert them into a dataframe.</p></li>
<li><p>Combine that dataframe with <strong>syringe</strong>.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove timestamp from 'date'.</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>syringe<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(syringe<span class="sc">$</span>date, <span class="st">"12:00:00 AM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in stri_replace_first_regex(string, pattern, fix_replacement(replacement), : object 'syringe' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert 'date' to date column type.</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>syringe <span class="ot">&lt;-</span> syringe <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as_date</span>(<span class="fu">parse_date_time</span>(date, <span class="fu">c</span>(<span class="st">'mdy'</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., date = as_date(parse_date_time(date, c("mdy")))): object 'syringe' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sum values into 1 row per date/location combo.</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>syringe <span class="ot">&lt;-</span> syringe <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(s_location, date, gispropnum, s_kiosktype, s_boro, s_kioskavailable) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"syringes"</span>), <span class="sc">~</span><span class="fu">sum</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in group_by(., s_location, date, gispropnum, s_kiosktype, s_boro, : object 'syringe' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract latitude and longitude from park shapefile into park_ll.</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>park_ll <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(park<span class="sc">$</span>geometry))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in st_centroid(park$geometry): object 'park' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert park and park_ll to dataframes.</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>park_ll <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(park_ll)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in as_tibble(park_ll): object 'park_ll' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>park <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(park)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in as_tibble(park): object 'park' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove multipolygon column from park.</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>park <span class="ot">&lt;-</span> <span class="fu">select</span>(park, <span class="sc">-</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in select(park, -2): object 'park' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine park and park_ll.</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>park <span class="ot">&lt;-</span> <span class="fu">cbind</span>(park, park_ll)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in cbind(park, park_ll): object 'park' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename long and lat columns in park.</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>park <span class="ot">&lt;-</span> <span class="fu">rename</span>(park, <span class="st">"s_long"</span> <span class="ot">=</span> <span class="st">"X"</span>, <span class="st">"s_lat"</span> <span class="ot">=</span> <span class="st">"Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in rename(park, s_long = "X", s_lat = "Y"): object 'park' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine park and syringe.</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>syringe <span class="ot">&lt;-</span> syringe <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(park, <span class="at">by =</span> <span class="st">"gispropnum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in left_join(., park, by = "gispropnum"): object 'syringe' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sanity check.</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(syringe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in head(syringe): object 'syringe' not found</code></pre>
</div>
</div>
<p>The sanity check shows that steps 1 to 3 are complete. For now, the basic tidying is complete. Further transformations may be required for each visualization as we go along.</p>
</section>
<section id="analysis-question-1" class="level2">
<h2 class="anchored" data-anchor-id="analysis-question-1">Analysis: Question 1</h2>
<p>To recap, this is my first research question:</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Question 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>What is the demographic profile of those arrested for drug-related crimes? Does it differ from that of general offenders?</p>
</div>
</div>
<p>Age, sex and race data are available in the <strong>arrest</strong> dataset. We can combine them together into 1 column to create demographic profiles, then make bar graphs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine demographics into 1 column.</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>arrest <span class="ot">&lt;-</span> arrest <span class="sc">%&gt;%</span> <span class="fu">unite</span>(demo, a_race, a_sex, a_age, <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in unite(., demo, a_race, a_sex, a_age, sep = "_", remove = FALSE, : object 'arrest' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create bar graph for all arrests.</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(demo)) <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(demo) <span class="sc">%&gt;%</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(demo,<span class="sc">-</span>n<span class="sc">/</span><span class="dv">1136773</span><span class="sc">*</span><span class="dv">100</span>), <span class="at">y =</span> n<span class="sc">/</span><span class="dv">1136773</span> <span class="sc">*</span> <span class="dv">100</span>, <span class="at">fill =</span> demo)) <span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top Demographic Profiles of All Offenders in NYC (Jan 2017 to Jun 2022)"</span>, <span class="at">x =</span> <span class="st">"Profile"</span>, <span class="at">y =</span> <span class="st">"Percent"</span>) <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%0.2f"</span>, ..y..)), <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.9</span>), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.25</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in filter(., !is.na(demo)): object 'arrest' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create bar graph for drug-related arrests.</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(a_desc <span class="sc">==</span> <span class="st">"DANGEROUS DRUGS"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(demo)) <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(demo) <span class="sc">%&gt;%</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(demo,<span class="sc">-</span>n<span class="sc">/</span><span class="dv">129285</span><span class="sc">*</span><span class="dv">100</span>), <span class="at">y =</span> n<span class="sc">/</span><span class="dv">129285</span> <span class="sc">*</span> <span class="dv">100</span>, <span class="at">fill =</span> demo)) <span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top Demographic Profiles of Drug Offenders in NYC (Jan 2017 to Jun 2022)"</span>, <span class="at">x =</span> <span class="st">"Profile"</span>, <span class="at">y =</span> <span class="st">"Percent"</span>) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%0.2f"</span>, ..y..)), <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.9</span>), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.25</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in filter(., a_desc == "DANGEROUS DRUGS"): object 'arrest' not found</code></pre>
</div>
</div>
<p>In the above graphs, each demographic profile is labelled with a different colour, so that we can see the differences in proportion clearly. In the duration of 5 years, the top 5 demographic profiles are the same for all arrests and drug-related arrests (except for a switch in order at the 3rd and 4th positions). This somewhat answers our research question:</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Question 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>When comparing all arrests and drug-related arrests, the top five demographic profiles of offenders seem to be largely similar. They are all male. Age group varies based on ethnicity: black men aged 18 to 64 are all quite likely to be arrested, although this was greater for black men aged 25-44. For white Hispanic and white men, arrests are concentrated in the 25-44 age group.</p>
</div>
</div>
<p>However, both bar graphs seem to show a stark difference between arrests of black males aged 25-44 and the other four groups. I am interested to see if this difference is significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create new dataset for chi-square test.</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>chi_square <span class="ot">&lt;-</span> arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(demo)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(demo <span class="sc">==</span>  <span class="st">"BLACK_M_18-24"</span> <span class="sc">|</span> demo <span class="sc">==</span> <span class="st">"BLACK_M_25-44"</span> <span class="sc">|</span> demo <span class="sc">==</span> <span class="st">"BLACK_M_45-64"</span> <span class="sc">|</span> demo <span class="sc">==</span> <span class="st">"WHITE HISPANIC_M_25-44"</span> <span class="sc">|</span> demo <span class="sc">==</span> <span class="st">"WHITE_M_25-44"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in filter(., !is.na(demo)): object 'arrest' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run chi-square test.</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="at">x =</span> <span class="fu">table</span>(chi_square<span class="sc">$</span>demo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in table(chi_square$demo): object 'chi_square' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># attempt post-hoc test - this is not working.</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># table_demo &lt;- chi_square %&gt;% count(demo)</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># chisq.posthoc.test(table_demo, method = "bonferroni")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The chi-square test reveals significant differences between the top 5 demographic profiles for drug-related and non-drug-related arrests, 𝜒<sup>2</sup> (4) = 140432, <em>p</em> &lt; .001. However, this doesn’t tell us which groups had the differences. <strong><em>I downloaded a post-hoc package, but I can’t get it to work.</em></strong></p>
</section>
<section id="additional-analysis-question-1" class="level2">
<h2 class="anchored" data-anchor-id="additional-analysis-question-1">Additional Analysis: Question 1</h2>
<p><strong>Doing the above analysis also made me interested in exploring a few other questions:</strong></p>
<ul>
<li><p>How did the proportion of drug-related arrests change over time?</p></li>
<li><p>Within drug-related arrests, how did the proportions of each demographic variable (age, sex, race) change over time?</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># keep only top 3 levels of a_desc.</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>arrest<span class="sc">$</span>a_desc <span class="ot">&lt;-</span> <span class="fu">fct_lump_n</span>(arrest<span class="sc">$</span>a_desc, <span class="dv">3</span>, <span class="at">other_level=</span><span class="st">"Other"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in check_factor(f): object 'arrest' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change year to factor type so i can plot it.</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>arrest<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(arrest<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in is.factor(x): object 'arrest' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stacked bar graph for offense type.</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(a_desc)) <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y=</span>..count.., <span class="at">fill=</span>a_desc), <span class="at">position=</span><span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proportion of Different Offences in NYC (Jan 2017 to Jun 2022)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Percent"</span>) <span class="sc">+</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">hjust=</span><span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in filter(., !is.na(a_desc)): object 'arrest' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stacked bar graph for age.</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(a_desc <span class="sc">==</span> <span class="st">"DANGEROUS DRUGS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(a_age)) <span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">fill=</span>a_age), <span class="at">position=</span><span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Age Composition of Drug Offenders in NYC (Jan 2017 to Jun 2022)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Percent"</span>) <span class="sc">+</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in filter(., a_desc == "DANGEROUS DRUGS"): object 'arrest' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stacked bar graph for race.</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(a_desc <span class="sc">==</span> <span class="st">"DANGEROUS DRUGS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(a_race)) <span class="sc">%&gt;%</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">fill=</span>a_race), <span class="at">position=</span><span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Race Composition of Drug Offenders in NYC (Jan 2017 to Jun 2022)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Percent"</span>) <span class="sc">+</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">hjust=</span><span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in filter(., a_desc == "DANGEROUS DRUGS"): object 'arrest' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stacked bar graph for sex.</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(a_desc <span class="sc">==</span> <span class="st">"DANGEROUS DRUGS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(a_sex)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">fill=</span>a_sex), <span class="at">position=</span><span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Sex Composition of Drug Offenders in NYC (Jan 2017 to Jun 2022)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Percent"</span>) <span class="sc">+</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in filter(., a_desc == "DANGEROUS DRUGS"): object 'arrest' not found</code></pre>
</div>
</div>
<p>This is what we can gather from the stacked bar graphs above. - The proportion of drug-related arrests has shrunk with time - this is a good thing! Although it is a part of the top 3 reasons for arrests, it is definitely on a downward trend. It will be useful to compare this with the change in syringes collected over time, to see if NYC’s stricter policies on drug usage and offences are effective. - <strong><em>I need to add percent labels to the demographic graphs to interpret them.</em></strong></p>
</section>
<section id="analysis-question-2" class="level2">
<h2 class="anchored" data-anchor-id="analysis-question-2">Analysis: Question 2</h2>
<p>To recap, this is my second research question:</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Question 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suppose you were walking through a borough in New York City, and you see syringe litter. Does this necessarily mean that the borough in question is unsafe – or is this merely a bias that we have? <em>In simpler terms: where are syringes likely to be found? Is there an overlap with where crimes (especially drug-related crimes) occur?</em></p>
</div>
</div>
<p>This question can be easily visualized via dot maps of NYC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating subset of syringe for visualisation.</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>syringe_map <span class="ot">&lt;-</span> syringe <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(s_long)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(s_lat)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(s_totalsyringes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in filter(., !is.na(s_long)): object 'syringe' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualisation of syringe_map using mapview.</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>syringe <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(s_long)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(s_lat)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(s_totalsyringes) <span class="sc">%&gt;%</span> <span class="fu">mapview</span>(<span class="at">xcol =</span> <span class="st">"s_long"</span>, <span class="at">ycol =</span> <span class="st">"s_lat"</span>, <span class="at">crs =</span> <span class="dv">4326</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in filter(., !is.na(s_long)): object 'syringe' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating arrest_map.</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>arrest_map <span class="ot">&lt;-</span> arrest <span class="sc">%&gt;%</span> <span class="fu">count</span>(a_boro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in count(., a_boro): object 'arrest' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>arrest_map<span class="sc">$</span>lat <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">40.84567</span>, <span class="fl">40.67908</span>, <span class="fl">40.78322</span>, <span class="fl">40.72955</span>, <span class="fl">40.58098</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in arrest_map$lat &lt;- c(40.84567, 40.67908, 40.78322, 40.72955, 40.58098): object 'arrest_map' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>arrest_map<span class="sc">$</span>long <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">73.86136</span>, <span class="sc">-</span><span class="fl">73.94672</span>, <span class="sc">-</span><span class="fl">73.97198</span>, <span class="sc">-</span><span class="fl">73.79636</span>, <span class="sc">-</span><span class="fl">74.15237</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in arrest_map$long &lt;- c(-73.86136, -73.94672, -73.97198, -73.79636, : object 'arrest_map' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualisation of arrest_map using mapview.</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>arrest_map <span class="sc">%&gt;%</span> <span class="fu">mapview</span>(<span class="at">xcol =</span> <span class="st">"long"</span>, <span class="at">ycol =</span> <span class="st">"lat"</span>, <span class="at">crs =</span> <span class="dv">4326</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>, <span class="at">cex =</span> <span class="st">"n"</span>, <span class="at">legend =</span> <span class="cn">TRUE</span>, <span class="at">layer.name =</span> <span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(quote(list(...)), env): object 'arrest_map' not found</code></pre>
</div>
</div>
<p>I tested the packages ggmap and mapview, and both worked great for the syringe dataset. However, the arrest dataset is simply too large for either package to load the map successfully. I decided to create a new dataframe with just the numbers of arrests in each borough and load that into mapview instead, which worked. I also like mapview better because you can zoom in and out.</p>
<p>Additionally, I would like to make a time series graph of how syringes collected have changed over time. <strong><em>We can remove outliers by finding the standard deviation of s_totalsyringes. We can also make another stacked bar graph to compare the number of kiosk and ground syringes collected.</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># time graph of syringes collected.</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>syringe <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(date)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(s_totalsyringes)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(s_totalsyringes <span class="sc">&lt;</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y=</span>s_totalsyringes)) <span class="sc">+</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">60</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in filter(., !is.na(date)): object 'syringe' not found</code></pre>
</div>
</div>
<p><strong><em>Just pushing this update to see if the rendering will work - I will clean up the text and code before my final submission.</em></strong></p>
<p><strong><em>Planning to make 2 stacked bar graphs (proportion of syringes/arrests in different boroughs) to check if what I observe from the maps can be seen from those bar graphs too.</em></strong></p>
</section>
<section id="bibliography" class="level2">
<h2 class="anchored" data-anchor-id="bibliography">Bibliography</h2>
<p>Department of Parks and Recreation. (2022). <em>Parks Properties</em>. NYC Open Data. Retrieved from https://data.cityofnewyork.us/Recreation/Parks-Properties/enfh-gkve.</p>
<p>Jahn, J., Simes, J., Cowger, T., &amp; Davis, B. (2022). Racial Disparities in Neighborhood Arrest Rates during the COVID-19 Pandemic. <em>Journal Of Urban Health</em>, <em>99</em>(1), 67-76.</p>
<p>New York Police Department. (2022). <em>NYPD Arrest Data (Year to Date)</em>. NYC Open Data. Retrieved from https://data.cityofnewyork.us/Public-Safety/NYPD-Arrest-Data-Year-to-Date-/uip8-fykc.</p>
<p>New York Police Department. (2022). <em>NYPD Arrests Data (Historic)</em>. NYC Open Data. Retrieved from https://data.cityofnewyork.us/Public-Safety/NYPD-Arrests-Data-Historic-/8h9b-rp9u.</p>
<p>NYC Parks. (2022). <em>NYC Parks Syringe Litter Data Dictionary and UserGuide</em>. Google Docs. Retrieved from https://docs.google.com/spreadsheets/d/1VSUqd1peSc-4D2XnBZNiLdxa0Jg4z62D/edit#gid=150342678.</p>
<p>NYC Parks. (2022). <em>Summary of Syringe Data in NYC Parks</em>. NYC Open Data. Retrieved from https://data.cityofnewyork.us/Public-Safety/Summary-of-Syringe-Data-in-NYC-Parks/t8xi-d5wb.</p>
<p>Pierce, M., Hayhurst, K., Bird, S., Hickman, M., Seddon, T., Dunn, G., &amp; Millar, T. (2017). Insights into the link between drug use and criminality: Lifetime offending of criminally-active opiate users. <em>Drug And Alcohol Dependence</em>, <em>179</em>, 309-316.</p>
<p>R Core Team. (2022). <em>R: A language and environment for statistical computing</em>. R Foundation for Statistical Computing.</p>
<p>Schleiden, C., Soloski, K., Milstead, K., &amp; Rhynehart, A. (2020). Racial Disparities in Arrests: A Race Specific Model Explaining Arrest Rates Across Black and White Young Adults. <em>Child And Adolescent Social Work Journal</em>, <em>37</em>(1), 1-14.</p>
<p>U.S. Census Bureau. (2022). <em>U.S. Census Bureau QuickFacts: New York City, New York</em>. Census Bureau QuickFacts. Retrieved from https://www.census.gov/quickfacts/newyorkcitynewyork.</p>
<p>Wickham, H., &amp; Grolemund, G. (2017). <em>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</em> (1st ed.). O’Reilly Media.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/DACSS_601_August2022_v2" data-repo-id="R_kgDOH1g84A" data-category="Announcements" data-category-id="DIC_kwDOH1g84M4CQ6Pq" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb99" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project [WIP] Update 3"</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Saaradhaa M"</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Crime, Drug Usage and Demographics"</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "08/31/2022"</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="co">    css: "styles.css"</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - final_project</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - tidyverse</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="co">  - ggplot2</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="co">  - summarytools</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a><span class="co">  - lubridate</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a><span class="co">  - sf</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chisq.posthoc.test)</span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapview)</span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a>Brooklyn Nine-Nine, which is about a police precinct in New York City, is one of my favourite TV shows. It made me want to learn more about actual crime statistics in the city.</span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a>Specifically, this project examines how crime intersects with other social issues. The disparities in arrest rates across demographic groups have been well-documented (Jahn et al., 2022; Schleiden et al., 2020). Past research has also revealed a positive association between crime and drug usage (Pierce et al., 2017).</span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## Research Questions</span></span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>What is the demographic profile of those arrested for drug-related crimes? Does it differ from that of general offenders?</span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Suppose you were walking through a borough in New York City, and you see syringe litter. Does this necessarily mean that the borough in question is unsafe -- or is this merely a bias that we have? *In simpler terms: where are syringes likely to be found? Is there an overlap with where crimes (especially drug-related crimes) occur?*</span>
<span id="cb99-52"><a href="#cb99-52" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb99-53"><a href="#cb99-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-54"><a href="#cb99-54" aria-hidden="true" tabindex="-1"></a>Crime is operationalized as <span class="co">[</span><span class="ot">arrest</span><span class="co">](https://data.cityofnewyork.us/Public-Safety/NYPD-Arrest-Data-Year-to-Date-/uip8-fykc)</span> <span class="co">[</span><span class="ot">data</span><span class="co">](https://data.cityofnewyork.us/Public-Safety/NYPD-Arrests-Data-Historic-/8h9b-rp9u)</span> (New York Police Department, 2022a; New York Police Department, 2022b), and drug usage as <span class="co">[</span><span class="ot">syringe litter data</span><span class="co">](https://data.cityofnewyork.us/Public-Safety/Summary-of-Syringe-Data-in-NYC-Parks/t8xi-d5wb)</span> (NYC Parks, 2022a). The data spans from 2017 to 2022. Codebooks are provided <span class="co">[</span><span class="ot">here</span><span class="co">](https://data.cityofnewyork.us/Public-Safety/NYPD-Arrest-Data-Year-to-Date-/uip8-fykc)</span> (New York Police Department, 2022a) and <span class="co">[</span><span class="ot">here</span><span class="co">](https://docs.google.com/spreadsheets/d/1VSUqd1peSc-4D2XnBZNiLdxa0Jg4z62D/edit#gid=150342678)</span> (NYC Parks, 2022b).</span>
<span id="cb99-55"><a href="#cb99-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-56"><a href="#cb99-56" aria-hidden="true" tabindex="-1"></a><span class="fu">## Read In Data</span></span>
<span id="cb99-57"><a href="#cb99-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-60"><a href="#cb99-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-61"><a href="#cb99-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: read in</span></span>
<span id="cb99-62"><a href="#cb99-62" aria-hidden="true" tabindex="-1"></a><span class="co"># read in 3 main datasets.</span></span>
<span id="cb99-63"><a href="#cb99-63" aria-hidden="true" tabindex="-1"></a>arrest_historic <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/Desktop/umass/601final/historic.csv"</span>, </span>
<span id="cb99-64"><a href="#cb99-64" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show_col_types =</span> <span class="cn">FALSE</span>, </span>
<span id="cb99-65"><a href="#cb99-65" aria-hidden="true" tabindex="-1"></a>                   <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"del"</span>, <span class="st">"date"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"a_desc"</span>, <span class="st">"del"</span>, <span class="st">"a_offenselevel"</span>, <span class="st">"a_boro"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"a_age"</span>, <span class="st">"a_sex"</span>, <span class="st">"a_race"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"a_lat"</span>, <span class="st">"a_long"</span>, <span class="st">"del"</span>), <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb99-66"><a href="#cb99-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"del"</span>))</span>
<span id="cb99-67"><a href="#cb99-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-68"><a href="#cb99-68" aria-hidden="true" tabindex="-1"></a>arrest_ytd <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/Desktop/umass/601final/ytd.csv"</span>, </span>
<span id="cb99-69"><a href="#cb99-69" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show_col_types =</span> <span class="cn">FALSE</span>, </span>
<span id="cb99-70"><a href="#cb99-70" aria-hidden="true" tabindex="-1"></a>                   <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"del"</span>, <span class="st">"date"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"a_desc"</span>, <span class="st">"del"</span>, <span class="st">"a_offenselevel"</span>, <span class="st">"a_boro"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"a_age"</span>, <span class="st">"a_sex"</span>, <span class="st">"a_race"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"a_lat"</span>, <span class="st">"a_long"</span>, <span class="st">"del"</span>), <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb99-71"><a href="#cb99-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"del"</span>))</span>
<span id="cb99-72"><a href="#cb99-72" aria-hidden="true" tabindex="-1"></a>arrest_ytd<span class="sc">$</span>a_offenselevel <span class="ot">&lt;-</span> <span class="fu">na_if</span>(arrest_ytd<span class="sc">$</span>a_offenselevel, <span class="st">"9"</span>)</span>
<span id="cb99-73"><a href="#cb99-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-74"><a href="#cb99-74" aria-hidden="true" tabindex="-1"></a>syringe <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/Desktop/umass/601final/syringe.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"del"</span>, <span class="st">"gispropnum"</span>, <span class="st">"del"</span>, <span class="st">"date"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"s_location"</span>, <span class="st">"s_groundsyringes"</span>, <span class="st">"s_kiosksyringes"</span>, <span class="st">"s_totalsyringes"</span>, <span class="st">"del"</span>, <span class="st">"s_kiosktype"</span>, <span class="st">"del"</span>, <span class="st">"s_boro"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>, <span class="st">"s_kioskavailable"</span>, <span class="st">"del"</span>, <span class="st">"del"</span>), <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb99-75"><a href="#cb99-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"del"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb99-76"><a href="#cb99-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(s_totalsyringes <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb99-77"><a href="#cb99-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-78"><a href="#cb99-78" aria-hidden="true" tabindex="-1"></a><span class="co"># make any implicit missing values explicit.</span></span>
<span id="cb99-79"><a href="#cb99-79" aria-hidden="true" tabindex="-1"></a>arrest_historic <span class="ot">&lt;-</span> <span class="fu">complete</span>(arrest_historic)</span>
<span id="cb99-80"><a href="#cb99-80" aria-hidden="true" tabindex="-1"></a>arrest_ytd <span class="ot">&lt;-</span> <span class="fu">complete</span>(arrest_ytd)</span>
<span id="cb99-81"><a href="#cb99-81" aria-hidden="true" tabindex="-1"></a>syringe <span class="ot">&lt;-</span> <span class="fu">complete</span>(syringe)</span>
<span id="cb99-82"><a href="#cb99-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-83"><a href="#cb99-83" aria-hidden="true" tabindex="-1"></a><span class="co"># summarise the 3 datasets.</span></span>
<span id="cb99-84"><a href="#cb99-84" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(arrest_historic, <span class="at">varnumbers =</span> <span class="cn">FALSE</span>, <span class="at">plain.ascii =</span> <span class="cn">FALSE</span>, <span class="at">graph.magnif =</span> <span class="fl">0.30</span>, <span class="at">style =</span> <span class="st">"grid"</span>, <span class="at">valid.col =</span> <span class="cn">FALSE</span>), </span>
<span id="cb99-85"><a href="#cb99-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'render'</span>, <span class="at">table.classes =</span> <span class="st">'table-condensed'</span>)</span>
<span id="cb99-86"><a href="#cb99-86" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(arrest_ytd, <span class="at">varnumbers =</span> <span class="cn">FALSE</span>, <span class="at">plain.ascii =</span> <span class="cn">FALSE</span>, <span class="at">graph.magnif =</span> <span class="fl">0.30</span>, <span class="at">style =</span> <span class="st">"grid"</span>, <span class="at">valid.col =</span> <span class="cn">FALSE</span>), </span>
<span id="cb99-87"><a href="#cb99-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'render'</span>, <span class="at">table.classes =</span> <span class="st">'table-condensed'</span>)</span>
<span id="cb99-88"><a href="#cb99-88" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(syringe, <span class="at">varnumbers =</span> <span class="cn">FALSE</span>, <span class="at">plain.ascii =</span> <span class="cn">FALSE</span>, <span class="at">graph.magnif =</span> <span class="fl">0.30</span>, <span class="at">style =</span> <span class="st">"grid"</span>, <span class="at">valid.col =</span> <span class="cn">FALSE</span>), </span>
<span id="cb99-89"><a href="#cb99-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'render'</span>, <span class="at">table.classes =</span> <span class="st">'table-condensed'</span>)</span>
<span id="cb99-90"><a href="#cb99-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-91"><a href="#cb99-91" aria-hidden="true" tabindex="-1"></a><span class="co">#read in shapefile for syringe dataset.</span></span>
<span id="cb99-92"><a href="#cb99-92" aria-hidden="true" tabindex="-1"></a>park <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"_data/ParksProperties"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">"gispropnum"</span>, <span class="st">"geometry"</span>)</span>
<span id="cb99-93"><a href="#cb99-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-94"><a href="#cb99-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-95"><a href="#cb99-95" aria-hidden="true" tabindex="-1"></a>In the code chunk above, all datasets have been loaded, unnecessary columns removed, columns renamed where needed and all missing values labelled NA. Some missing values were labelled "9" in **arrest_ytd** and have also been converted to NA.</span>
<span id="cb99-96"><a href="#cb99-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-97"><a href="#cb99-97" aria-hidden="true" tabindex="-1"></a>**arrest_historic** contains 5,308,876 rows, while **arrest_ytd** contains 93,238 rows. Each row represents a single arrest and associated information (e.g., description of crime, arrest location, demographic profile of suspect). Both have the same 9 columns and only differ in time frame - **arrest_historic** contains data from Jan 2006 to Dec 2021, while **arrest_ytd** contains data from Jan to Jun 2022.</span>
<span id="cb99-98"><a href="#cb99-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-99"><a href="#cb99-99" aria-hidden="true" tabindex="-1"></a>I will interpret their descriptive statistics again after combining them, but these are some initial observations:</span>
<span id="cb99-100"><a href="#cb99-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-101"><a href="#cb99-101" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Dangerous drugs are in the list of top 5 offenses in both datasets, highlighting the importance of our research question.</span>
<span id="cb99-102"><a href="#cb99-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-103"><a href="#cb99-103" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Arrests seem to occur the least often in Staten Island - it would be interesting to see if this is where the least number of syringes are collected as well.</span>
<span id="cb99-104"><a href="#cb99-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-105"><a href="#cb99-105" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Black individuals represent \~50% of all arrests in both datasets, despite only being \~20% of the population in NYC (U.S. Census Bureau, 2022).</span>
<span id="cb99-106"><a href="#cb99-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-107"><a href="#cb99-107" aria-hidden="true" tabindex="-1"></a>Meanwhile, **syringe** contains 17,531 rows and 9 columns. Rows where **s_totalsyringes** were 0 were removed in the read-in step, as they do not contain meaningful information for analysis. The dataset ranges from Jan 2017 to Jul 2022. It contains information on syringe collection, including date, location and number of syringes. Each row does not yet represent a single date/location combination where syringes were collected, so it needs to be tidied before descriptives can be interpreted. The one thing that stands out to me is that <span class="co">[</span><span class="ot">no syringes were collected in Brooklyn</span><span class="co">]</span>{.underline} - hopefully the analysis later can unpack why this might be the case.</span>
<span id="cb99-108"><a href="#cb99-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-109"><a href="#cb99-109" aria-hidden="true" tabindex="-1"></a>I have also loaded the <span class="co">[</span><span class="ot">**park**</span><span class="co">](https://data.cityofnewyork.us/Recreation/Parks-Properties/enfh-gkve)</span> shapefile (Department of Parks and Recreation, 2022), which will be used derive location coordinates for **syringe**.</span>
<span id="cb99-110"><a href="#cb99-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-111"><a href="#cb99-111" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tidy Data</span></span>
<span id="cb99-112"><a href="#cb99-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-113"><a href="#cb99-113" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Steps to tidy **arrest_historic** and **arrest_ytd**:</span><span class="co">]</span>{.underline}</span>
<span id="cb99-114"><a href="#cb99-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-115"><a href="#cb99-115" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Convert *date* to "date" column type.</span>
<span id="cb99-116"><a href="#cb99-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-117"><a href="#cb99-117" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Create a separate column, *year*.</span>
<span id="cb99-118"><a href="#cb99-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-119"><a href="#cb99-119" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Remove rows before 2017 in **arrest_historic**.</span>
<span id="cb99-120"><a href="#cb99-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-121"><a href="#cb99-121" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Join both datasets into **arrest** dataset (93,238 + 1,043,535 = 1,136,773 rows; 9 + 1 = 10 columns).</span>
<span id="cb99-122"><a href="#cb99-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-125"><a href="#cb99-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-126"><a href="#cb99-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tidy arrests 1</span></span>
<span id="cb99-127"><a href="#cb99-127" aria-hidden="true" tabindex="-1"></a><span class="co"># change 'date' to date column type.</span></span>
<span id="cb99-128"><a href="#cb99-128" aria-hidden="true" tabindex="-1"></a>arrest_historic <span class="ot">&lt;-</span> arrest_historic <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as_date</span>(<span class="fu">parse_date_time</span>(date, <span class="fu">c</span>(<span class="st">'mdy'</span>))))</span>
<span id="cb99-129"><a href="#cb99-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-130"><a href="#cb99-130" aria-hidden="true" tabindex="-1"></a>arrest_ytd <span class="ot">&lt;-</span> arrest_ytd <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as_date</span>(<span class="fu">parse_date_time</span>(date, <span class="fu">c</span>(<span class="st">'mdy'</span>))))</span>
<span id="cb99-131"><a href="#cb99-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-132"><a href="#cb99-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-135"><a href="#cb99-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-136"><a href="#cb99-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tidy arrests 2</span></span>
<span id="cb99-137"><a href="#cb99-137" aria-hidden="true" tabindex="-1"></a><span class="co"># create 'year'.</span></span>
<span id="cb99-138"><a href="#cb99-138" aria-hidden="true" tabindex="-1"></a>arrest_historic<span class="sc">$</span><span class="st">"year"</span> <span class="ot">&lt;-</span> <span class="fu">year</span>(arrest_historic<span class="sc">$</span>date)</span>
<span id="cb99-139"><a href="#cb99-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-140"><a href="#cb99-140" aria-hidden="true" tabindex="-1"></a>arrest_ytd<span class="sc">$</span><span class="st">"year"</span> <span class="ot">&lt;-</span> <span class="fu">year</span>(arrest_ytd<span class="sc">$</span>date)</span>
<span id="cb99-141"><a href="#cb99-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-142"><a href="#cb99-142" aria-hidden="true" tabindex="-1"></a><span class="co"># remove rows before 2017 in arrest_historic.</span></span>
<span id="cb99-143"><a href="#cb99-143" aria-hidden="true" tabindex="-1"></a>arrest_historic <span class="ot">&lt;-</span> arrest_historic <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">&gt;</span> <span class="dv">2016</span>)</span>
<span id="cb99-144"><a href="#cb99-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-145"><a href="#cb99-145" aria-hidden="true" tabindex="-1"></a><span class="co"># join datasets.</span></span>
<span id="cb99-146"><a href="#cb99-146" aria-hidden="true" tabindex="-1"></a>arrest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(arrest_historic, arrest_ytd)</span>
<span id="cb99-147"><a href="#cb99-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-148"><a href="#cb99-148" aria-hidden="true" tabindex="-1"></a><span class="co"># spell out borough names in full.</span></span>
<span id="cb99-149"><a href="#cb99-149" aria-hidden="true" tabindex="-1"></a>arrest<span class="sc">$</span>a_boro <span class="ot">&lt;-</span> <span class="fu">recode</span>(arrest<span class="sc">$</span>a_boro, <span class="at">B =</span> <span class="st">'Bronx'</span>, <span class="at">S =</span> <span class="st">'Staten Island'</span>, <span class="at">K =</span> <span class="st">'Brooklyn'</span>, <span class="at">M =</span> <span class="st">'Manhattan'</span>, <span class="at">Q =</span> <span class="st">'Queens'</span>)</span>
<span id="cb99-150"><a href="#cb99-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-151"><a href="#cb99-151" aria-hidden="true" tabindex="-1"></a><span class="co"># sanity check.</span></span>
<span id="cb99-152"><a href="#cb99-152" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dfSummary</span>(arrest, <span class="at">varnumbers =</span> <span class="cn">FALSE</span>, <span class="at">plain.ascii =</span> <span class="cn">FALSE</span>, <span class="at">graph.magnif =</span> <span class="fl">0.30</span>, <span class="at">style =</span> <span class="st">"grid"</span>, <span class="at">valid.col =</span> <span class="cn">FALSE</span>), </span>
<span id="cb99-153"><a href="#cb99-153" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'render'</span>, <span class="at">table.classes =</span> <span class="st">'table-condensed'</span>)</span>
<span id="cb99-154"><a href="#cb99-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-155"><a href="#cb99-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-156"><a href="#cb99-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-157"><a href="#cb99-157" aria-hidden="true" tabindex="-1"></a>The sanity check demonstrates that steps 1 to 4 are complete.</span>
<span id="cb99-158"><a href="#cb99-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-159"><a href="#cb99-159" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Steps to tidy **syringe**:</span><span class="co">]</span>{.underline}</span>
<span id="cb99-160"><a href="#cb99-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-161"><a href="#cb99-161" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Convert *date* to "date" type.</span>
<span id="cb99-162"><a href="#cb99-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-163"><a href="#cb99-163" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Sum syringe count values in **syringe** into 1 row per date/location combination.</span>
<span id="cb99-164"><a href="#cb99-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-165"><a href="#cb99-165" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Extract latitude and longitude columns from **park** shapefile and convert them into a dataframe.</span>
<span id="cb99-166"><a href="#cb99-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-167"><a href="#cb99-167" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Combine that dataframe with **syringe**.</span>
<span id="cb99-168"><a href="#cb99-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-171"><a href="#cb99-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-172"><a href="#cb99-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tidy syringe</span></span>
<span id="cb99-173"><a href="#cb99-173" aria-hidden="true" tabindex="-1"></a><span class="co"># remove timestamp from 'date'.</span></span>
<span id="cb99-174"><a href="#cb99-174" aria-hidden="true" tabindex="-1"></a>syringe<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(syringe<span class="sc">$</span>date, <span class="st">"12:00:00 AM"</span>)</span>
<span id="cb99-175"><a href="#cb99-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-176"><a href="#cb99-176" aria-hidden="true" tabindex="-1"></a><span class="co"># convert 'date' to date column type.</span></span>
<span id="cb99-177"><a href="#cb99-177" aria-hidden="true" tabindex="-1"></a>syringe <span class="ot">&lt;-</span> syringe <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as_date</span>(<span class="fu">parse_date_time</span>(date, <span class="fu">c</span>(<span class="st">'mdy'</span>))))</span>
<span id="cb99-178"><a href="#cb99-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-179"><a href="#cb99-179" aria-hidden="true" tabindex="-1"></a><span class="co"># sum values into 1 row per date/location combo.</span></span>
<span id="cb99-180"><a href="#cb99-180" aria-hidden="true" tabindex="-1"></a>syringe <span class="ot">&lt;-</span> syringe <span class="sc">%&gt;%</span> </span>
<span id="cb99-181"><a href="#cb99-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(s_location, date, gispropnum, s_kiosktype, s_boro, s_kioskavailable) <span class="sc">%&gt;%</span></span>
<span id="cb99-182"><a href="#cb99-182" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"syringes"</span>), <span class="sc">~</span><span class="fu">sum</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb99-183"><a href="#cb99-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-184"><a href="#cb99-184" aria-hidden="true" tabindex="-1"></a><span class="co"># extract latitude and longitude from park shapefile into park_ll.</span></span>
<span id="cb99-185"><a href="#cb99-185" aria-hidden="true" tabindex="-1"></a><span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>)</span>
<span id="cb99-186"><a href="#cb99-186" aria-hidden="true" tabindex="-1"></a>park_ll <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(park<span class="sc">$</span>geometry))</span>
<span id="cb99-187"><a href="#cb99-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-188"><a href="#cb99-188" aria-hidden="true" tabindex="-1"></a><span class="co"># convert park and park_ll to dataframes.</span></span>
<span id="cb99-189"><a href="#cb99-189" aria-hidden="true" tabindex="-1"></a>park_ll <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(park_ll)</span>
<span id="cb99-190"><a href="#cb99-190" aria-hidden="true" tabindex="-1"></a>park <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(park)</span>
<span id="cb99-191"><a href="#cb99-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-192"><a href="#cb99-192" aria-hidden="true" tabindex="-1"></a><span class="co"># remove multipolygon column from park.</span></span>
<span id="cb99-193"><a href="#cb99-193" aria-hidden="true" tabindex="-1"></a>park <span class="ot">&lt;-</span> <span class="fu">select</span>(park, <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb99-194"><a href="#cb99-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-195"><a href="#cb99-195" aria-hidden="true" tabindex="-1"></a><span class="co"># combine park and park_ll.</span></span>
<span id="cb99-196"><a href="#cb99-196" aria-hidden="true" tabindex="-1"></a>park <span class="ot">&lt;-</span> <span class="fu">cbind</span>(park, park_ll)</span>
<span id="cb99-197"><a href="#cb99-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-198"><a href="#cb99-198" aria-hidden="true" tabindex="-1"></a><span class="co"># rename long and lat columns in park.</span></span>
<span id="cb99-199"><a href="#cb99-199" aria-hidden="true" tabindex="-1"></a>park <span class="ot">&lt;-</span> <span class="fu">rename</span>(park, <span class="st">"s_long"</span> <span class="ot">=</span> <span class="st">"X"</span>, <span class="st">"s_lat"</span> <span class="ot">=</span> <span class="st">"Y"</span>)</span>
<span id="cb99-200"><a href="#cb99-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-201"><a href="#cb99-201" aria-hidden="true" tabindex="-1"></a><span class="co"># combine park and syringe.</span></span>
<span id="cb99-202"><a href="#cb99-202" aria-hidden="true" tabindex="-1"></a>syringe <span class="ot">&lt;-</span> syringe <span class="sc">%&gt;%</span></span>
<span id="cb99-203"><a href="#cb99-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(park, <span class="at">by =</span> <span class="st">"gispropnum"</span>)</span>
<span id="cb99-204"><a href="#cb99-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-205"><a href="#cb99-205" aria-hidden="true" tabindex="-1"></a><span class="co"># sanity check.</span></span>
<span id="cb99-206"><a href="#cb99-206" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(syringe)</span>
<span id="cb99-207"><a href="#cb99-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-208"><a href="#cb99-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-209"><a href="#cb99-209" aria-hidden="true" tabindex="-1"></a>The sanity check shows that steps 1 to 3 are complete. For now, the basic tidying is complete. Further transformations may be required for each visualization as we go along.</span>
<span id="cb99-210"><a href="#cb99-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-211"><a href="#cb99-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analysis: Question 1</span></span>
<span id="cb99-212"><a href="#cb99-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-213"><a href="#cb99-213" aria-hidden="true" tabindex="-1"></a>To recap, this is my first research question:</span>
<span id="cb99-214"><a href="#cb99-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-215"><a href="#cb99-215" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb99-216"><a href="#cb99-216" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 1</span></span>
<span id="cb99-217"><a href="#cb99-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-218"><a href="#cb99-218" aria-hidden="true" tabindex="-1"></a>What is the demographic profile of those arrested for drug-related crimes? Does it differ from that of general offenders?</span>
<span id="cb99-219"><a href="#cb99-219" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb99-220"><a href="#cb99-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-221"><a href="#cb99-221" aria-hidden="true" tabindex="-1"></a>Age, sex and race data are available in the **arrest** dataset. We can combine them together into 1 column to create demographic profiles, then make bar graphs.</span>
<span id="cb99-222"><a href="#cb99-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-225"><a href="#cb99-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-226"><a href="#cb99-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: qn 1 bar graph</span></span>
<span id="cb99-227"><a href="#cb99-227" aria-hidden="true" tabindex="-1"></a><span class="co"># combine demographics into 1 column.</span></span>
<span id="cb99-228"><a href="#cb99-228" aria-hidden="true" tabindex="-1"></a>arrest <span class="ot">&lt;-</span> arrest <span class="sc">%&gt;%</span> <span class="fu">unite</span>(demo, a_race, a_sex, a_age, <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb99-229"><a href="#cb99-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-230"><a href="#cb99-230" aria-hidden="true" tabindex="-1"></a><span class="co"># create bar graph for all arrests.</span></span>
<span id="cb99-231"><a href="#cb99-231" aria-hidden="true" tabindex="-1"></a>arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(demo)) <span class="sc">%&gt;%</span></span>
<span id="cb99-232"><a href="#cb99-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(demo) <span class="sc">%&gt;%</span></span>
<span id="cb99-233"><a href="#cb99-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-234"><a href="#cb99-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(demo,<span class="sc">-</span>n<span class="sc">/</span><span class="dv">1136773</span><span class="sc">*</span><span class="dv">100</span>), <span class="at">y =</span> n<span class="sc">/</span><span class="dv">1136773</span> <span class="sc">*</span> <span class="dv">100</span>, <span class="at">fill =</span> demo)) <span class="sc">+</span></span>
<span id="cb99-235"><a href="#cb99-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb99-236"><a href="#cb99-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb99-237"><a href="#cb99-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top Demographic Profiles of All Offenders in NYC (Jan 2017 to Jun 2022)"</span>, <span class="at">x =</span> <span class="st">"Profile"</span>, <span class="at">y =</span> <span class="st">"Percent"</span>) <span class="sc">+</span></span>
<span id="cb99-238"><a href="#cb99-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%0.2f"</span>, ..y..)), <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.9</span>), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.25</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb99-239"><a href="#cb99-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb99-240"><a href="#cb99-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-241"><a href="#cb99-241" aria-hidden="true" tabindex="-1"></a><span class="co"># create bar graph for drug-related arrests.</span></span>
<span id="cb99-242"><a href="#cb99-242" aria-hidden="true" tabindex="-1"></a>arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(a_desc <span class="sc">==</span> <span class="st">"DANGEROUS DRUGS"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb99-243"><a href="#cb99-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(demo)) <span class="sc">%&gt;%</span></span>
<span id="cb99-244"><a href="#cb99-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(demo) <span class="sc">%&gt;%</span> </span>
<span id="cb99-245"><a href="#cb99-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-246"><a href="#cb99-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(demo,<span class="sc">-</span>n<span class="sc">/</span><span class="dv">129285</span><span class="sc">*</span><span class="dv">100</span>), <span class="at">y =</span> n<span class="sc">/</span><span class="dv">129285</span> <span class="sc">*</span> <span class="dv">100</span>, <span class="at">fill =</span> demo)) <span class="sc">+</span></span>
<span id="cb99-247"><a href="#cb99-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb99-248"><a href="#cb99-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb99-249"><a href="#cb99-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top Demographic Profiles of Drug Offenders in NYC (Jan 2017 to Jun 2022)"</span>, <span class="at">x =</span> <span class="st">"Profile"</span>, <span class="at">y =</span> <span class="st">"Percent"</span>) <span class="sc">+</span></span>
<span id="cb99-250"><a href="#cb99-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%0.2f"</span>, ..y..)), <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.9</span>), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.25</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb99-251"><a href="#cb99-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb99-252"><a href="#cb99-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-253"><a href="#cb99-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-254"><a href="#cb99-254" aria-hidden="true" tabindex="-1"></a>In the above graphs, each demographic profile is labelled with a different colour, so that we can see the differences in proportion clearly. In the duration of 5 years, the top 5 demographic profiles are the same for all arrests and drug-related arrests (except for a switch in order at the 3rd and 4th positions). This somewhat answers our research question:</span>
<span id="cb99-255"><a href="#cb99-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-256"><a href="#cb99-256" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb99-257"><a href="#cb99-257" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 1</span></span>
<span id="cb99-258"><a href="#cb99-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-259"><a href="#cb99-259" aria-hidden="true" tabindex="-1"></a>When comparing all arrests and drug-related arrests, the top five demographic profiles of offenders seem to be largely similar. They are all male. Age group varies based on ethnicity: black men aged 18 to 64 are all quite likely to be arrested, although this was greater for black men aged 25-44. For white Hispanic and white men, arrests are concentrated in the 25-44 age group.</span>
<span id="cb99-260"><a href="#cb99-260" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb99-261"><a href="#cb99-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-262"><a href="#cb99-262" aria-hidden="true" tabindex="-1"></a>However, both bar graphs seem to show a stark difference between arrests of black males aged 25-44 and the other four groups. I am interested to see if this difference is significant.</span>
<span id="cb99-263"><a href="#cb99-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-266"><a href="#cb99-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-267"><a href="#cb99-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: chi square</span></span>
<span id="cb99-268"><a href="#cb99-268" aria-hidden="true" tabindex="-1"></a><span class="co"># create new dataset for chi-square test.</span></span>
<span id="cb99-269"><a href="#cb99-269" aria-hidden="true" tabindex="-1"></a>chi_square <span class="ot">&lt;-</span> arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(demo)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(demo <span class="sc">==</span>  <span class="st">"BLACK_M_18-24"</span> <span class="sc">|</span> demo <span class="sc">==</span> <span class="st">"BLACK_M_25-44"</span> <span class="sc">|</span> demo <span class="sc">==</span> <span class="st">"BLACK_M_45-64"</span> <span class="sc">|</span> demo <span class="sc">==</span> <span class="st">"WHITE HISPANIC_M_25-44"</span> <span class="sc">|</span> demo <span class="sc">==</span> <span class="st">"WHITE_M_25-44"</span>)</span>
<span id="cb99-270"><a href="#cb99-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-271"><a href="#cb99-271" aria-hidden="true" tabindex="-1"></a><span class="co"># run chi-square test.</span></span>
<span id="cb99-272"><a href="#cb99-272" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="at">x =</span> <span class="fu">table</span>(chi_square<span class="sc">$</span>demo))</span>
<span id="cb99-273"><a href="#cb99-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-274"><a href="#cb99-274" aria-hidden="true" tabindex="-1"></a><span class="co"># attempt post-hoc test - this is not working.</span></span>
<span id="cb99-275"><a href="#cb99-275" aria-hidden="true" tabindex="-1"></a><span class="co"># table_demo &lt;- chi_square %&gt;% count(demo)</span></span>
<span id="cb99-276"><a href="#cb99-276" aria-hidden="true" tabindex="-1"></a><span class="co"># chisq.posthoc.test(table_demo, method = "bonferroni")</span></span>
<span id="cb99-277"><a href="#cb99-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-278"><a href="#cb99-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-279"><a href="#cb99-279" aria-hidden="true" tabindex="-1"></a>The chi-square test reveals significant differences between the top 5 demographic profiles for drug-related and non-drug-related arrests, 𝜒^2^ (4) = 140432, *p* \&lt; .001. However, this doesn't tell us which groups had the differences. ***I downloaded a post-hoc package, but I can't get it to work.***</span>
<span id="cb99-280"><a href="#cb99-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-281"><a href="#cb99-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## Additional Analysis: Question 1</span></span>
<span id="cb99-282"><a href="#cb99-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-283"><a href="#cb99-283" aria-hidden="true" tabindex="-1"></a>**Doing the above analysis also made me interested in exploring a few other questions:**</span>
<span id="cb99-284"><a href="#cb99-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-285"><a href="#cb99-285" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How did the proportion of drug-related arrests change over time?</span>
<span id="cb99-286"><a href="#cb99-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-287"><a href="#cb99-287" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Within drug-related arrests, how did the proportions of each demographic variable (age, sex, race) change over time?</span>
<span id="cb99-288"><a href="#cb99-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-291"><a href="#cb99-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-292"><a href="#cb99-292" aria-hidden="true" tabindex="-1"></a><span class="co"># keep only top 3 levels of a_desc.</span></span>
<span id="cb99-293"><a href="#cb99-293" aria-hidden="true" tabindex="-1"></a>arrest<span class="sc">$</span>a_desc <span class="ot">&lt;-</span> <span class="fu">fct_lump_n</span>(arrest<span class="sc">$</span>a_desc, <span class="dv">3</span>, <span class="at">other_level=</span><span class="st">"Other"</span>)</span>
<span id="cb99-294"><a href="#cb99-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-295"><a href="#cb99-295" aria-hidden="true" tabindex="-1"></a><span class="co"># change year to factor type so i can plot it.</span></span>
<span id="cb99-296"><a href="#cb99-296" aria-hidden="true" tabindex="-1"></a>arrest<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(arrest<span class="sc">$</span>year)</span>
<span id="cb99-297"><a href="#cb99-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-298"><a href="#cb99-298" aria-hidden="true" tabindex="-1"></a><span class="co"># stacked bar graph for offense type.</span></span>
<span id="cb99-299"><a href="#cb99-299" aria-hidden="true" tabindex="-1"></a>arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(a_desc)) <span class="sc">%&gt;%</span></span>
<span id="cb99-300"><a href="#cb99-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb99-301"><a href="#cb99-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y=</span>..count.., <span class="at">fill=</span>a_desc), <span class="at">position=</span><span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb99-302"><a href="#cb99-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb99-303"><a href="#cb99-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proportion of Different Offences in NYC (Jan 2017 to Jun 2022)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Percent"</span>) <span class="sc">+</span></span>
<span id="cb99-304"><a href="#cb99-304" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb99-305"><a href="#cb99-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">hjust=</span><span class="dv">1</span>)) </span>
<span id="cb99-306"><a href="#cb99-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-307"><a href="#cb99-307" aria-hidden="true" tabindex="-1"></a><span class="co"># stacked bar graph for age.</span></span>
<span id="cb99-308"><a href="#cb99-308" aria-hidden="true" tabindex="-1"></a>arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(a_desc <span class="sc">==</span> <span class="st">"DANGEROUS DRUGS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-309"><a href="#cb99-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(a_age)) <span class="sc">%&gt;%</span></span>
<span id="cb99-310"><a href="#cb99-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb99-311"><a href="#cb99-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">fill=</span>a_age), <span class="at">position=</span><span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb99-312"><a href="#cb99-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb99-313"><a href="#cb99-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Age Composition of Drug Offenders in NYC (Jan 2017 to Jun 2022)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Percent"</span>) <span class="sc">+</span></span>
<span id="cb99-314"><a href="#cb99-314" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb99-315"><a href="#cb99-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb99-316"><a href="#cb99-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-317"><a href="#cb99-317" aria-hidden="true" tabindex="-1"></a><span class="co"># stacked bar graph for race.</span></span>
<span id="cb99-318"><a href="#cb99-318" aria-hidden="true" tabindex="-1"></a>arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(a_desc <span class="sc">==</span> <span class="st">"DANGEROUS DRUGS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-319"><a href="#cb99-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(a_race)) <span class="sc">%&gt;%</span></span>
<span id="cb99-320"><a href="#cb99-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb99-321"><a href="#cb99-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">fill=</span>a_race), <span class="at">position=</span><span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb99-322"><a href="#cb99-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb99-323"><a href="#cb99-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Race Composition of Drug Offenders in NYC (Jan 2017 to Jun 2022)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Percent"</span>) <span class="sc">+</span></span>
<span id="cb99-324"><a href="#cb99-324" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb99-325"><a href="#cb99-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">hjust=</span><span class="dv">1</span>)) </span>
<span id="cb99-326"><a href="#cb99-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-327"><a href="#cb99-327" aria-hidden="true" tabindex="-1"></a><span class="co"># stacked bar graph for sex.</span></span>
<span id="cb99-328"><a href="#cb99-328" aria-hidden="true" tabindex="-1"></a>arrest <span class="sc">%&gt;%</span> <span class="fu">filter</span>(a_desc <span class="sc">==</span> <span class="st">"DANGEROUS DRUGS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-329"><a href="#cb99-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(a_sex)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb99-330"><a href="#cb99-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">fill=</span>a_sex), <span class="at">position=</span><span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb99-331"><a href="#cb99-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb99-332"><a href="#cb99-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Sex Composition of Drug Offenders in NYC (Jan 2017 to Jun 2022)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Percent"</span>) <span class="sc">+</span></span>
<span id="cb99-333"><a href="#cb99-333" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb99-334"><a href="#cb99-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb99-335"><a href="#cb99-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-336"><a href="#cb99-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-337"><a href="#cb99-337" aria-hidden="true" tabindex="-1"></a>This is what we can gather from the stacked bar graphs above. - The proportion of drug-related arrests has shrunk with time - this is a good thing! Although it is a part of the top 3 reasons for arrests, it is definitely on a downward trend. It will be useful to compare this with the change in syringes collected over time, to see if NYC's stricter policies on drug usage and offences are effective. - ***I need to add percent labels to the demographic graphs to interpret them.***</span>
<span id="cb99-338"><a href="#cb99-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-339"><a href="#cb99-339" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analysis: Question 2</span></span>
<span id="cb99-340"><a href="#cb99-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-341"><a href="#cb99-341" aria-hidden="true" tabindex="-1"></a>To recap, this is my second research question:</span>
<span id="cb99-342"><a href="#cb99-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-343"><a href="#cb99-343" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb99-344"><a href="#cb99-344" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 2</span></span>
<span id="cb99-345"><a href="#cb99-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-346"><a href="#cb99-346" aria-hidden="true" tabindex="-1"></a>Suppose you were walking through a borough in New York City, and you see syringe litter. Does this necessarily mean that the borough in question is unsafe -- or is this merely a bias that we have? *In simpler terms: where are syringes likely to be found? Is there an overlap with where crimes (especially drug-related crimes) occur?*</span>
<span id="cb99-347"><a href="#cb99-347" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb99-348"><a href="#cb99-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-349"><a href="#cb99-349" aria-hidden="true" tabindex="-1"></a>This question can be easily visualized via dot maps of NYC.</span>
<span id="cb99-350"><a href="#cb99-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-353"><a href="#cb99-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-354"><a href="#cb99-354" aria-hidden="true" tabindex="-1"></a><span class="co"># creating subset of syringe for visualisation.</span></span>
<span id="cb99-355"><a href="#cb99-355" aria-hidden="true" tabindex="-1"></a>syringe_map <span class="ot">&lt;-</span> syringe <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(s_long)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(s_lat)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(s_totalsyringes)</span>
<span id="cb99-356"><a href="#cb99-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-357"><a href="#cb99-357" aria-hidden="true" tabindex="-1"></a><span class="co"># visualisation of syringe_map using mapview.</span></span>
<span id="cb99-358"><a href="#cb99-358" aria-hidden="true" tabindex="-1"></a>syringe <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(s_long)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(s_lat)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(s_totalsyringes) <span class="sc">%&gt;%</span> <span class="fu">mapview</span>(<span class="at">xcol =</span> <span class="st">"s_long"</span>, <span class="at">ycol =</span> <span class="st">"s_lat"</span>, <span class="at">crs =</span> <span class="dv">4326</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>)</span>
<span id="cb99-359"><a href="#cb99-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-360"><a href="#cb99-360" aria-hidden="true" tabindex="-1"></a><span class="co"># creating arrest_map.</span></span>
<span id="cb99-361"><a href="#cb99-361" aria-hidden="true" tabindex="-1"></a>arrest_map <span class="ot">&lt;-</span> arrest <span class="sc">%&gt;%</span> <span class="fu">count</span>(a_boro)</span>
<span id="cb99-362"><a href="#cb99-362" aria-hidden="true" tabindex="-1"></a>arrest_map<span class="sc">$</span>lat <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">40.84567</span>, <span class="fl">40.67908</span>, <span class="fl">40.78322</span>, <span class="fl">40.72955</span>, <span class="fl">40.58098</span>)</span>
<span id="cb99-363"><a href="#cb99-363" aria-hidden="true" tabindex="-1"></a>arrest_map<span class="sc">$</span>long <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">73.86136</span>, <span class="sc">-</span><span class="fl">73.94672</span>, <span class="sc">-</span><span class="fl">73.97198</span>, <span class="sc">-</span><span class="fl">73.79636</span>, <span class="sc">-</span><span class="fl">74.15237</span>)</span>
<span id="cb99-364"><a href="#cb99-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-365"><a href="#cb99-365" aria-hidden="true" tabindex="-1"></a><span class="co"># visualisation of arrest_map using mapview.</span></span>
<span id="cb99-366"><a href="#cb99-366" aria-hidden="true" tabindex="-1"></a>arrest_map <span class="sc">%&gt;%</span> <span class="fu">mapview</span>(<span class="at">xcol =</span> <span class="st">"long"</span>, <span class="at">ycol =</span> <span class="st">"lat"</span>, <span class="at">crs =</span> <span class="dv">4326</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>, <span class="at">cex =</span> <span class="st">"n"</span>, <span class="at">legend =</span> <span class="cn">TRUE</span>, <span class="at">layer.name =</span> <span class="st">"value"</span>)</span>
<span id="cb99-367"><a href="#cb99-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-368"><a href="#cb99-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-369"><a href="#cb99-369" aria-hidden="true" tabindex="-1"></a>I tested the packages ggmap and mapview, and both worked great for the syringe dataset. However, the arrest dataset is simply too large for either package to load the map successfully. I decided to create a new dataframe with just the numbers of arrests in each borough and load that into mapview instead, which worked. I also like mapview better because you can zoom in and out.</span>
<span id="cb99-370"><a href="#cb99-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-371"><a href="#cb99-371" aria-hidden="true" tabindex="-1"></a>Additionally, I would like to make a time series graph of how syringes collected have changed over time. ***We can remove outliers by finding the standard deviation of s_totalsyringes. We can also make another stacked bar graph to compare the number of kiosk and ground syringes collected.***</span>
<span id="cb99-372"><a href="#cb99-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-375"><a href="#cb99-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-376"><a href="#cb99-376" aria-hidden="true" tabindex="-1"></a><span class="co"># time graph of syringes collected.</span></span>
<span id="cb99-377"><a href="#cb99-377" aria-hidden="true" tabindex="-1"></a>syringe <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(date)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(s_totalsyringes)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(s_totalsyringes <span class="sc">&lt;</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-378"><a href="#cb99-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y=</span>s_totalsyringes)) <span class="sc">+</span></span>
<span id="cb99-379"><a href="#cb99-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb99-380"><a href="#cb99-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb99-381"><a href="#cb99-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb99-382"><a href="#cb99-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">60</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb99-383"><a href="#cb99-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-384"><a href="#cb99-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-385"><a href="#cb99-385" aria-hidden="true" tabindex="-1"></a>***Just pushing this update to see if the rendering will work - I will clean up the text and code before my final submission.***</span>
<span id="cb99-386"><a href="#cb99-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-387"><a href="#cb99-387" aria-hidden="true" tabindex="-1"></a>***Planning to make 2 stacked bar graphs (proportion of syringes/arrests in different boroughs) to check if what I observe from the maps can be seen from those bar graphs too.***</span>
<span id="cb99-388"><a href="#cb99-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-389"><a href="#cb99-389" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bibliography</span></span>
<span id="cb99-390"><a href="#cb99-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-391"><a href="#cb99-391" aria-hidden="true" tabindex="-1"></a>Department of Parks and Recreation. (2022). *Parks Properties*. NYC Open Data. Retrieved from https://data.cityofnewyork.us/Recreation/Parks-Properties/enfh-gkve.</span>
<span id="cb99-392"><a href="#cb99-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-393"><a href="#cb99-393" aria-hidden="true" tabindex="-1"></a>Jahn, J., Simes, J., Cowger, T., &amp; Davis, B. (2022). Racial Disparities in Neighborhood Arrest Rates during the COVID-19 Pandemic. *Journal Of Urban Health*, *99*(1), 67-76.</span>
<span id="cb99-394"><a href="#cb99-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-395"><a href="#cb99-395" aria-hidden="true" tabindex="-1"></a>New York Police Department. (2022). *NYPD Arrest Data (Year to Date)*. NYC Open Data. Retrieved from https://data.cityofnewyork.us/Public-Safety/NYPD-Arrest-Data-Year-to-Date-/uip8-fykc.</span>
<span id="cb99-396"><a href="#cb99-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-397"><a href="#cb99-397" aria-hidden="true" tabindex="-1"></a>New York Police Department. (2022). *NYPD Arrests Data (Historic)*. NYC Open Data. Retrieved from https://data.cityofnewyork.us/Public-Safety/NYPD-Arrests-Data-Historic-/8h9b-rp9u.</span>
<span id="cb99-398"><a href="#cb99-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-399"><a href="#cb99-399" aria-hidden="true" tabindex="-1"></a>NYC Parks. (2022). *NYC Parks Syringe Litter Data Dictionary and UserGuide*. Google Docs. Retrieved from https://docs.google.com/spreadsheets/d/1VSUqd1peSc-4D2XnBZNiLdxa0Jg4z62D/edit#gid=150342678.</span>
<span id="cb99-400"><a href="#cb99-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-401"><a href="#cb99-401" aria-hidden="true" tabindex="-1"></a>NYC Parks. (2022). *Summary of Syringe Data in NYC Parks*. NYC Open Data. Retrieved from https://data.cityofnewyork.us/Public-Safety/Summary-of-Syringe-Data-in-NYC-Parks/t8xi-d5wb.</span>
<span id="cb99-402"><a href="#cb99-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-403"><a href="#cb99-403" aria-hidden="true" tabindex="-1"></a>Pierce, M., Hayhurst, K., Bird, S., Hickman, M., Seddon, T., Dunn, G., &amp; Millar, T. (2017). Insights into the link between drug use and criminality: Lifetime offending of criminally-active opiate users. *Drug And Alcohol Dependence*, *179*, 309-316.</span>
<span id="cb99-404"><a href="#cb99-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-405"><a href="#cb99-405" aria-hidden="true" tabindex="-1"></a>R Core Team. (2022). *R: A language and environment for statistical computing*. R Foundation for Statistical Computing.</span>
<span id="cb99-406"><a href="#cb99-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-407"><a href="#cb99-407" aria-hidden="true" tabindex="-1"></a>Schleiden, C., Soloski, K., Milstead, K., &amp; Rhynehart, A. (2020). Racial Disparities in Arrests: A Race Specific Model Explaining Arrest Rates Across Black and White Young Adults. *Child And Adolescent Social Work Journal*, *37*(1), 1-14.</span>
<span id="cb99-408"><a href="#cb99-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-409"><a href="#cb99-409" aria-hidden="true" tabindex="-1"></a>U.S. Census Bureau. (2022). *U.S. Census Bureau QuickFacts: New York City, New York*. Census Bureau QuickFacts. Retrieved from https://www.census.gov/quickfacts/newyorkcitynewyork.</span>
<span id="cb99-410"><a href="#cb99-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-411"><a href="#cb99-411" aria-hidden="true" tabindex="-1"></a>Wickham, H., &amp; Grolemund, G. (2017). *R for Data Science: Import, Tidy, Transform, Visualize, and Model Data* (1st ed.). O'Reilly Media.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>