---
title: "Final Project_ Akhilesh Kumar"
author: "Akhilesh Kumar Meghwal"
desription: "DACSS 601 Final Project"
date: "08/31/2022"
format:
  html:
    toc: true
    code-fold: true
    code-copy: true
    code-tools: true
categories:
  - final_project
---

## R Package/libraries

```{r}
#| label: setup
#| warning: false
#| message: false
#| 
library(tidyverse)
library(readxl)
library(purrr)
library(stringr)
library(ggmap)
library(plotly)

knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
```

## Final Project Overview

-   "Indian Penal Code (IPC) Crime Chargesheet/Accusation Rate Dataset" for different Crime Categories for a period of 4 years between 1997-2000 is selected for DACSS-601, Final Project

-   A charge sheet is a final report prepared by the investigation or law enforcement agencies for proving the accusation of a crime in a criminal court of law

-   The Indian Penal Code (IPC) is the official criminal code of India. It is a comprehensive code intended to cover all substantive aspects of criminal law.

-   The source of the datasets of 'https://data.gov.in/', where year-wise 'Chargesheeting Rate Of IPC Crimes' datasets are available for 4 years i.e., 1997,1998, 1999 and 2000

-   Each dataset contains Year wise and State/Union Territory wise, different category of Indian Penal Code (IPC) Chargesheet Rate by Government against the Accused/ Offenders.

-   Four different data-files pertaining to years 1997,1998, 1999 and 2000 have been downloaded in 'csv' format and consolidated on 'Year', 'State/Union Territory' and 'Chargesheet Rates of various Indian Penal Code-Crime Categories'

## Objective of the Analysis

-   Year wise/State wise Performance on Crime Chargesheet/Accusation Rate for different category of crimes in India from Year 1997 to 2000

-   Analyse and Identify the High, Medium & Low Performing State for different category of crimes, such as: Murder, Kidnapping, Crime Against Women in India from Year 1997 to 2000

## Fetch Datafiles' Names from working directory

-   Read all file names consisting pattern **'india-c'** and store *names* *of* *all* *files* in a character vector "crime_file_names", file names are mentioned below :
    -   india-crime-1997.csv
    -   india-crime-1998.csv
    -   india-crime-1999.csv
    -   india-crime-2000.csv

```{r}
crime_file_names <- list.files(path="_data/final_project_akhilesh", pattern="india-c+")

crime_file_names

```

## Data Wrangling

### Function: "read_crime_dataset" to read and transform datasets for analysis

-   Following chunk of code contains **'read_crime_dataset'** function, that enables reading, transforming & consolidating, various datasets pertaining to 'Chargesheet Rate Of IPC Crimes' data for years: 1997,1998, 1999 and 2000.

-   Function **'read_crime_dataset'** facilitates handling of data, column standardization, missing columns etc. to enable data transformation & consolidation across datasets pertaining to years: 1997,1998, 1999 and 2000.

-   **if-else** conditions are incorporated to clean and standardize two type of datasets

    -   It is observed that datasets for year **1999 and 2000**, contain *"Theft-Auto_Theft", "Theft-Other_Theft" & "Importation_of_Girls***"** columns, in addition to several other common columns across the datasets.
    -   Whereas, *"Theft-Auto_Theft", "Theft-Other_Theft" & "Importation_of_Girls"* columns are missing or not captured at all in year **1997 and 1998**.

-   The **'if condition' section, in the** 'read_crime_dataset' function, manages datasets of years: **1997 & 1998**;

    -   It maintains 'standard column names' across the datasets, manages missing columns through dplyr-mutate.

-   The **'else condition'** section manages datasets of years 1999 and 2000

-   **'year'** value is extracted and stored through*'**cf'*** parameter in **'read_crime_dataset'** function, passed through file **crime_file_names** in **'map_dfr'**

```{r}

read_crime_dataset<-function(cf){
  
  if(cf %in% c("crime-1997.csv", "crime-1998.csv")){
    crime_data_update<-read_csv(str_c("_data/final_project_akhilesh", cf, sep="/"), 
                                col_names = c("SI_No", "States_UTs", "Murder", "Attempt_to_Commit_Murder", "C.H._Not_Amounting_to_Murder", "Rape", "Kidnapping_&_Abduction-Total", "Kidnapping_&_Abduction-of_Women_&_Girls", "Kidnapping_&_Abduction-of_others", "Dacoity", "Preparation_and_Assembly_for_Dacoity", "Robbery", "Burglary", "Theft", "Riots", "Criminal_Breach_of_Trust", "Cheating", "Counterfeiting", "Arson", "Hurt", "Dowry_Deaths", "Molestation", "Sexual_Harassment", "Cruelty_by_Husband_and_Relatives", "Others_IPC_Crimes", "Total_Cognizable_Crimes_Under_IPC"), 
                                col_types = 'nfnnnnnnnnnnnnnnnnnnnnnnnn', skip = 1) %>%
      mutate("Theft-Auto_Theft" = vector("numeric" , 35), 
             "Theft-Other_Theft" = vector( "numeric", 35 ), 
             "Importation_of_Girls" = vector( "numeric", 35 )) %>% 
      
      rename('Theft-Total'='Theft') %>% 
      relocate("Theft-Auto_Theft",  .after = "Theft-Total") %>%
      relocate("Theft-Other_Theft",  .after = "Theft-Auto_Theft") %>%
      relocate("Importation_of_Girls",  .after = "Cruelty_by_Husband_and_Relatives") %>%
      filter(str_detect(SI_No, "Total", negate=TRUE)) %>% 
      mutate(Year = factor(str_extract(cf, "(\\d{4})"))) %>% 
      relocate(Year, .before = "States_UTs") %>% 
      mutate(States_UTs = str_to_title(States_UTs))
  }else{
    crime_data_update<-read_csv(str_c("_data/final_project_akhilesh", cf, sep="/"), 
                                col_names = c("SI_No", "States_UTs", "Murder", "Attempt_to_Commit_Murder", "C.H._Not_Amounting_to_Murder", "Rape", "Kidnapping_&_Abduction-Total", "Kidnapping_&_Abduction-of_Women_&_Girls", "Kidnapping_&_Abduction-of_others", "Dacoity", "Preparation_and_Assembly_for_Dacoity", "Robbery", "Burglary", "Theft-Total", "Theft-Auto_Theft", "Theft-Other_Theft", "Riots", "Criminal_Breach_of_Trust", "Cheating", "Counterfeiting", "Arson", "Hurt", "Dowry_Deaths", "Molestation", "Sexual_Harassment", "Cruelty_by_Husband_and_Relatives", "Importation_of_Girls", "Others_IPC_Crimes", "Total_Cognizable_Crimes_Under_IPC"), 
                                col_types = 'nfnnnnnnnnnnnnnnnnnnnnnnnnnnn', skip = 1) %>% 
      filter(str_detect(SI_No, "Total", negate=TRUE)) %>% 
      mutate(Year = factor(str_extract(cf, "(\\d{4})"))) %>% 
      relocate(Year, .before = "States_UTs") %>% 
      mutate(States_UTs = str_to_title(States_UTs))
  }
  
  
  return(crime_data_update)
}


```

## Read in Data

-   Data Read from multiple file with varied data columns

-   Data Applied **"map_dfr"** function from **"purr package"** to consolidate data from multiple datasets in dataframe/tibble format

-   Function call from **"map_dfr"** to **"read_crime_dataset"**, to read all datasets as mentioned:

    -   'india-crime-1997'
    -   'india-crime-1998',
    -   'india-crime-1999'
    -   'india-crime-2000'

-   The above mentioned Datasets are stored in different csv files for years 1997, 1998, 1999 & 2000

```{r}


crime_conviction_rate_data <- map_dfr(crime_file_names, read_crime_dataset) 

head(crime_conviction_rate_data)
View(crime_conviction_rate_data)

```

## Summary Description

-   Summary Description of "crime_conviction_rate_data" dataframe using **dfSummary**

```{r}


print(summarytools::dfSummary(crime_conviction_rate_data,
                              varnumbers = FALSE,
                              plain.ascii  = FALSE,
                              style        = "grid",
                              graph.magnif = 0.70,
                              valid.col    = FALSE),
      method = 'render',
      table.classes = 'table-condensed')

```

## NA values Replacement

-   **NA values, in different columns pertaining to different crime categories, are replaced as explained below:**

    -   state wise, crime category wise, Mean average of Chargesheet Rate is calculated
    -   NA values of original dataset for Year, State, crime category is replaced with relevant mean values as calculated above for State and crime category

-   **NA values replacement through state wise, crime catgory wise Average value of Chargesheet Rate for four years 1997,1998, 1999, 2000**

```{r}
State_crime_wise_conviction_rate <- crime_conviction_rate_data %>% 
select(3:30) %>% 
pivot_longer(!States_UTs, names_to="crime_type", values_to = "chargesheet_rate") %>% 
mutate_at(3, ~replace_na(., 0)) %>% 
group_by(States_UTs, crime_type) %>%  
summarise(mean = mean(chargesheet_rate, .groups='keep')) %>% 
unite('States/UTs_crime', c(States_UTs, crime_type))

View(State_crime_wise_conviction_rate)
head(State_crime_wise_conviction_rate)
```

-   **Pivot Longer on crime_conviction_rate_data to perform left join over unite of two columns, namely: States_UTs, crime_type**

    -   The result dataset would be further used to perform grouping, filtering, summary analysis on different parameters, such as crime_type

```{r}

crime_data_pivot_long<-crime_conviction_rate_data %>% 
  pivot_longer(cols = colnames(crime_conviction_rate_data)[4:30],
                                    names_to="crime_type",
                                    values_to = "chargesheet_rate") %>% 
  unite('States/UTs_crime', c(States_UTs, crime_type), remove=FALSE)
  
View(crime_data_pivot_long)
head(crime_data_pivot_long)

# 513 observations where chargesheet_rate is NA 

```

-   **left join to replace NA values in crime_type column in 'crime_data_pivot_long' datset with relevant values of 'mean' column in 'State_crime_wise_conviction_rate' dataset**

```{r}
  crime_data_na_rm <- left_join(crime_data_pivot_long, State_crime_wise_conviction_rate, by = 'States/UTs_crime') %>% 
  mutate(chargesheet_rate=coalesce(chargesheet_rate, mean)) %>% 
  select(2,4,5,6)

# mutate to replace values from columns 7 to 6 where na


View(crime_data_na_rm)

```

## Summary Analysis

-   **State_UTs wise Performance on Crime Chargesheet/Accusation Rate for following three Categories pertaining to Murder Crime**

-   'Murder',

-   'Attempt_to_Commit_Murder'

-   'C.H.\_Not_Amounting_to_Murder'

```{r}
crime_murder <- crime_data_na_rm %>%
  select(2,3,4) %>% 
  filter(crime_type %in% c('Murder', 'Attempt_to_Commit_Murder', 'C.H._Not_Amounting_to_Murder')) %>% 
  group_by(crime_type, States_UTs) %>% 
  summarise(chargesheet_rate = mean(chargesheet_rate), .groups = 'keep') %>% 
  mutate(category = case_when(
    chargesheet_rate>=50 & chargesheet_rate <=70   ~ "Medium", 
    chargesheet_rate > 70 ~ "High", 
    TRUE ~ "Low")) %>% 
 arrange(desc(crime_type), desc(chargesheet_rate), States_UTs)

crime_murder

```

-   **State_UTs wise Performance on Crime Chargesheet/Accusation Rate for Average of following three Categories pertaining to Murder Crime:**

-   'Murder',

-   'Attempt_to_Commit_Murder'

-   'C.H.\_Not_Amounting_to_Murder'

```{r}
crime_murder_state <- crime_data_na_rm %>%
  select(2,3,4) %>% 
  filter(crime_type %in% c('Murder', 'Attempt_to_Commit_Murder', 'C.H._Not_Amounting_to_Murder')) %>% 
  group_by(States_UTs) %>% 
  summarise(chargesheet_rate = mean(chargesheet_rate), .groups = 'keep') %>% 
  mutate(category = case_when(
    chargesheet_rate>=50 & chargesheet_rate <=70   ~ "Medium", 
    chargesheet_rate > 70 ~ "High", 
    TRUE ~ "Low"))%>% 
  arrange(desc(chargesheet_rate), States_UTs)

crime_murder_state
  

```

### Bar Graph Murder Related Crimes

-   Bar Graph on state wise performance on Average Chargesheet Rate of 'Murder', 'Attempt_to_Commit_Murder & 'C.H.\_Not_Amounting_to_Murder
    -   Y column displays "Average Chargesheet Rate" of Murder related crime.
    -   X Columns displays different states or union territories in India, considered for analysis.

```{r}
ggplot(crime_murder_state, aes(x=States_UTs, y=chargesheet_rate, fill=category)) + 
  geom_bar(stat = "identity")+  theme(axis.text.x=element_text(angle=90,hjust=1))+
  labs(title = "Bar Graph on state wise performance on Average Chargesheet Rate of Murder related crimes")

```

### Tabular Presentation Murder Related Crimes

-   Tabular Presentation using Kable to display state wise performance on Average Chargesheet Rate of 'Murder', 'Attempt_to_Commit_Murder & 'C.H.\_Not_Amounting_to_Murder'

```{r}

half <-c(1:round(nrow(crime_murder_state)/2))
knitr::kable(list(crime_murder_state[half,],  
           matrix(numeric(), nrow=0, ncol=1),
           padding=20,
           crime_murder_state[-half,]), 
           caption = "State wise Avg. Chargesheet Rate of 'Murder', 'Attempt_to_Commit_Murder & 'C.H._Not_Amounting_to_Murder'")%>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), font_size=12, full_width = TRUE, fixed_thead = F)
```

-   **Year wise, State wise Performance on Crime Chargesheet/Accusation Rate for Average of following three Categories pertaining to Murder Crime:**

-   'Murder',

-   'Attempt_to_Commit_Murder'

-   'C.H.\_Not_Amounting_to_Murder'

```{r}
crime_murder_yr_state <- crime_data_na_rm %>%
  filter(crime_type %in% c('Murder', 'Attempt_to_Commit_Murder', 'C.H._Not_Amounting_to_Murder')) %>% 
  select(1, 2, 4)%>%
  group_by(Year, States_UTs)%>% 
  summarise(chargesheet_rate = mean(chargesheet_rate), .groups = 'keep')%>% 
  mutate(category = case_when(
    chargesheet_rate>=50 & chargesheet_rate <=70   ~ "Medium", 
    chargesheet_rate > 70 ~ "High", 
    TRUE ~ "Low")) %>% 
  mutate(Year=as.numeric(as.character(Year)))

crime_murder_yr_state

crime_murder_yr_state_h<- crime_murder_yr_state%>% 
  filter(category=='High')

crime_murder_yr_state_m<- crime_murder_yr_state%>% 
  filter(category=='Medium')

crime_murder_yr_state_l<- crime_murder_yr_state%>% 
  filter(category=='Low')
```

### Time Series Plot Murder Related Crimes

**Time Series Plot for State wise, Murder Related Charge-sheet Rate, where Average chargesheet rate is 'Medium' or between 50 and 70 (Yr 1997-2000)**

```{r}

plot_m_m <- ggplot(crime_murder_yr_state_m, aes(y = chargesheet_rate, color = as.factor(States_UTs), x = as.numeric(as.character(Year)))) + 
  geom_line() + 
  geom_point()+
  labs(title = "Time Series Plot, State wise, Murder related Charge-sheet Rate is Medium or between 50-70 (Yr 1997-2000)")+
  xlab('Years')+
  ylab('Chargesheet Rate')+
    theme_classic()
 
ggplotly(plot_m_m)

```

**Time Series Plot for State wise, Murder Related Charge-sheet Rate, where Average chargesheet rate is 'Low'/Less than 50 (Yr 1997-2000)**

```{r}

plot_m_l <- ggplot(crime_murder_yr_state_l, aes(y = chargesheet_rate, color = as.factor(States_UTs), x = as.numeric(as.character(Year)))) + 
  geom_line() + 
  geom_point()+
  labs(title = "Time Series Plot, State wise, 'Crime Against Women' related Charge-sheet Rate is 'Low' or Less than 50 (Yr 1997-2000)")+
  xlab('Years')+
  ylab('Chargesheet Rate')+
    theme_classic()
 
ggplotly(plot_m_l)

```

### State_UTs wise Performance on Crime Chargesheet/Accusation Rate for following three Categories pertaining to "Kidnapping & Abduction" Crime

-   'Kidnapping & Abduction - Total',
-   'Kidnapping & Abduction - of Women & Girls'
-   'Kidnapping & Abduction - of others'

```{r}
crime_kidnap <- crime_data_na_rm %>%
  select(2,3,4) %>% 
  filter(crime_type %in% c('Kidnapping_&_Abduction-Total', 'Kidnapping_&_Abduction-of_Women_&_Girls', 'Kidnapping_&_Abduction-of_others')) %>% 
  group_by(crime_type, States_UTs) %>% 
  summarise(chargesheet_rate = mean(chargesheet_rate), .groups = 'keep') %>% 
  mutate(category = case_when(
    chargesheet_rate>=50 & chargesheet_rate <=70   ~ "Medium", 
    chargesheet_rate > 70 ~ "High", 
    TRUE ~ "Low"))%>% 
 arrange(desc(crime_type), desc(chargesheet_rate), States_UTs)
  
# arrange(desc(chargesheet_rate))
# sorting not working
View(crime_kidnap)

```

-   **State_UTs wise Performance on Crime Chargesheet/Accusation Rate for Average of following three Categories pertaining to "Kidnapping & Abduction" Crime**

    -   'Kidnapping & Abduction - Total',
    -   'Kidnapping & Abduction - of Women & Girls'
    -   'Kidnapping & Abduction - of others'

```{r}
crime_kidnap_state <- crime_data_na_rm %>%
  select(2,3,4) %>% 
  filter(crime_type %in% c('Kidnapping_&_Abduction-Total', 'Kidnapping_&_Abduction-of_Women_&_Girls', 'Kidnapping_&_Abduction-of_others')) %>% 
  group_by(States_UTs) %>% 
  summarise(chargesheet_rate = mean(chargesheet_rate), .groups = 'keep') %>% 
  mutate(category = case_when(
    chargesheet_rate>=50 & chargesheet_rate <=70   ~ "Medium", 
    chargesheet_rate > 70 ~ "High", 
    TRUE ~ "Low"))%>% 
  arrange(desc(chargesheet_rate), States_UTs)

crime_kidnap_state
  


```

### Bar Graph Kidnap Related Crimes

-   Bar Graph on state wise performance on Average Chargesheet Rate of'Kidnapping & Abduction - Total','Kidnapping & Abduction - of Women & Girls'& 'Kidnapping & Abduction - of others'
    -   Y column displays "Average Chargesheet Rate" of Kidnap related crime.
    -   X Columns displays different states or union territories in India, considered for analysis.

```{r}
ggplot(crime_kidnap_state, aes(x=States_UTs, y=chargesheet_rate, fill=category)) + 
  geom_bar(stat = "identity")+  theme(axis.text.x=element_text(angle=90,hjust=1))+
  labs(title = "Bar Graph on state wise performance on Average Chargesheet Rate of Kidnap related crimes")
```

#### Tabular Presentation Kidnap Related Crimes

-   Tabular Presentation using Kable to display state wise performance on Average Chargesheet Rate of 'Kidnapping & Abduction - Total','Kidnapping & Abduction - of Women & Girls' & 'Kidnapping & Abduction - of others'

```{r}

half <-c(1:round(nrow(crime_kidnap_state)/2))
knitr::kable(list(crime_kidnap_state[half,],  
           matrix(numeric(), nrow=0, ncol=1),
           padding=20,
           crime_kidnap_state[-half,]), 
           caption = "State wise Avg. Chargesheet Rate of - 'Kidnapping & Abduction - Total	', 
- 'Kidnapping & Abduction - of Women & Girls'
- 'Kidnapping & Abduction - of others'")%>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), font_size=12, full_width = TRUE, fixed_thead = F)
```

-   **Year wise, State_UTs wise Performance on Crime Chargesheet/Accusation Rate for Average of following three Categories pertaining to "Kidnapping & Abduction" Crime**

-   'Kidnapping & Abduction - Total',

-   'Kidnapping & Abduction - of Women & Girls'

-   'Kidnapping & Abduction - of others'

```{r}
crime_kidnap_yr_state <- crime_data_na_rm %>%
  filter(crime_type %in% c('Kidnapping_&_Abduction-Total', 'Kidnapping_&_Abduction-of_Women_&_Girls', 'Kidnapping_&_Abduction-of_others')) %>% 
  select(1, 2, 4)%>%
  group_by(Year, States_UTs)%>% 
  summarise(chargesheet_rate = mean(chargesheet_rate), .groups = 'keep')%>% 
  mutate(category = case_when(
    chargesheet_rate>=50 & chargesheet_rate <=70   ~ "Medium", 
    chargesheet_rate > 70 ~ "High", 
    TRUE ~ "Low"))

crime_kidnap_yr_state

crime_kidnap_yr_state_h<- crime_kidnap_yr_state%>% 
  filter(category=='High')

crime_kidnap_yr_state_m<- crime_kidnap_yr_state%>% 
  filter(category=='Medium')

crime_kidnap_yr_state_l<- crime_kidnap_yr_state%>% 
  filter(category=='Low')
```

### Time Series Plot Kidnap related crimes

**Time Series Plot for State wise, Kidnap Related Charge-sheet Rate, where Average chargesheet rate is 'Medium' or between 50 and 70 (Yr 1997-2000)**

```{r}

plot_k_m <- ggplot(crime_kidnap_yr_state_m, aes(y = chargesheet_rate, color = as.factor(States_UTs), x = as.numeric(as.character(Year)))) + 
  geom_line() + 
  geom_point()+
  labs(title = "Time Series Plot, State wise, Kidnap related Charge-sheet Rate is Medium or between 50-70 (Yr 1997-2000)")+
  xlab('Years')+
  ylab('Chargesheet Rate')+
    theme_classic()
 
ggplotly(plot_k_m)

```

**Time Series Plot for State wise, Crime Against Women Related Charge-sheet Rate, where Average chargesheet rate is 'Low'/Less than 50 (Yr 1997-2000)**

```{r}

plot_k_l <- ggplot(crime_kidnap_yr_state_l, aes(y = chargesheet_rate, color = as.factor(States_UTs), x = as.numeric(as.character(Year)))) + 
  geom_line() + 
  geom_point()+
  labs(title = "Time Series Plot, State wise, Kidnap related Charge-sheet Rate is 'Low' or Less than 50 (Yr 1997-2000)")+
  xlab('Years')+
  ylab('Chargesheet Rate')+
    theme_classic()
 
ggplotly(plot_k_l)

```

**- State_UTs wise Performance on Crime Chargesheet/Accusation Rate for following Seven Categories pertaining to Crime Against Women:**

-   Rape
-   Kidnapping\_&*Abduction-of_Women*&\_Girls
-   Dowry_Deaths
-   Molestation
-   Sexual_Harassment
-   Cruelty_by_Husband_and_Relatives
-   Importation_of_Girls

```{r}
crime_against_women <- crime_data_na_rm %>%
  select(2,3,4) %>%
  filter(crime_type %in% c('Rape', 'Kidnapping_&_Abduction-of_Women_&_Girls',"Dowry_Deaths", "Molestation", "Sexual_Harassment", "Cruelty_by_Husband_and_Relatives", "Importation_of_Girls")) %>% 
  group_by(crime_type, States_UTs) %>% 
  summarise(chargesheet_rate = mean(chargesheet_rate), .groups = 'keep') %>% 
  mutate(category = case_when(
    chargesheet_rate>=50 & chargesheet_rate <=70   ~ "Medium", 
    chargesheet_rate > 70 ~ "High", 
    TRUE ~ "Low")) %>% 
 arrange(desc(crime_type), desc(chargesheet_rate), States_UTs)


```

**- State_UTs wise Performance on Crime Chargesheet/Accusation Rate for Average of following Seven Categories pertaining to Crime Against Women**

-   Rape
-   Kidnapping\_&*Abduction-of_Women*&\_Girls
-   Dowry_Deaths
-   Molestation
-   Sexual_Harassment
-   Cruelty_by_Husband_and_Relatives
-   Importation_of_Girls

```{r}
crime_against_women_state <- crime_data_na_rm %>%
  select(2,3,4) %>% 
  filter(crime_type %in% c('Rape', 'Kidnapping_&_Abduction-of_Women_&_Girls', "Dowry_Deaths", "Molestation", "Sexual_Harassment", "Cruelty_by_Husband_and_Relatives", "Importation_of_Girls")) %>% 
  group_by(States_UTs) %>% 
  summarise(chargesheet_rate = mean(chargesheet_rate), .groups = 'keep') %>% 
  mutate(category = case_when(
    chargesheet_rate>=50 & chargesheet_rate <=70   ~ "Medium", 
    chargesheet_rate > 70 ~ "High", 
    TRUE ~ "Low")) %>% 
  arrange(desc(chargesheet_rate), States_UTs)

crime_against_women_state

```

### Bar Graph Crime Against Women

-   Bar Graph on state wise performance on Average Chargesheet Rate of Crime Against Women
    -   Y column displays "Average Chargesheet Rate" of Crime Against Women.
    -   X Columns displays different states or union territories in India, considered for analysis.

```{r}
ggplot(crime_against_women_state, aes(x=States_UTs, y=chargesheet_rate, fill=category)) + 
  geom_bar(stat = "identity")+  theme(axis.text.x=element_text(angle=90,hjust=1))+
  labs(title = "Bar Graph on state wise performance on Average Chargesheet Rate of Crime Against Women")

```

### Tabular Presentation Crime Against Women

-   Tabular Presentation using Kable to display state wise performance on Average Chargesheet Rate of Rape, Kidnapping\_&*Abduction-of_Women*&\_Girls, Dowry_Deaths, Molestation, Sexual_Harassment, Cruelty_by_Husband_and_Relatives, Importation_of_Girls

```{r}

half <-c(1:round(nrow(crime_against_women_state)/2))
knitr::kable(list(crime_against_women_state[half,],  
           matrix(numeric(), nrow=0, ncol=1),
           padding=20,
           crime_against_women[-half,]), 
           caption = "State wise Avg. Chargesheet Rate of - 'Crime Against Women'")%>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), font_size=12, full_width = TRUE, fixed_thead = F)
```

**- Year wise, State_UTs wise Performance on Crime Chargesheet/Accusation Rate for Average of following Seven Categories pertaining to Crime Against Women**

-   Rape
-   Kidnapping\_&*Abduction-of_Women*&\_Girls
-   Dowry_Deaths
-   Molestation
-   Sexual_Harassment
-   Cruelty_by_Husband_and_Relatives
-   Importation_of_Girls

```{r}
  
crime_against_women_yr_state <- crime_data_na_rm %>%
  filter(crime_type %in% c('Rape', 'Kidnapping_&_Abduction-of_Women_&_Girls', "Dowry_Deaths", "Molestation", "Sexual_Harassment", "Cruelty_by_Husband_and_Relatives", "Importation_of_Girls")) %>% 
  select(1, 2, 4)%>%
  group_by(Year, States_UTs)%>% 
  summarise(chargesheet_rate = mean(chargesheet_rate), .groups = 'keep')%>% 
  mutate(category = case_when(
    chargesheet_rate>=50 & chargesheet_rate <=70   ~ "Medium", 
    chargesheet_rate > 70 ~ "High", 
    TRUE ~ "Low"))

crime_against_women_yr_state
  
crime_against_women_yr_state_h<- crime_against_women_yr_state%>% 
  filter(category=='High')

crime_against_women_yr_state_m<- crime_against_women_yr_state%>% 
  filter(category=='Medium')

crime_against_women_yr_state_l<- crime_against_women_yr_state%>% 
  filter(category=='Low')

```

### Time Series Plot Crime Against Women

**Time Series Plot for State wise, Crime Against Women Related Charge-sheet Rate, where Average chargesheet rate is 'Medium' or between 50 and 70 (Yr 1997-2000)**

```{r}

plot_w_m <- ggplot(crime_against_women_yr_state_m, aes(y = chargesheet_rate, color = as.factor(States_UTs), x = as.numeric(as.character(Year)))) + 
  geom_line() + 
  geom_point()+
  labs(title = "Time Series Plot, State wise, 'Crime Against Women' related Charge-sheet Rate is Medium or between 50-70 (Yr 1997-2000)")+
  xlab('Years')+
  ylab('Chargesheet Rate')+
    theme_classic()
 
ggplotly(plot_w_m)

```

**Time Series Plot for State wise, Crime Against Women Related Charge-sheet Rate, where Average chargesheet rate is 'Low'/Less than 50 (Yr 1997-2000)**

```{r}

plot_w_l <- ggplot(crime_against_women_yr_state_l, aes(y = chargesheet_rate, color = as.factor(States_UTs), x = as.numeric(as.character(Year)))) + 
  geom_line() + 
  geom_point()+
  labs(title = "Time Series Plot, State wise, 'Crime Against Women' related Charge-sheet Rate is 'Low' or Less than 50 (Yr 1997-2000)")+
  xlab('Years')+
  ylab('Chargesheet Rate')+
    theme_classic()
ggplotly(plot_w_l)

```
