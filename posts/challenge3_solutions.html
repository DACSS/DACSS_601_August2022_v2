<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Meredith Rolfe">
<meta name="dcterms.date" content="2022-08-18">
<meta name="description" content="Tidy Data: Pivoting">

<title>- Challenge 3 Solutions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta name="twitter:title" content="- Challenge 3 Solutions">
<meta name="twitter:description" content="Tidy Data: Pivoting">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <img src="../images/UMass White Wordmark Horiz.png" alt="">
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/DACSS_601_August2022_v2">August 2022 Posts</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">Contributors</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss">DACSS</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS/DACSS_601_August2022_v2"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Challenge 3 Solutions</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">challenge_3</div>
    <div class="quarto-category">solution</div>
  </div>
  </div>

<div>
  <div class="description">
    Tidy Data: Pivoting
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Meredith Rolfe </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 18, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message=</span><span class="cn">FALSE</span>, <span class="at">cache=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="challenge-overview" class="level2">
<h2 class="anchored" data-anchor-id="challenge-overview">Challenge Overview</h2>
<p>Today’s challenge is to:</p>
<ol type="1">
<li>read in a data set, and describe the data set using both words and any supporting information (e.g., tables, etc)</li>
<li>anticipate the shape of pivoted data, and</li>
<li>pivot the data into tidy format using <code>pivot_longer</code></li>
</ol>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Example</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Animal Weights ⭐</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Eggs ⭐⭐/⭐⭐⭐</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Australian Marriage Ballot ⭐⭐⭐</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">USA Households ⭐⭐⭐⭐</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>The first step in pivoting the data is to try to come up with a concrete vision of what the end product <em>should</em> look like - that way you will know whether or not your pivoting was successful.</p>
<p>One easy way to do this is to think about the dimensions of your current data (tibble, dataframe, or matrix), and then calculate what the dimensions of the pivoted data should be.</p>
<p>Suppose you have a dataset with <span class="math inline">\(n\)</span> rows and <span class="math inline">\(k\)</span> variables. In our example, 3 of the variables are used to identify a case, so you will be pivoting <span class="math inline">\(k-3\)</span> variables into a longer format where the <span class="math inline">\(k-3\)</span> variable names will move into the <code>names_to</code> variable and the current values in each of those columns will move into the <code>values_to</code> variable. Therefore, we would expect <span class="math inline">\(n * (k-3)\)</span> rows in the pivoted dataframe!</p>
<p>Suppose you have a dataset with <span class="math inline">\(n\)</span> rows and <span class="math inline">\(k\)</span> variables. In our example, 3 of the variables are used to identify a case, so you will be pivoting <span class="math inline">\(k-3\)</span> variables into a longer format where the <span class="math inline">\(k-3\)</span> variable names will move into the <code>names_to</code> variable and the current values in each of those columns will move into the <code>values_to</code> variable. Therefore, we would expect <span class="math inline">\(n * (k-3)\)</span> rows in the pivoted dataframe!</p>
<section id="find-current-and-future-data-dimensions" class="level3">
<h3 class="anchored" data-anchor-id="find-current-and-future-data-dimensions">Find current and future data dimensions</h3>
<p>Lets see if this works with a simple example.</p>
<div class="cell" data-tbl-cap="Example" data-hash="challenge3_solutions_cache/html/example1_150d7e15ff6f6937b591d9823155de28">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">country =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Mexico"</span>, <span class="st">"USA"</span>, <span class="st">"France"</span>),<span class="dv">2</span>),</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">year =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1990</span>), <span class="dv">3</span>), </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">trade =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"NAFTA"</span>, <span class="st">"NAFTA"</span>, <span class="st">"EU"</span>),<span class="dv">2</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">outgoing =</span> <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean=</span><span class="dv">1000</span>, <span class="at">sd=</span><span class="dv">500</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">incoming =</span> <span class="fu">rlogis</span>(<span class="dv">6</span>, <span class="at">location=</span><span class="dv">1000</span>, </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">scale =</span> <span class="dv">400</span>))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["trade"],"name":[3],"type":["chr"],"align":["left"]},{"label":["outgoing"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["incoming"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Mexico","2":"1980","3":"NAFTA","4":"1558.2810","5":"2842.9955"},{"1":"USA","2":"1990","3":"NAFTA","4":"1205.5919","5":"938.2131"},{"1":"France","2":"1980","3":"EU","4":"1237.2703","5":"1374.2806"},{"1":"Mexico","2":"1990","3":"NAFTA","4":"683.2418","5":"1053.3331"},{"1":"USA","2":"1980","3":"NAFTA","4":"842.4376","5":"1988.7110"},{"1":"France","2":"1990","3":"EU","4":"912.7925","5":"873.1899"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#existing rows/cases</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#existing columns/cases</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#expected rows/cases</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df) <span class="sc">*</span> (<span class="fu">ncol</span>(df)<span class="sc">-</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expected columns </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">+</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<p>Or simple example has <span class="math inline">\(n = 6\)</span> rows and <span class="math inline">\(k - 3 = 2\)</span> variables being pivoted, so we expect a new dataframe to have <span class="math inline">\(n * 2 = 12\)</span> rows x <span class="math inline">\(3 + 2 = 5\)</span> columns.</p>
</section>
<section id="pivot-the-data" class="level3">
<h3 class="anchored" data-anchor-id="pivot-the-data">Pivot the data</h3>
<div class="cell" data-tbl-cap="Pivoted Example" data-hash="challenge3_solutions_cache/html/example2_05ff764a9a7576e26e5b75a995ba0012">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">pivot_longer</span>(df, <span class="at">col =</span> <span class="fu">c</span>(outgoing, incoming),</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to=</span><span class="st">"trade_direction"</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">"trade_value"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["trade"],"name":[3],"type":["chr"],"align":["left"]},{"label":["trade_direction"],"name":[4],"type":["chr"],"align":["left"]},{"label":["trade_value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Mexico","2":"1980","3":"NAFTA","4":"outgoing","5":"1558.2810"},{"1":"Mexico","2":"1980","3":"NAFTA","4":"incoming","5":"2842.9955"},{"1":"USA","2":"1990","3":"NAFTA","4":"outgoing","5":"1205.5919"},{"1":"USA","2":"1990","3":"NAFTA","4":"incoming","5":"938.2131"},{"1":"France","2":"1980","3":"EU","4":"outgoing","5":"1237.2703"},{"1":"France","2":"1980","3":"EU","4":"incoming","5":"1374.2806"},{"1":"Mexico","2":"1990","3":"NAFTA","4":"outgoing","5":"683.2418"},{"1":"Mexico","2":"1990","3":"NAFTA","4":"incoming","5":"1053.3331"},{"1":"USA","2":"1980","3":"NAFTA","4":"outgoing","5":"842.4376"},{"1":"USA","2":"1980","3":"NAFTA","4":"incoming","5":"1988.7110"},{"1":"France","2":"1990","3":"EU","4":"outgoing","5":"912.7925"},{"1":"France","2":"1990","3":"EU","4":"incoming","5":"873.1899"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Yes, once it is pivoted long, our resulting data are <span class="math inline">\(12x5\)</span> - exactly what we expected!</p>
</section>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>The animal weights dataset contains tabular-style data, with cells representing the average live animal weight (in kg) of 16 types of livestock for each of 9 geographic areas as defined by the <a href="https://www.ipcc.ch/">Intergovernmental Panel on Climate Change (IPCC</a>. Livestock weights are a critical part of the <a href="https://www.fao.org/fileadmin/user_upload/gleam/docs/GLEAM_1.0_Model_description.pdf">Global Livestock Envrionmental Assessment Model</a> used by the FAO.</p>
<div class="cell" data-hash="challenge3_solutions_cache/html/animal1_ad0b1f5861d2892a48d2d6dcc0f0dcc6">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>animal_weight<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"_data/animal_weight.csv"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>animal_weight</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["IPCC Area"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Cattle - dairy"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Cattle - non-dairy"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Buffaloes"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Swine - market"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Swine - breeding"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Chicken - Broilers"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Chicken - Layers"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Ducks"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Turkeys"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Sheep"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Goats"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Horses"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Asses"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["Mules"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["Camels"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["Llamas"],"name":[17],"type":["dbl"],"align":["right"]}],"data":[{"1":"Indian Subcontinent","2":"275","3":"110","4":"295","5":"28","6":"28","7":"0.9","8":"1.8","9":"2.7","10":"6.8","11":"28.0","12":"30.0","13":"238","14":"130","15":"130","16":"217","17":"217"},{"1":"Eastern Europe","2":"550","3":"391","4":"380","5":"50","6":"180","7":"0.9","8":"1.8","9":"2.7","10":"6.8","11":"48.5","12":"38.5","13":"377","14":"130","15":"130","16":"217","17":"217"},{"1":"Africa","2":"275","3":"173","4":"380","5":"28","6":"28","7":"0.9","8":"1.8","9":"2.7","10":"6.8","11":"28.0","12":"30.0","13":"238","14":"130","15":"130","16":"217","17":"217"},{"1":"Oceania","2":"500","3":"330","4":"380","5":"45","6":"180","7":"0.9","8":"1.8","9":"2.7","10":"6.8","11":"48.5","12":"38.5","13":"377","14":"130","15":"130","16":"217","17":"217"},{"1":"Western Europe","2":"600","3":"420","4":"380","5":"50","6":"198","7":"0.9","8":"1.8","9":"2.7","10":"6.8","11":"48.5","12":"38.5","13":"377","14":"130","15":"130","16":"217","17":"217"},{"1":"Latin America","2":"400","3":"305","4":"380","5":"28","6":"28","7":"0.9","8":"1.8","9":"2.7","10":"6.8","11":"28.0","12":"30.0","13":"238","14":"130","15":"130","16":"217","17":"217"},{"1":"Asia","2":"350","3":"391","4":"380","5":"50","6":"180","7":"0.9","8":"1.8","9":"2.7","10":"6.8","11":"48.5","12":"38.5","13":"377","14":"130","15":"130","16":"217","17":"217"},{"1":"Middle east","2":"275","3":"173","4":"380","5":"28","6":"28","7":"0.9","8":"1.8","9":"2.7","10":"6.8","11":"28.0","12":"30.0","13":"238","14":"130","15":"130","16":"217","17":"217"},{"1":"Northern America","2":"604","3":"389","4":"380","5":"46","6":"198","7":"0.9","8":"1.8","9":"2.7","10":"6.8","11":"48.5","12":"38.5","13":"377","14":"130","15":"130","16":"217","17":"217"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Because the animal weights data is in tabular format, it is easy to see that <span class="math inline">\(n=9\)</span> regions (categories or cases) in the original data, and that there are <span class="math inline">\(k=16\)</span> types of livestock (categories or columns). Therefore, we expect the pivoted dataset to have <span class="math inline">\(9 * 16\)</span> = 144 rows and 3 columns (region, animal type, and animal weight.)</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
inline R code
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you check out the code above, you will see that I didn’t use a calculator to figure out <span class="math inline">\(9*16=144\)</span>, but used inline r code like this: <code>`r 9*16`</code>.</p>
</div>
</div>
<section id="pivot-the-data-1" class="level3">
<h3 class="anchored" data-anchor-id="pivot-the-data-1">Pivot the data</h3>
<div class="cell" data-hash="challenge3_solutions_cache/html/animal2_c6d192b4effaae9767726644b40b66a5">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>animal_weight_longer<span class="ot">&lt;-</span><span class="fu">pivot_longer</span>(animal_weight, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">col=</span><span class="sc">-</span><span class="st">`</span><span class="at">IPCC Area</span><span class="st">`</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">names_to =</span> <span class="st">"Livestock"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">values_to =</span> <span class="st">"Weight"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>animal_weight_longer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["IPCC Area"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Livestock"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Weight"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Indian Subcontinent","2":"Cattle - dairy","3":"275.0"},{"1":"Indian Subcontinent","2":"Cattle - non-dairy","3":"110.0"},{"1":"Indian Subcontinent","2":"Buffaloes","3":"295.0"},{"1":"Indian Subcontinent","2":"Swine - market","3":"28.0"},{"1":"Indian Subcontinent","2":"Swine - breeding","3":"28.0"},{"1":"Indian Subcontinent","2":"Chicken - Broilers","3":"0.9"},{"1":"Indian Subcontinent","2":"Chicken - Layers","3":"1.8"},{"1":"Indian Subcontinent","2":"Ducks","3":"2.7"},{"1":"Indian Subcontinent","2":"Turkeys","3":"6.8"},{"1":"Indian Subcontinent","2":"Sheep","3":"28.0"},{"1":"Indian Subcontinent","2":"Goats","3":"30.0"},{"1":"Indian Subcontinent","2":"Horses","3":"238.0"},{"1":"Indian Subcontinent","2":"Asses","3":"130.0"},{"1":"Indian Subcontinent","2":"Mules","3":"130.0"},{"1":"Indian Subcontinent","2":"Camels","3":"217.0"},{"1":"Indian Subcontinent","2":"Llamas","3":"217.0"},{"1":"Eastern Europe","2":"Cattle - dairy","3":"550.0"},{"1":"Eastern Europe","2":"Cattle - non-dairy","3":"391.0"},{"1":"Eastern Europe","2":"Buffaloes","3":"380.0"},{"1":"Eastern Europe","2":"Swine - market","3":"50.0"},{"1":"Eastern Europe","2":"Swine - breeding","3":"180.0"},{"1":"Eastern Europe","2":"Chicken - Broilers","3":"0.9"},{"1":"Eastern Europe","2":"Chicken - Layers","3":"1.8"},{"1":"Eastern Europe","2":"Ducks","3":"2.7"},{"1":"Eastern Europe","2":"Turkeys","3":"6.8"},{"1":"Eastern Europe","2":"Sheep","3":"48.5"},{"1":"Eastern Europe","2":"Goats","3":"38.5"},{"1":"Eastern Europe","2":"Horses","3":"377.0"},{"1":"Eastern Europe","2":"Asses","3":"130.0"},{"1":"Eastern Europe","2":"Mules","3":"130.0"},{"1":"Eastern Europe","2":"Camels","3":"217.0"},{"1":"Eastern Europe","2":"Llamas","3":"217.0"},{"1":"Africa","2":"Cattle - dairy","3":"275.0"},{"1":"Africa","2":"Cattle - non-dairy","3":"173.0"},{"1":"Africa","2":"Buffaloes","3":"380.0"},{"1":"Africa","2":"Swine - market","3":"28.0"},{"1":"Africa","2":"Swine - breeding","3":"28.0"},{"1":"Africa","2":"Chicken - Broilers","3":"0.9"},{"1":"Africa","2":"Chicken - Layers","3":"1.8"},{"1":"Africa","2":"Ducks","3":"2.7"},{"1":"Africa","2":"Turkeys","3":"6.8"},{"1":"Africa","2":"Sheep","3":"28.0"},{"1":"Africa","2":"Goats","3":"30.0"},{"1":"Africa","2":"Horses","3":"238.0"},{"1":"Africa","2":"Asses","3":"130.0"},{"1":"Africa","2":"Mules","3":"130.0"},{"1":"Africa","2":"Camels","3":"217.0"},{"1":"Africa","2":"Llamas","3":"217.0"},{"1":"Oceania","2":"Cattle - dairy","3":"500.0"},{"1":"Oceania","2":"Cattle - non-dairy","3":"330.0"},{"1":"Oceania","2":"Buffaloes","3":"380.0"},{"1":"Oceania","2":"Swine - market","3":"45.0"},{"1":"Oceania","2":"Swine - breeding","3":"180.0"},{"1":"Oceania","2":"Chicken - Broilers","3":"0.9"},{"1":"Oceania","2":"Chicken - Layers","3":"1.8"},{"1":"Oceania","2":"Ducks","3":"2.7"},{"1":"Oceania","2":"Turkeys","3":"6.8"},{"1":"Oceania","2":"Sheep","3":"48.5"},{"1":"Oceania","2":"Goats","3":"38.5"},{"1":"Oceania","2":"Horses","3":"377.0"},{"1":"Oceania","2":"Asses","3":"130.0"},{"1":"Oceania","2":"Mules","3":"130.0"},{"1":"Oceania","2":"Camels","3":"217.0"},{"1":"Oceania","2":"Llamas","3":"217.0"},{"1":"Western Europe","2":"Cattle - dairy","3":"600.0"},{"1":"Western Europe","2":"Cattle - non-dairy","3":"420.0"},{"1":"Western Europe","2":"Buffaloes","3":"380.0"},{"1":"Western Europe","2":"Swine - market","3":"50.0"},{"1":"Western Europe","2":"Swine - breeding","3":"198.0"},{"1":"Western Europe","2":"Chicken - Broilers","3":"0.9"},{"1":"Western Europe","2":"Chicken - Layers","3":"1.8"},{"1":"Western Europe","2":"Ducks","3":"2.7"},{"1":"Western Europe","2":"Turkeys","3":"6.8"},{"1":"Western Europe","2":"Sheep","3":"48.5"},{"1":"Western Europe","2":"Goats","3":"38.5"},{"1":"Western Europe","2":"Horses","3":"377.0"},{"1":"Western Europe","2":"Asses","3":"130.0"},{"1":"Western Europe","2":"Mules","3":"130.0"},{"1":"Western Europe","2":"Camels","3":"217.0"},{"1":"Western Europe","2":"Llamas","3":"217.0"},{"1":"Latin America","2":"Cattle - dairy","3":"400.0"},{"1":"Latin America","2":"Cattle - non-dairy","3":"305.0"},{"1":"Latin America","2":"Buffaloes","3":"380.0"},{"1":"Latin America","2":"Swine - market","3":"28.0"},{"1":"Latin America","2":"Swine - breeding","3":"28.0"},{"1":"Latin America","2":"Chicken - Broilers","3":"0.9"},{"1":"Latin America","2":"Chicken - Layers","3":"1.8"},{"1":"Latin America","2":"Ducks","3":"2.7"},{"1":"Latin America","2":"Turkeys","3":"6.8"},{"1":"Latin America","2":"Sheep","3":"28.0"},{"1":"Latin America","2":"Goats","3":"30.0"},{"1":"Latin America","2":"Horses","3":"238.0"},{"1":"Latin America","2":"Asses","3":"130.0"},{"1":"Latin America","2":"Mules","3":"130.0"},{"1":"Latin America","2":"Camels","3":"217.0"},{"1":"Latin America","2":"Llamas","3":"217.0"},{"1":"Asia","2":"Cattle - dairy","3":"350.0"},{"1":"Asia","2":"Cattle - non-dairy","3":"391.0"},{"1":"Asia","2":"Buffaloes","3":"380.0"},{"1":"Asia","2":"Swine - market","3":"50.0"},{"1":"Asia","2":"Swine - breeding","3":"180.0"},{"1":"Asia","2":"Chicken - Broilers","3":"0.9"},{"1":"Asia","2":"Chicken - Layers","3":"1.8"},{"1":"Asia","2":"Ducks","3":"2.7"},{"1":"Asia","2":"Turkeys","3":"6.8"},{"1":"Asia","2":"Sheep","3":"48.5"},{"1":"Asia","2":"Goats","3":"38.5"},{"1":"Asia","2":"Horses","3":"377.0"},{"1":"Asia","2":"Asses","3":"130.0"},{"1":"Asia","2":"Mules","3":"130.0"},{"1":"Asia","2":"Camels","3":"217.0"},{"1":"Asia","2":"Llamas","3":"217.0"},{"1":"Middle east","2":"Cattle - dairy","3":"275.0"},{"1":"Middle east","2":"Cattle - non-dairy","3":"173.0"},{"1":"Middle east","2":"Buffaloes","3":"380.0"},{"1":"Middle east","2":"Swine - market","3":"28.0"},{"1":"Middle east","2":"Swine - breeding","3":"28.0"},{"1":"Middle east","2":"Chicken - Broilers","3":"0.9"},{"1":"Middle east","2":"Chicken - Layers","3":"1.8"},{"1":"Middle east","2":"Ducks","3":"2.7"},{"1":"Middle east","2":"Turkeys","3":"6.8"},{"1":"Middle east","2":"Sheep","3":"28.0"},{"1":"Middle east","2":"Goats","3":"30.0"},{"1":"Middle east","2":"Horses","3":"238.0"},{"1":"Middle east","2":"Asses","3":"130.0"},{"1":"Middle east","2":"Mules","3":"130.0"},{"1":"Middle east","2":"Camels","3":"217.0"},{"1":"Middle east","2":"Llamas","3":"217.0"},{"1":"Northern America","2":"Cattle - dairy","3":"604.0"},{"1":"Northern America","2":"Cattle - non-dairy","3":"389.0"},{"1":"Northern America","2":"Buffaloes","3":"380.0"},{"1":"Northern America","2":"Swine - market","3":"46.0"},{"1":"Northern America","2":"Swine - breeding","3":"198.0"},{"1":"Northern America","2":"Chicken - Broilers","3":"0.9"},{"1":"Northern America","2":"Chicken - Layers","3":"1.8"},{"1":"Northern America","2":"Ducks","3":"2.7"},{"1":"Northern America","2":"Turkeys","3":"6.8"},{"1":"Northern America","2":"Sheep","3":"48.5"},{"1":"Northern America","2":"Goats","3":"38.5"},{"1":"Northern America","2":"Horses","3":"377.0"},{"1":"Northern America","2":"Asses","3":"130.0"},{"1":"Northern America","2":"Mules","3":"130.0"},{"1":"Northern America","2":"Camels","3":"217.0"},{"1":"Northern America","2":"Llamas","3":"217.0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Yes, it looks like we ended up with 144 rows and 3 columns, exactly as expected!</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>#Go further</p>
<p><code>stringr</code> functions, and <code>separate</code> from <code>tidyr</code>, would be useful in helping split out additional infromation from the <em>Livestock</em> column.</p>
</div>
</div>
</section>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>This section covers pivoting for the organic eggs data, available in both excel and (partially cleaned) .csv format. The data reports the average price per carton paid to the farmer or producer for organic eggs (and organic chicken), reported monthly from 2004 to 20013. Average price is reported by carton type, which can vary in both size (x-large or large) and quantity (half-dozen or dozen.)</p>
<p>If you are using the eggs_tidy.csv, you can skip the first section as your data is in .csv format and already partially cleaned. The first section reviews data read-in and cleaning for the <code>organicpoultry.xls</code> file.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Read and Clean the data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Pivot Type Only</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Pivot Size and Quantity</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>There are three sheets in the <em>organicpoultry.xls</em> workbook: one titled <em>Data</em>, one titled “Organic egg prices, 2004-13” and one with a similar title for chicken prices. While I can tell all of this from inspection, I can also use a ask R to return the sheet names for me.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Get sheet names with <code>excel_sheets()</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Both <code>readxl</code> and <code>googlesheets4</code> have a function that can return sheet names as a vector. This is really useful if you need to parse and read multiple sheets in the same workbook.</p>
</div>
</div>
<div class="cell" data-hash="challenge3_solutions_cache/html/eggs1_f88c5f3e7ed35f69f88629c7df27e1bb">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">excel_sheets</span>(<span class="st">"_data/organiceggpoultry.xls"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Data"                            "Organic egg prices, 2004-13"    
[3] "Organic poultry prices, 2004-13"</code></pre>
</div>
</div>
<p>While it may seem like it would be easier to read in the individual egg prices and chicken prices, the amount of formatting introduced into the second and third sheets is pretty intimidating (see the screenshot below.) There are repeated headers to remove, a <em>year</em> column to shift, and other formatting issues. Ironically, it may be easier to read in the egg data from the <em>Data</em> sheet, with a skip of 5 (to skip the table title, etc), custom column names designed for pivoting to two categories (final section) and only reading in columns B to F.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="solution_images/organicpoultrydata.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Organic Poultry Data</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="solution_images/organicpoultry.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Organic Poultry Egg Prices</figcaption><p></p>
</figure>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Hard-coding Table Formats
</div>
</div>
<div class="callout-body-container callout-body">
<p>Formatted excel tables are a horrible data source, but may be the only way to get some data. If table formatting is consistent from year to year, hard-coding can be an acceptable approach. If table format is inconsistent, then more powerful tools are needed.</p>
</div>
</div>
<div class="cell" data-hash="challenge3_solutions_cache/html/eggs2_5e00ed72777cc8fabfafe74a65537a19">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>eggs_orig<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">"_data/organiceggpoultry.xls"</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sheet=</span><span class="st">"Data"</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">range =</span><span class="fu">cell_limits</span>(<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">2</span>),<span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">6</span>)),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"xlarge_dozen"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"xlarge_halfdozen"</span>, <span class="st">"large_dozen"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"large_halfdozen"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>eggs_orig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["date"],"name":[1],"type":["chr"],"align":["left"]},{"label":["xlarge_dozen"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["xlarge_halfdozen"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["large_dozen"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["large_halfdozen"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Jan 2004","2":"230.000","3":"132.000","4":"230.000","5":"126.000"},{"1":"February","2":"230.000","3":"134.500","4":"226.250","5":"128.500"},{"1":"March","2":"230.000","3":"137.000","4":"225.000","5":"131.000"},{"1":"April","2":"234.500","3":"137.000","4":"225.000","5":"131.000"},{"1":"May","2":"236.000","3":"137.000","4":"225.000","5":"131.000"},{"1":"June","2":"241.000","3":"137.000","4":"231.375","5":"133.500"},{"1":"July","2":"241.000","3":"137.000","4":"233.500","5":"133.500"},{"1":"August","2":"241.000","3":"137.000","4":"233.500","5":"133.500"},{"1":"September","2":"241.000","3":"135.875","4":"233.500","5":"129.750"},{"1":"October","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"November","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"December","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"Jan 2005","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"February","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"March","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"April","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"May","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"June","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"July","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"August","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"September","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"October","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"November","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"December","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"Jan 2006","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"February","2":"241.000","3":"135.500","4":"233.500","5":"128.500"},{"1":"March","2":"241.375","3":"135.500","4":"233.500","5":"128.500"},{"1":"April","2":"241.500","3":"135.500","4":"233.500","5":"128.500"},{"1":"May","2":"241.500","3":"135.500","4":"233.500","5":"128.500"},{"1":"June","2":"241.500","3":"135.500","4":"233.500","5":"128.500"},{"1":"July","2":"241.500","3":"135.500","4":"233.500","5":"128.500"},{"1":"August","2":"241.500","3":"135.500","4":"233.500","5":"128.500"},{"1":"September","2":"241.500","3":"135.500","4":"233.500","5":"128.500"},{"1":"October","2":"241.500","3":"135.500","4":"233.500","5":"128.500"},{"1":"November","2":"241.500","3":"135.500","4":"233.500","5":"128.500"},{"1":"December","2":"241.500","3":"135.500","4":"233.500","5":"128.500"},{"1":"Jan 2007","2":"241.500","3":"135.500","4":"233.500","5":"128.500"},{"1":"February","2":"244.125","3":"138.125","4":"236.125","5":"131.125"},{"1":"March","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"April","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"May","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"June","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"July","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"August","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"September","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"October","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"November","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"December","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"Jan 2008","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"February","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"March","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"April","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"May","2":"245.000","3":"139.000","4":"237.000","5":"132.000"},{"1":"June","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"July","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"August","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"September","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"October","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"November","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"December","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"Jan 2009","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"February","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"March","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"April","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"May","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"June","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"July","2":"285.500","3":"185.500","4":"277.500","5":"174.500"},{"1":"August","2":"285.500","3":"185.500","4":"271.500","5":"174.500"},{"1":"September","2":"285.500","3":"185.500","4":"271.500","5":"174.500"},{"1":"October","2":"285.500","3":"185.500","4":"271.500","5":"174.500"},{"1":"November","2":"285.500","3":"185.500","4":"271.500","5":"174.500"},{"1":"December","2":"285.500","3":"185.500","4":"271.500","5":"174.500"},{"1":"Jan 2010","2":"285.500","3":"185.500","4":"271.500","5":"174.500"},{"1":"February","2":"285.500","3":"185.500","4":"271.500","5":"174.500"},{"1":"March","2":"285.500","3":"185.500","4":"268.000","5":"174.500"},{"1":"April","2":"285.500","3":"185.500","4":"268.000","5":"174.500"},{"1":"May","2":"285.500","3":"185.500","4":"268.000","5":"174.500"},{"1":"June","2":"285.500","3":"185.500","4":"268.000","5":"174.500"},{"1":"July","2":"285.500","3":"185.500","4":"268.000","5":"174.500"},{"1":"August","2":"285.500","3":"185.500","4":"268.000","5":"174.500"},{"1":"September","2":"285.500","3":"185.500","4":"268.000","5":"174.500"},{"1":"October","2":"285.500","3":"185.500","4":"267.500","5":"174.500"},{"1":"November","2":"285.500","3":"185.500","4":"267.500","5":"174.500"},{"1":"December","2":"285.500","3":"185.500","4":"267.500","5":"174.500"},{"1":"Jan 2011","2":"285.500","3":"185.500","4":"267.500","5":"174.500"},{"1":"February","2":"285.500","3":"185.500","4":"267.500","5":"174.500"},{"1":"March","2":"285.500","3":"185.500","4":"267.500","5":"174.500"},{"1":"April","2":"285.500","3":"185.500","4":"267.500","5":"174.500"},{"1":"May","2":"285.500","3":"185.500","4":"267.500","5":"174.500"},{"1":"June","2":"285.500","3":"185.500","4":"270.000","5":"174.500"},{"1":"July","2":"285.500","3":"185.500","4":"270.000","5":"174.500"},{"1":"August","2":"285.500","3":"185.500","4":"270.000","5":"174.500"},{"1":"September","2":"285.500","3":"185.500","4":"270.000","5":"174.500"},{"1":"October","2":"285.500","3":"185.500","4":"270.000","5":"174.500"},{"1":"November","2":"285.500","3":"185.500","4":"270.000","5":"174.500"},{"1":"December","2":"285.500","3":"185.500","4":"270.000","5":"174.500"},{"1":"Jan 2012","2":"285.500","3":"185.500","4":"267.500","5":"174.500"},{"1":"February /1","2":"288.500","3":"185.500","4":"267.500","5":"174.500"},{"1":"March","2":"288.500","3":"185.500","4":"267.500","5":"174.500"},{"1":"April","2":"288.500","3":"185.500","4":"267.500","5":"174.500"},{"1":"May","2":"288.500","3":"185.500","4":"267.500","5":"173.250"},{"1":"June","2":"288.500","3":"185.500","4":"267.500","5":"173.250"},{"1":"July","2":"288.500","3":"185.500","4":"267.500","5":"173.250"},{"1":"August","2":"288.500","3":"185.500","4":"267.500","5":"173.250"},{"1":"September","2":"288.500","3":"185.500","4":"267.500","5":"173.250"},{"1":"October","2":"288.500","3":"185.500","4":"267.500","5":"173.250"},{"1":"November","2":"290.000","3":"188.130","4":"267.500","5":"178.000"},{"1":"December","2":"290.000","3":"188.130","4":"267.500","5":"178.000"},{"1":"Jan 2013","2":"290.000","3":"188.130","4":"267.500","5":"178.000"},{"1":"February /1","2":"290.000","3":"188.130","4":"267.500","5":"178.000"},{"1":"March","2":"290.000","3":"188.130","4":"267.500","5":"178.000"},{"1":"April","2":"290.000","3":"188.130","4":"267.500","5":"178.000"},{"1":"May","2":"290.000","3":"188.130","4":"267.500","5":"178.000"},{"1":"June","2":"290.000","3":"188.130","4":"267.500","5":"178.000"},{"1":"July","2":"290.000","3":"188.130","4":"267.500","5":"178.000"},{"1":"August","2":"290.000","3":"188.130","4":"267.500","5":"178.000"},{"1":"September","2":"290.000","3":"188.130","4":"267.500","5":"178.000"},{"1":"October","2":"290.000","3":"188.130","4":"267.500","5":"178.000"},{"1":"November","2":"290.000","3":"188.130","4":"267.500","5":"178.000"},{"1":"December","2":"290.000","3":"188.130","4":"267.500","5":"178.000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Sometimes there are notes in the first column of tables, so lets make sure that isn’t an issue.</p>
<div class="cell" data-hash="challenge3_solutions_cache/html/eggs3_671cbfd9ba4e9f6f96a09aff73760b8a">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>eggs_orig<span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["date"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"April","2":"10"},{"1":"August","2":"10"},{"1":"December","2":"10"},{"1":"February","2":"8"},{"1":"February /1","2":"2"},{"1":"Jan 2004","2":"1"},{"1":"Jan 2005","2":"1"},{"1":"Jan 2006","2":"1"},{"1":"Jan 2007","2":"1"},{"1":"Jan 2008","2":"1"},{"1":"Jan 2009","2":"1"},{"1":"Jan 2010","2":"1"},{"1":"Jan 2011","2":"1"},{"1":"Jan 2012","2":"1"},{"1":"Jan 2013","2":"1"},{"1":"July","2":"10"},{"1":"June","2":"10"},{"1":"March","2":"10"},{"1":"May","2":"10"},{"1":"November","2":"10"},{"1":"October","2":"10"},{"1":"September","2":"10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We need to remove the “note” indicators in two of the rows. Some characters require an <a href="https://cran.r-project.org/web/packages/stringr/vignettes/regular-expressions.html">escape</a> to be included in regular expressions, but this time it is straightforward to find ” /1”.</p>
<div class="cell" data-hash="challenge3_solutions_cache/html/eggs4_d0ef3a529d49cf1d3a2d94bff2428cd4">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>eggs<span class="ot">&lt;-</span>eggs_orig<span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">str_remove</span>(date, <span class="st">" /1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>One final step is needed to split the year variable away from the month. You will often need to separate out two variables from a single column when working with published tables, and also need to use the equivalent of dragging to fill in a normal spreadsheet. Lets look at the easiest way to fix both of these issues.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
tidyr::separate()
</div>
</div>
<div class="callout-body-container callout-body">
<p>Separate is a fantastic function for working with strings. It will break a string column into multiple new (named) columns, at the indicated separator character (e.g., “,” or ” “). The old variable is automatically removed, but can be left.</p>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
tidyr::fill()
</div>
</div>
<div class="callout-body-container callout-body">
<p>Fill works like dragging to fill functionality in a spreadsheet. You can choose the direction to fill.</p>
</div>
</div>
<div class="cell" data-hash="challenge3_solutions_cache/html/eggs5_9049ef6bee3e1336453e1ce6c466314a">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>eggs<span class="ot">&lt;-</span>eggs<span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(date, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"month"</span>, <span class="st">"year"</span>), <span class="at">sep=</span><span class="st">" "</span>)<span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(year)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>eggs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["month"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["chr"],"align":["left"]},{"label":["xlarge_dozen"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["xlarge_halfdozen"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["large_dozen"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["large_halfdozen"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"Jan","2":"2004","3":"230.000","4":"132.000","5":"230.000","6":"126.000"},{"1":"February","2":"2004","3":"230.000","4":"134.500","5":"226.250","6":"128.500"},{"1":"March","2":"2004","3":"230.000","4":"137.000","5":"225.000","6":"131.000"},{"1":"April","2":"2004","3":"234.500","4":"137.000","5":"225.000","6":"131.000"},{"1":"May","2":"2004","3":"236.000","4":"137.000","5":"225.000","6":"131.000"},{"1":"June","2":"2004","3":"241.000","4":"137.000","5":"231.375","6":"133.500"},{"1":"July","2":"2004","3":"241.000","4":"137.000","5":"233.500","6":"133.500"},{"1":"August","2":"2004","3":"241.000","4":"137.000","5":"233.500","6":"133.500"},{"1":"September","2":"2004","3":"241.000","4":"135.875","5":"233.500","6":"129.750"},{"1":"October","2":"2004","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"November","2":"2004","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"December","2":"2004","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"Jan","2":"2005","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"February","2":"2005","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"March","2":"2005","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"April","2":"2005","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"May","2":"2005","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"June","2":"2005","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"July","2":"2005","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"August","2":"2005","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"September","2":"2005","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"October","2":"2005","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"November","2":"2005","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"December","2":"2005","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"Jan","2":"2006","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"February","2":"2006","3":"241.000","4":"135.500","5":"233.500","6":"128.500"},{"1":"March","2":"2006","3":"241.375","4":"135.500","5":"233.500","6":"128.500"},{"1":"April","2":"2006","3":"241.500","4":"135.500","5":"233.500","6":"128.500"},{"1":"May","2":"2006","3":"241.500","4":"135.500","5":"233.500","6":"128.500"},{"1":"June","2":"2006","3":"241.500","4":"135.500","5":"233.500","6":"128.500"},{"1":"July","2":"2006","3":"241.500","4":"135.500","5":"233.500","6":"128.500"},{"1":"August","2":"2006","3":"241.500","4":"135.500","5":"233.500","6":"128.500"},{"1":"September","2":"2006","3":"241.500","4":"135.500","5":"233.500","6":"128.500"},{"1":"October","2":"2006","3":"241.500","4":"135.500","5":"233.500","6":"128.500"},{"1":"November","2":"2006","3":"241.500","4":"135.500","5":"233.500","6":"128.500"},{"1":"December","2":"2006","3":"241.500","4":"135.500","5":"233.500","6":"128.500"},{"1":"Jan","2":"2007","3":"241.500","4":"135.500","5":"233.500","6":"128.500"},{"1":"February","2":"2007","3":"244.125","4":"138.125","5":"236.125","6":"131.125"},{"1":"March","2":"2007","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"April","2":"2007","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"May","2":"2007","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"June","2":"2007","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"July","2":"2007","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"August","2":"2007","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"September","2":"2007","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"October","2":"2007","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"November","2":"2007","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"December","2":"2007","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"Jan","2":"2008","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"February","2":"2008","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"March","2":"2008","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"April","2":"2008","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"May","2":"2008","3":"245.000","4":"139.000","5":"237.000","6":"132.000"},{"1":"June","2":"2008","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"July","2":"2008","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"August","2":"2008","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"September","2":"2008","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"October","2":"2008","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"November","2":"2008","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"December","2":"2008","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"Jan","2":"2009","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"February","2":"2009","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"March","2":"2009","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"April","2":"2009","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"May","2":"2009","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"June","2":"2009","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"July","2":"2009","3":"285.500","4":"185.500","5":"277.500","6":"174.500"},{"1":"August","2":"2009","3":"285.500","4":"185.500","5":"271.500","6":"174.500"},{"1":"September","2":"2009","3":"285.500","4":"185.500","5":"271.500","6":"174.500"},{"1":"October","2":"2009","3":"285.500","4":"185.500","5":"271.500","6":"174.500"},{"1":"November","2":"2009","3":"285.500","4":"185.500","5":"271.500","6":"174.500"},{"1":"December","2":"2009","3":"285.500","4":"185.500","5":"271.500","6":"174.500"},{"1":"Jan","2":"2010","3":"285.500","4":"185.500","5":"271.500","6":"174.500"},{"1":"February","2":"2010","3":"285.500","4":"185.500","5":"271.500","6":"174.500"},{"1":"March","2":"2010","3":"285.500","4":"185.500","5":"268.000","6":"174.500"},{"1":"April","2":"2010","3":"285.500","4":"185.500","5":"268.000","6":"174.500"},{"1":"May","2":"2010","3":"285.500","4":"185.500","5":"268.000","6":"174.500"},{"1":"June","2":"2010","3":"285.500","4":"185.500","5":"268.000","6":"174.500"},{"1":"July","2":"2010","3":"285.500","4":"185.500","5":"268.000","6":"174.500"},{"1":"August","2":"2010","3":"285.500","4":"185.500","5":"268.000","6":"174.500"},{"1":"September","2":"2010","3":"285.500","4":"185.500","5":"268.000","6":"174.500"},{"1":"October","2":"2010","3":"285.500","4":"185.500","5":"267.500","6":"174.500"},{"1":"November","2":"2010","3":"285.500","4":"185.500","5":"267.500","6":"174.500"},{"1":"December","2":"2010","3":"285.500","4":"185.500","5":"267.500","6":"174.500"},{"1":"Jan","2":"2011","3":"285.500","4":"185.500","5":"267.500","6":"174.500"},{"1":"February","2":"2011","3":"285.500","4":"185.500","5":"267.500","6":"174.500"},{"1":"March","2":"2011","3":"285.500","4":"185.500","5":"267.500","6":"174.500"},{"1":"April","2":"2011","3":"285.500","4":"185.500","5":"267.500","6":"174.500"},{"1":"May","2":"2011","3":"285.500","4":"185.500","5":"267.500","6":"174.500"},{"1":"June","2":"2011","3":"285.500","4":"185.500","5":"270.000","6":"174.500"},{"1":"July","2":"2011","3":"285.500","4":"185.500","5":"270.000","6":"174.500"},{"1":"August","2":"2011","3":"285.500","4":"185.500","5":"270.000","6":"174.500"},{"1":"September","2":"2011","3":"285.500","4":"185.500","5":"270.000","6":"174.500"},{"1":"October","2":"2011","3":"285.500","4":"185.500","5":"270.000","6":"174.500"},{"1":"November","2":"2011","3":"285.500","4":"185.500","5":"270.000","6":"174.500"},{"1":"December","2":"2011","3":"285.500","4":"185.500","5":"270.000","6":"174.500"},{"1":"Jan","2":"2012","3":"285.500","4":"185.500","5":"267.500","6":"174.500"},{"1":"February","2":"2012","3":"288.500","4":"185.500","5":"267.500","6":"174.500"},{"1":"March","2":"2012","3":"288.500","4":"185.500","5":"267.500","6":"174.500"},{"1":"April","2":"2012","3":"288.500","4":"185.500","5":"267.500","6":"174.500"},{"1":"May","2":"2012","3":"288.500","4":"185.500","5":"267.500","6":"173.250"},{"1":"June","2":"2012","3":"288.500","4":"185.500","5":"267.500","6":"173.250"},{"1":"July","2":"2012","3":"288.500","4":"185.500","5":"267.500","6":"173.250"},{"1":"August","2":"2012","3":"288.500","4":"185.500","5":"267.500","6":"173.250"},{"1":"September","2":"2012","3":"288.500","4":"185.500","5":"267.500","6":"173.250"},{"1":"October","2":"2012","3":"288.500","4":"185.500","5":"267.500","6":"173.250"},{"1":"November","2":"2012","3":"290.000","4":"188.130","5":"267.500","6":"178.000"},{"1":"December","2":"2012","3":"290.000","4":"188.130","5":"267.500","6":"178.000"},{"1":"Jan","2":"2013","3":"290.000","4":"188.130","5":"267.500","6":"178.000"},{"1":"February","2":"2013","3":"290.000","4":"188.130","5":"267.500","6":"178.000"},{"1":"March","2":"2013","3":"290.000","4":"188.130","5":"267.500","6":"178.000"},{"1":"April","2":"2013","3":"290.000","4":"188.130","5":"267.500","6":"178.000"},{"1":"May","2":"2013","3":"290.000","4":"188.130","5":"267.500","6":"178.000"},{"1":"June","2":"2013","3":"290.000","4":"188.130","5":"267.500","6":"178.000"},{"1":"July","2":"2013","3":"290.000","4":"188.130","5":"267.500","6":"178.000"},{"1":"August","2":"2013","3":"290.000","4":"188.130","5":"267.500","6":"178.000"},{"1":"September","2":"2013","3":"290.000","4":"188.130","5":"267.500","6":"178.000"},{"1":"October","2":"2013","3":"290.000","4":"188.130","5":"267.500","6":"178.000"},{"1":"November","2":"2013","3":"290.000","4":"188.130","5":"267.500","6":"178.000"},{"1":"December","2":"2013","3":"290.000","4":"188.130","5":"267.500","6":"178.000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Looking at the data, we can see that each of the original 120 <em>cases</em> consist of a year-month combination (e.g., January 2004), while the <em>values</em> are the average price (in cents) of four different types of eggs (e.g., large_half_dozen, large_dozen, etc) So to tidy our data, we should create a matrix with a year-month-eggType combination, with a single price <em>value</em> for each case.</p>
<p>To do this (and make our data easier to graph and analyze), we can pivot longer - changing our data from 120 rows with 6 variables (2 grouping and 4 values) to 480 rows of 4 variables (with 3 grouping variables and a single <em>price</em> value).</p>
<div class="cell" data-hash="challenge3_solutions_cache/html/eggs6_b944ad3f39aac4c00ac5b57f151355b9">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>eggs_long<span class="ot">&lt;-</span>eggs<span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">contains</span>(<span class="st">"large"</span>), </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"eggType"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"avgPrice"</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>eggs_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["month"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["chr"],"align":["left"]},{"label":["eggType"],"name":[3],"type":["chr"],"align":["left"]},{"label":["avgPrice"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Jan","2":"2004","3":"xlarge_dozen","4":"230.000"},{"1":"Jan","2":"2004","3":"xlarge_halfdozen","4":"132.000"},{"1":"Jan","2":"2004","3":"large_dozen","4":"230.000"},{"1":"Jan","2":"2004","3":"large_halfdozen","4":"126.000"},{"1":"February","2":"2004","3":"xlarge_dozen","4":"230.000"},{"1":"February","2":"2004","3":"xlarge_halfdozen","4":"134.500"},{"1":"February","2":"2004","3":"large_dozen","4":"226.250"},{"1":"February","2":"2004","3":"large_halfdozen","4":"128.500"},{"1":"March","2":"2004","3":"xlarge_dozen","4":"230.000"},{"1":"March","2":"2004","3":"xlarge_halfdozen","4":"137.000"},{"1":"March","2":"2004","3":"large_dozen","4":"225.000"},{"1":"March","2":"2004","3":"large_halfdozen","4":"131.000"},{"1":"April","2":"2004","3":"xlarge_dozen","4":"234.500"},{"1":"April","2":"2004","3":"xlarge_halfdozen","4":"137.000"},{"1":"April","2":"2004","3":"large_dozen","4":"225.000"},{"1":"April","2":"2004","3":"large_halfdozen","4":"131.000"},{"1":"May","2":"2004","3":"xlarge_dozen","4":"236.000"},{"1":"May","2":"2004","3":"xlarge_halfdozen","4":"137.000"},{"1":"May","2":"2004","3":"large_dozen","4":"225.000"},{"1":"May","2":"2004","3":"large_halfdozen","4":"131.000"},{"1":"June","2":"2004","3":"xlarge_dozen","4":"241.000"},{"1":"June","2":"2004","3":"xlarge_halfdozen","4":"137.000"},{"1":"June","2":"2004","3":"large_dozen","4":"231.375"},{"1":"June","2":"2004","3":"large_halfdozen","4":"133.500"},{"1":"July","2":"2004","3":"xlarge_dozen","4":"241.000"},{"1":"July","2":"2004","3":"xlarge_halfdozen","4":"137.000"},{"1":"July","2":"2004","3":"large_dozen","4":"233.500"},{"1":"July","2":"2004","3":"large_halfdozen","4":"133.500"},{"1":"August","2":"2004","3":"xlarge_dozen","4":"241.000"},{"1":"August","2":"2004","3":"xlarge_halfdozen","4":"137.000"},{"1":"August","2":"2004","3":"large_dozen","4":"233.500"},{"1":"August","2":"2004","3":"large_halfdozen","4":"133.500"},{"1":"September","2":"2004","3":"xlarge_dozen","4":"241.000"},{"1":"September","2":"2004","3":"xlarge_halfdozen","4":"135.875"},{"1":"September","2":"2004","3":"large_dozen","4":"233.500"},{"1":"September","2":"2004","3":"large_halfdozen","4":"129.750"},{"1":"October","2":"2004","3":"xlarge_dozen","4":"241.000"},{"1":"October","2":"2004","3":"xlarge_halfdozen","4":"135.500"},{"1":"October","2":"2004","3":"large_dozen","4":"233.500"},{"1":"October","2":"2004","3":"large_halfdozen","4":"128.500"},{"1":"November","2":"2004","3":"xlarge_dozen","4":"241.000"},{"1":"November","2":"2004","3":"xlarge_halfdozen","4":"135.500"},{"1":"November","2":"2004","3":"large_dozen","4":"233.500"},{"1":"November","2":"2004","3":"large_halfdozen","4":"128.500"},{"1":"December","2":"2004","3":"xlarge_dozen","4":"241.000"},{"1":"December","2":"2004","3":"xlarge_halfdozen","4":"135.500"},{"1":"December","2":"2004","3":"large_dozen","4":"233.500"},{"1":"December","2":"2004","3":"large_halfdozen","4":"128.500"},{"1":"Jan","2":"2005","3":"xlarge_dozen","4":"241.000"},{"1":"Jan","2":"2005","3":"xlarge_halfdozen","4":"135.500"},{"1":"Jan","2":"2005","3":"large_dozen","4":"233.500"},{"1":"Jan","2":"2005","3":"large_halfdozen","4":"128.500"},{"1":"February","2":"2005","3":"xlarge_dozen","4":"241.000"},{"1":"February","2":"2005","3":"xlarge_halfdozen","4":"135.500"},{"1":"February","2":"2005","3":"large_dozen","4":"233.500"},{"1":"February","2":"2005","3":"large_halfdozen","4":"128.500"},{"1":"March","2":"2005","3":"xlarge_dozen","4":"241.000"},{"1":"March","2":"2005","3":"xlarge_halfdozen","4":"135.500"},{"1":"March","2":"2005","3":"large_dozen","4":"233.500"},{"1":"March","2":"2005","3":"large_halfdozen","4":"128.500"},{"1":"April","2":"2005","3":"xlarge_dozen","4":"241.000"},{"1":"April","2":"2005","3":"xlarge_halfdozen","4":"135.500"},{"1":"April","2":"2005","3":"large_dozen","4":"233.500"},{"1":"April","2":"2005","3":"large_halfdozen","4":"128.500"},{"1":"May","2":"2005","3":"xlarge_dozen","4":"241.000"},{"1":"May","2":"2005","3":"xlarge_halfdozen","4":"135.500"},{"1":"May","2":"2005","3":"large_dozen","4":"233.500"},{"1":"May","2":"2005","3":"large_halfdozen","4":"128.500"},{"1":"June","2":"2005","3":"xlarge_dozen","4":"241.000"},{"1":"June","2":"2005","3":"xlarge_halfdozen","4":"135.500"},{"1":"June","2":"2005","3":"large_dozen","4":"233.500"},{"1":"June","2":"2005","3":"large_halfdozen","4":"128.500"},{"1":"July","2":"2005","3":"xlarge_dozen","4":"241.000"},{"1":"July","2":"2005","3":"xlarge_halfdozen","4":"135.500"},{"1":"July","2":"2005","3":"large_dozen","4":"233.500"},{"1":"July","2":"2005","3":"large_halfdozen","4":"128.500"},{"1":"August","2":"2005","3":"xlarge_dozen","4":"241.000"},{"1":"August","2":"2005","3":"xlarge_halfdozen","4":"135.500"},{"1":"August","2":"2005","3":"large_dozen","4":"233.500"},{"1":"August","2":"2005","3":"large_halfdozen","4":"128.500"},{"1":"September","2":"2005","3":"xlarge_dozen","4":"241.000"},{"1":"September","2":"2005","3":"xlarge_halfdozen","4":"135.500"},{"1":"September","2":"2005","3":"large_dozen","4":"233.500"},{"1":"September","2":"2005","3":"large_halfdozen","4":"128.500"},{"1":"October","2":"2005","3":"xlarge_dozen","4":"241.000"},{"1":"October","2":"2005","3":"xlarge_halfdozen","4":"135.500"},{"1":"October","2":"2005","3":"large_dozen","4":"233.500"},{"1":"October","2":"2005","3":"large_halfdozen","4":"128.500"},{"1":"November","2":"2005","3":"xlarge_dozen","4":"241.000"},{"1":"November","2":"2005","3":"xlarge_halfdozen","4":"135.500"},{"1":"November","2":"2005","3":"large_dozen","4":"233.500"},{"1":"November","2":"2005","3":"large_halfdozen","4":"128.500"},{"1":"December","2":"2005","3":"xlarge_dozen","4":"241.000"},{"1":"December","2":"2005","3":"xlarge_halfdozen","4":"135.500"},{"1":"December","2":"2005","3":"large_dozen","4":"233.500"},{"1":"December","2":"2005","3":"large_halfdozen","4":"128.500"},{"1":"Jan","2":"2006","3":"xlarge_dozen","4":"241.000"},{"1":"Jan","2":"2006","3":"xlarge_halfdozen","4":"135.500"},{"1":"Jan","2":"2006","3":"large_dozen","4":"233.500"},{"1":"Jan","2":"2006","3":"large_halfdozen","4":"128.500"},{"1":"February","2":"2006","3":"xlarge_dozen","4":"241.000"},{"1":"February","2":"2006","3":"xlarge_halfdozen","4":"135.500"},{"1":"February","2":"2006","3":"large_dozen","4":"233.500"},{"1":"February","2":"2006","3":"large_halfdozen","4":"128.500"},{"1":"March","2":"2006","3":"xlarge_dozen","4":"241.375"},{"1":"March","2":"2006","3":"xlarge_halfdozen","4":"135.500"},{"1":"March","2":"2006","3":"large_dozen","4":"233.500"},{"1":"March","2":"2006","3":"large_halfdozen","4":"128.500"},{"1":"April","2":"2006","3":"xlarge_dozen","4":"241.500"},{"1":"April","2":"2006","3":"xlarge_halfdozen","4":"135.500"},{"1":"April","2":"2006","3":"large_dozen","4":"233.500"},{"1":"April","2":"2006","3":"large_halfdozen","4":"128.500"},{"1":"May","2":"2006","3":"xlarge_dozen","4":"241.500"},{"1":"May","2":"2006","3":"xlarge_halfdozen","4":"135.500"},{"1":"May","2":"2006","3":"large_dozen","4":"233.500"},{"1":"May","2":"2006","3":"large_halfdozen","4":"128.500"},{"1":"June","2":"2006","3":"xlarge_dozen","4":"241.500"},{"1":"June","2":"2006","3":"xlarge_halfdozen","4":"135.500"},{"1":"June","2":"2006","3":"large_dozen","4":"233.500"},{"1":"June","2":"2006","3":"large_halfdozen","4":"128.500"},{"1":"July","2":"2006","3":"xlarge_dozen","4":"241.500"},{"1":"July","2":"2006","3":"xlarge_halfdozen","4":"135.500"},{"1":"July","2":"2006","3":"large_dozen","4":"233.500"},{"1":"July","2":"2006","3":"large_halfdozen","4":"128.500"},{"1":"August","2":"2006","3":"xlarge_dozen","4":"241.500"},{"1":"August","2":"2006","3":"xlarge_halfdozen","4":"135.500"},{"1":"August","2":"2006","3":"large_dozen","4":"233.500"},{"1":"August","2":"2006","3":"large_halfdozen","4":"128.500"},{"1":"September","2":"2006","3":"xlarge_dozen","4":"241.500"},{"1":"September","2":"2006","3":"xlarge_halfdozen","4":"135.500"},{"1":"September","2":"2006","3":"large_dozen","4":"233.500"},{"1":"September","2":"2006","3":"large_halfdozen","4":"128.500"},{"1":"October","2":"2006","3":"xlarge_dozen","4":"241.500"},{"1":"October","2":"2006","3":"xlarge_halfdozen","4":"135.500"},{"1":"October","2":"2006","3":"large_dozen","4":"233.500"},{"1":"October","2":"2006","3":"large_halfdozen","4":"128.500"},{"1":"November","2":"2006","3":"xlarge_dozen","4":"241.500"},{"1":"November","2":"2006","3":"xlarge_halfdozen","4":"135.500"},{"1":"November","2":"2006","3":"large_dozen","4":"233.500"},{"1":"November","2":"2006","3":"large_halfdozen","4":"128.500"},{"1":"December","2":"2006","3":"xlarge_dozen","4":"241.500"},{"1":"December","2":"2006","3":"xlarge_halfdozen","4":"135.500"},{"1":"December","2":"2006","3":"large_dozen","4":"233.500"},{"1":"December","2":"2006","3":"large_halfdozen","4":"128.500"},{"1":"Jan","2":"2007","3":"xlarge_dozen","4":"241.500"},{"1":"Jan","2":"2007","3":"xlarge_halfdozen","4":"135.500"},{"1":"Jan","2":"2007","3":"large_dozen","4":"233.500"},{"1":"Jan","2":"2007","3":"large_halfdozen","4":"128.500"},{"1":"February","2":"2007","3":"xlarge_dozen","4":"244.125"},{"1":"February","2":"2007","3":"xlarge_halfdozen","4":"138.125"},{"1":"February","2":"2007","3":"large_dozen","4":"236.125"},{"1":"February","2":"2007","3":"large_halfdozen","4":"131.125"},{"1":"March","2":"2007","3":"xlarge_dozen","4":"245.000"},{"1":"March","2":"2007","3":"xlarge_halfdozen","4":"139.000"},{"1":"March","2":"2007","3":"large_dozen","4":"237.000"},{"1":"March","2":"2007","3":"large_halfdozen","4":"132.000"},{"1":"April","2":"2007","3":"xlarge_dozen","4":"245.000"},{"1":"April","2":"2007","3":"xlarge_halfdozen","4":"139.000"},{"1":"April","2":"2007","3":"large_dozen","4":"237.000"},{"1":"April","2":"2007","3":"large_halfdozen","4":"132.000"},{"1":"May","2":"2007","3":"xlarge_dozen","4":"245.000"},{"1":"May","2":"2007","3":"xlarge_halfdozen","4":"139.000"},{"1":"May","2":"2007","3":"large_dozen","4":"237.000"},{"1":"May","2":"2007","3":"large_halfdozen","4":"132.000"},{"1":"June","2":"2007","3":"xlarge_dozen","4":"245.000"},{"1":"June","2":"2007","3":"xlarge_halfdozen","4":"139.000"},{"1":"June","2":"2007","3":"large_dozen","4":"237.000"},{"1":"June","2":"2007","3":"large_halfdozen","4":"132.000"},{"1":"July","2":"2007","3":"xlarge_dozen","4":"245.000"},{"1":"July","2":"2007","3":"xlarge_halfdozen","4":"139.000"},{"1":"July","2":"2007","3":"large_dozen","4":"237.000"},{"1":"July","2":"2007","3":"large_halfdozen","4":"132.000"},{"1":"August","2":"2007","3":"xlarge_dozen","4":"245.000"},{"1":"August","2":"2007","3":"xlarge_halfdozen","4":"139.000"},{"1":"August","2":"2007","3":"large_dozen","4":"237.000"},{"1":"August","2":"2007","3":"large_halfdozen","4":"132.000"},{"1":"September","2":"2007","3":"xlarge_dozen","4":"245.000"},{"1":"September","2":"2007","3":"xlarge_halfdozen","4":"139.000"},{"1":"September","2":"2007","3":"large_dozen","4":"237.000"},{"1":"September","2":"2007","3":"large_halfdozen","4":"132.000"},{"1":"October","2":"2007","3":"xlarge_dozen","4":"245.000"},{"1":"October","2":"2007","3":"xlarge_halfdozen","4":"139.000"},{"1":"October","2":"2007","3":"large_dozen","4":"237.000"},{"1":"October","2":"2007","3":"large_halfdozen","4":"132.000"},{"1":"November","2":"2007","3":"xlarge_dozen","4":"245.000"},{"1":"November","2":"2007","3":"xlarge_halfdozen","4":"139.000"},{"1":"November","2":"2007","3":"large_dozen","4":"237.000"},{"1":"November","2":"2007","3":"large_halfdozen","4":"132.000"},{"1":"December","2":"2007","3":"xlarge_dozen","4":"245.000"},{"1":"December","2":"2007","3":"xlarge_halfdozen","4":"139.000"},{"1":"December","2":"2007","3":"large_dozen","4":"237.000"},{"1":"December","2":"2007","3":"large_halfdozen","4":"132.000"},{"1":"Jan","2":"2008","3":"xlarge_dozen","4":"245.000"},{"1":"Jan","2":"2008","3":"xlarge_halfdozen","4":"139.000"},{"1":"Jan","2":"2008","3":"large_dozen","4":"237.000"},{"1":"Jan","2":"2008","3":"large_halfdozen","4":"132.000"},{"1":"February","2":"2008","3":"xlarge_dozen","4":"245.000"},{"1":"February","2":"2008","3":"xlarge_halfdozen","4":"139.000"},{"1":"February","2":"2008","3":"large_dozen","4":"237.000"},{"1":"February","2":"2008","3":"large_halfdozen","4":"132.000"},{"1":"March","2":"2008","3":"xlarge_dozen","4":"245.000"},{"1":"March","2":"2008","3":"xlarge_halfdozen","4":"139.000"},{"1":"March","2":"2008","3":"large_dozen","4":"237.000"},{"1":"March","2":"2008","3":"large_halfdozen","4":"132.000"},{"1":"April","2":"2008","3":"xlarge_dozen","4":"245.000"},{"1":"April","2":"2008","3":"xlarge_halfdozen","4":"139.000"},{"1":"April","2":"2008","3":"large_dozen","4":"237.000"},{"1":"April","2":"2008","3":"large_halfdozen","4":"132.000"},{"1":"May","2":"2008","3":"xlarge_dozen","4":"245.000"},{"1":"May","2":"2008","3":"xlarge_halfdozen","4":"139.000"},{"1":"May","2":"2008","3":"large_dozen","4":"237.000"},{"1":"May","2":"2008","3":"large_halfdozen","4":"132.000"},{"1":"June","2":"2008","3":"xlarge_dozen","4":"285.500"},{"1":"June","2":"2008","3":"xlarge_halfdozen","4":"185.500"},{"1":"June","2":"2008","3":"large_dozen","4":"277.500"},{"1":"June","2":"2008","3":"large_halfdozen","4":"174.500"},{"1":"July","2":"2008","3":"xlarge_dozen","4":"285.500"},{"1":"July","2":"2008","3":"xlarge_halfdozen","4":"185.500"},{"1":"July","2":"2008","3":"large_dozen","4":"277.500"},{"1":"July","2":"2008","3":"large_halfdozen","4":"174.500"},{"1":"August","2":"2008","3":"xlarge_dozen","4":"285.500"},{"1":"August","2":"2008","3":"xlarge_halfdozen","4":"185.500"},{"1":"August","2":"2008","3":"large_dozen","4":"277.500"},{"1":"August","2":"2008","3":"large_halfdozen","4":"174.500"},{"1":"September","2":"2008","3":"xlarge_dozen","4":"285.500"},{"1":"September","2":"2008","3":"xlarge_halfdozen","4":"185.500"},{"1":"September","2":"2008","3":"large_dozen","4":"277.500"},{"1":"September","2":"2008","3":"large_halfdozen","4":"174.500"},{"1":"October","2":"2008","3":"xlarge_dozen","4":"285.500"},{"1":"October","2":"2008","3":"xlarge_halfdozen","4":"185.500"},{"1":"October","2":"2008","3":"large_dozen","4":"277.500"},{"1":"October","2":"2008","3":"large_halfdozen","4":"174.500"},{"1":"November","2":"2008","3":"xlarge_dozen","4":"285.500"},{"1":"November","2":"2008","3":"xlarge_halfdozen","4":"185.500"},{"1":"November","2":"2008","3":"large_dozen","4":"277.500"},{"1":"November","2":"2008","3":"large_halfdozen","4":"174.500"},{"1":"December","2":"2008","3":"xlarge_dozen","4":"285.500"},{"1":"December","2":"2008","3":"xlarge_halfdozen","4":"185.500"},{"1":"December","2":"2008","3":"large_dozen","4":"277.500"},{"1":"December","2":"2008","3":"large_halfdozen","4":"174.500"},{"1":"Jan","2":"2009","3":"xlarge_dozen","4":"285.500"},{"1":"Jan","2":"2009","3":"xlarge_halfdozen","4":"185.500"},{"1":"Jan","2":"2009","3":"large_dozen","4":"277.500"},{"1":"Jan","2":"2009","3":"large_halfdozen","4":"174.500"},{"1":"February","2":"2009","3":"xlarge_dozen","4":"285.500"},{"1":"February","2":"2009","3":"xlarge_halfdozen","4":"185.500"},{"1":"February","2":"2009","3":"large_dozen","4":"277.500"},{"1":"February","2":"2009","3":"large_halfdozen","4":"174.500"},{"1":"March","2":"2009","3":"xlarge_dozen","4":"285.500"},{"1":"March","2":"2009","3":"xlarge_halfdozen","4":"185.500"},{"1":"March","2":"2009","3":"large_dozen","4":"277.500"},{"1":"March","2":"2009","3":"large_halfdozen","4":"174.500"},{"1":"April","2":"2009","3":"xlarge_dozen","4":"285.500"},{"1":"April","2":"2009","3":"xlarge_halfdozen","4":"185.500"},{"1":"April","2":"2009","3":"large_dozen","4":"277.500"},{"1":"April","2":"2009","3":"large_halfdozen","4":"174.500"},{"1":"May","2":"2009","3":"xlarge_dozen","4":"285.500"},{"1":"May","2":"2009","3":"xlarge_halfdozen","4":"185.500"},{"1":"May","2":"2009","3":"large_dozen","4":"277.500"},{"1":"May","2":"2009","3":"large_halfdozen","4":"174.500"},{"1":"June","2":"2009","3":"xlarge_dozen","4":"285.500"},{"1":"June","2":"2009","3":"xlarge_halfdozen","4":"185.500"},{"1":"June","2":"2009","3":"large_dozen","4":"277.500"},{"1":"June","2":"2009","3":"large_halfdozen","4":"174.500"},{"1":"July","2":"2009","3":"xlarge_dozen","4":"285.500"},{"1":"July","2":"2009","3":"xlarge_halfdozen","4":"185.500"},{"1":"July","2":"2009","3":"large_dozen","4":"277.500"},{"1":"July","2":"2009","3":"large_halfdozen","4":"174.500"},{"1":"August","2":"2009","3":"xlarge_dozen","4":"285.500"},{"1":"August","2":"2009","3":"xlarge_halfdozen","4":"185.500"},{"1":"August","2":"2009","3":"large_dozen","4":"271.500"},{"1":"August","2":"2009","3":"large_halfdozen","4":"174.500"},{"1":"September","2":"2009","3":"xlarge_dozen","4":"285.500"},{"1":"September","2":"2009","3":"xlarge_halfdozen","4":"185.500"},{"1":"September","2":"2009","3":"large_dozen","4":"271.500"},{"1":"September","2":"2009","3":"large_halfdozen","4":"174.500"},{"1":"October","2":"2009","3":"xlarge_dozen","4":"285.500"},{"1":"October","2":"2009","3":"xlarge_halfdozen","4":"185.500"},{"1":"October","2":"2009","3":"large_dozen","4":"271.500"},{"1":"October","2":"2009","3":"large_halfdozen","4":"174.500"},{"1":"November","2":"2009","3":"xlarge_dozen","4":"285.500"},{"1":"November","2":"2009","3":"xlarge_halfdozen","4":"185.500"},{"1":"November","2":"2009","3":"large_dozen","4":"271.500"},{"1":"November","2":"2009","3":"large_halfdozen","4":"174.500"},{"1":"December","2":"2009","3":"xlarge_dozen","4":"285.500"},{"1":"December","2":"2009","3":"xlarge_halfdozen","4":"185.500"},{"1":"December","2":"2009","3":"large_dozen","4":"271.500"},{"1":"December","2":"2009","3":"large_halfdozen","4":"174.500"},{"1":"Jan","2":"2010","3":"xlarge_dozen","4":"285.500"},{"1":"Jan","2":"2010","3":"xlarge_halfdozen","4":"185.500"},{"1":"Jan","2":"2010","3":"large_dozen","4":"271.500"},{"1":"Jan","2":"2010","3":"large_halfdozen","4":"174.500"},{"1":"February","2":"2010","3":"xlarge_dozen","4":"285.500"},{"1":"February","2":"2010","3":"xlarge_halfdozen","4":"185.500"},{"1":"February","2":"2010","3":"large_dozen","4":"271.500"},{"1":"February","2":"2010","3":"large_halfdozen","4":"174.500"},{"1":"March","2":"2010","3":"xlarge_dozen","4":"285.500"},{"1":"March","2":"2010","3":"xlarge_halfdozen","4":"185.500"},{"1":"March","2":"2010","3":"large_dozen","4":"268.000"},{"1":"March","2":"2010","3":"large_halfdozen","4":"174.500"},{"1":"April","2":"2010","3":"xlarge_dozen","4":"285.500"},{"1":"April","2":"2010","3":"xlarge_halfdozen","4":"185.500"},{"1":"April","2":"2010","3":"large_dozen","4":"268.000"},{"1":"April","2":"2010","3":"large_halfdozen","4":"174.500"},{"1":"May","2":"2010","3":"xlarge_dozen","4":"285.500"},{"1":"May","2":"2010","3":"xlarge_halfdozen","4":"185.500"},{"1":"May","2":"2010","3":"large_dozen","4":"268.000"},{"1":"May","2":"2010","3":"large_halfdozen","4":"174.500"},{"1":"June","2":"2010","3":"xlarge_dozen","4":"285.500"},{"1":"June","2":"2010","3":"xlarge_halfdozen","4":"185.500"},{"1":"June","2":"2010","3":"large_dozen","4":"268.000"},{"1":"June","2":"2010","3":"large_halfdozen","4":"174.500"},{"1":"July","2":"2010","3":"xlarge_dozen","4":"285.500"},{"1":"July","2":"2010","3":"xlarge_halfdozen","4":"185.500"},{"1":"July","2":"2010","3":"large_dozen","4":"268.000"},{"1":"July","2":"2010","3":"large_halfdozen","4":"174.500"},{"1":"August","2":"2010","3":"xlarge_dozen","4":"285.500"},{"1":"August","2":"2010","3":"xlarge_halfdozen","4":"185.500"},{"1":"August","2":"2010","3":"large_dozen","4":"268.000"},{"1":"August","2":"2010","3":"large_halfdozen","4":"174.500"},{"1":"September","2":"2010","3":"xlarge_dozen","4":"285.500"},{"1":"September","2":"2010","3":"xlarge_halfdozen","4":"185.500"},{"1":"September","2":"2010","3":"large_dozen","4":"268.000"},{"1":"September","2":"2010","3":"large_halfdozen","4":"174.500"},{"1":"October","2":"2010","3":"xlarge_dozen","4":"285.500"},{"1":"October","2":"2010","3":"xlarge_halfdozen","4":"185.500"},{"1":"October","2":"2010","3":"large_dozen","4":"267.500"},{"1":"October","2":"2010","3":"large_halfdozen","4":"174.500"},{"1":"November","2":"2010","3":"xlarge_dozen","4":"285.500"},{"1":"November","2":"2010","3":"xlarge_halfdozen","4":"185.500"},{"1":"November","2":"2010","3":"large_dozen","4":"267.500"},{"1":"November","2":"2010","3":"large_halfdozen","4":"174.500"},{"1":"December","2":"2010","3":"xlarge_dozen","4":"285.500"},{"1":"December","2":"2010","3":"xlarge_halfdozen","4":"185.500"},{"1":"December","2":"2010","3":"large_dozen","4":"267.500"},{"1":"December","2":"2010","3":"large_halfdozen","4":"174.500"},{"1":"Jan","2":"2011","3":"xlarge_dozen","4":"285.500"},{"1":"Jan","2":"2011","3":"xlarge_halfdozen","4":"185.500"},{"1":"Jan","2":"2011","3":"large_dozen","4":"267.500"},{"1":"Jan","2":"2011","3":"large_halfdozen","4":"174.500"},{"1":"February","2":"2011","3":"xlarge_dozen","4":"285.500"},{"1":"February","2":"2011","3":"xlarge_halfdozen","4":"185.500"},{"1":"February","2":"2011","3":"large_dozen","4":"267.500"},{"1":"February","2":"2011","3":"large_halfdozen","4":"174.500"},{"1":"March","2":"2011","3":"xlarge_dozen","4":"285.500"},{"1":"March","2":"2011","3":"xlarge_halfdozen","4":"185.500"},{"1":"March","2":"2011","3":"large_dozen","4":"267.500"},{"1":"March","2":"2011","3":"large_halfdozen","4":"174.500"},{"1":"April","2":"2011","3":"xlarge_dozen","4":"285.500"},{"1":"April","2":"2011","3":"xlarge_halfdozen","4":"185.500"},{"1":"April","2":"2011","3":"large_dozen","4":"267.500"},{"1":"April","2":"2011","3":"large_halfdozen","4":"174.500"},{"1":"May","2":"2011","3":"xlarge_dozen","4":"285.500"},{"1":"May","2":"2011","3":"xlarge_halfdozen","4":"185.500"},{"1":"May","2":"2011","3":"large_dozen","4":"267.500"},{"1":"May","2":"2011","3":"large_halfdozen","4":"174.500"},{"1":"June","2":"2011","3":"xlarge_dozen","4":"285.500"},{"1":"June","2":"2011","3":"xlarge_halfdozen","4":"185.500"},{"1":"June","2":"2011","3":"large_dozen","4":"270.000"},{"1":"June","2":"2011","3":"large_halfdozen","4":"174.500"},{"1":"July","2":"2011","3":"xlarge_dozen","4":"285.500"},{"1":"July","2":"2011","3":"xlarge_halfdozen","4":"185.500"},{"1":"July","2":"2011","3":"large_dozen","4":"270.000"},{"1":"July","2":"2011","3":"large_halfdozen","4":"174.500"},{"1":"August","2":"2011","3":"xlarge_dozen","4":"285.500"},{"1":"August","2":"2011","3":"xlarge_halfdozen","4":"185.500"},{"1":"August","2":"2011","3":"large_dozen","4":"270.000"},{"1":"August","2":"2011","3":"large_halfdozen","4":"174.500"},{"1":"September","2":"2011","3":"xlarge_dozen","4":"285.500"},{"1":"September","2":"2011","3":"xlarge_halfdozen","4":"185.500"},{"1":"September","2":"2011","3":"large_dozen","4":"270.000"},{"1":"September","2":"2011","3":"large_halfdozen","4":"174.500"},{"1":"October","2":"2011","3":"xlarge_dozen","4":"285.500"},{"1":"October","2":"2011","3":"xlarge_halfdozen","4":"185.500"},{"1":"October","2":"2011","3":"large_dozen","4":"270.000"},{"1":"October","2":"2011","3":"large_halfdozen","4":"174.500"},{"1":"November","2":"2011","3":"xlarge_dozen","4":"285.500"},{"1":"November","2":"2011","3":"xlarge_halfdozen","4":"185.500"},{"1":"November","2":"2011","3":"large_dozen","4":"270.000"},{"1":"November","2":"2011","3":"large_halfdozen","4":"174.500"},{"1":"December","2":"2011","3":"xlarge_dozen","4":"285.500"},{"1":"December","2":"2011","3":"xlarge_halfdozen","4":"185.500"},{"1":"December","2":"2011","3":"large_dozen","4":"270.000"},{"1":"December","2":"2011","3":"large_halfdozen","4":"174.500"},{"1":"Jan","2":"2012","3":"xlarge_dozen","4":"285.500"},{"1":"Jan","2":"2012","3":"xlarge_halfdozen","4":"185.500"},{"1":"Jan","2":"2012","3":"large_dozen","4":"267.500"},{"1":"Jan","2":"2012","3":"large_halfdozen","4":"174.500"},{"1":"February","2":"2012","3":"xlarge_dozen","4":"288.500"},{"1":"February","2":"2012","3":"xlarge_halfdozen","4":"185.500"},{"1":"February","2":"2012","3":"large_dozen","4":"267.500"},{"1":"February","2":"2012","3":"large_halfdozen","4":"174.500"},{"1":"March","2":"2012","3":"xlarge_dozen","4":"288.500"},{"1":"March","2":"2012","3":"xlarge_halfdozen","4":"185.500"},{"1":"March","2":"2012","3":"large_dozen","4":"267.500"},{"1":"March","2":"2012","3":"large_halfdozen","4":"174.500"},{"1":"April","2":"2012","3":"xlarge_dozen","4":"288.500"},{"1":"April","2":"2012","3":"xlarge_halfdozen","4":"185.500"},{"1":"April","2":"2012","3":"large_dozen","4":"267.500"},{"1":"April","2":"2012","3":"large_halfdozen","4":"174.500"},{"1":"May","2":"2012","3":"xlarge_dozen","4":"288.500"},{"1":"May","2":"2012","3":"xlarge_halfdozen","4":"185.500"},{"1":"May","2":"2012","3":"large_dozen","4":"267.500"},{"1":"May","2":"2012","3":"large_halfdozen","4":"173.250"},{"1":"June","2":"2012","3":"xlarge_dozen","4":"288.500"},{"1":"June","2":"2012","3":"xlarge_halfdozen","4":"185.500"},{"1":"June","2":"2012","3":"large_dozen","4":"267.500"},{"1":"June","2":"2012","3":"large_halfdozen","4":"173.250"},{"1":"July","2":"2012","3":"xlarge_dozen","4":"288.500"},{"1":"July","2":"2012","3":"xlarge_halfdozen","4":"185.500"},{"1":"July","2":"2012","3":"large_dozen","4":"267.500"},{"1":"July","2":"2012","3":"large_halfdozen","4":"173.250"},{"1":"August","2":"2012","3":"xlarge_dozen","4":"288.500"},{"1":"August","2":"2012","3":"xlarge_halfdozen","4":"185.500"},{"1":"August","2":"2012","3":"large_dozen","4":"267.500"},{"1":"August","2":"2012","3":"large_halfdozen","4":"173.250"},{"1":"September","2":"2012","3":"xlarge_dozen","4":"288.500"},{"1":"September","2":"2012","3":"xlarge_halfdozen","4":"185.500"},{"1":"September","2":"2012","3":"large_dozen","4":"267.500"},{"1":"September","2":"2012","3":"large_halfdozen","4":"173.250"},{"1":"October","2":"2012","3":"xlarge_dozen","4":"288.500"},{"1":"October","2":"2012","3":"xlarge_halfdozen","4":"185.500"},{"1":"October","2":"2012","3":"large_dozen","4":"267.500"},{"1":"October","2":"2012","3":"large_halfdozen","4":"173.250"},{"1":"November","2":"2012","3":"xlarge_dozen","4":"290.000"},{"1":"November","2":"2012","3":"xlarge_halfdozen","4":"188.130"},{"1":"November","2":"2012","3":"large_dozen","4":"267.500"},{"1":"November","2":"2012","3":"large_halfdozen","4":"178.000"},{"1":"December","2":"2012","3":"xlarge_dozen","4":"290.000"},{"1":"December","2":"2012","3":"xlarge_halfdozen","4":"188.130"},{"1":"December","2":"2012","3":"large_dozen","4":"267.500"},{"1":"December","2":"2012","3":"large_halfdozen","4":"178.000"},{"1":"Jan","2":"2013","3":"xlarge_dozen","4":"290.000"},{"1":"Jan","2":"2013","3":"xlarge_halfdozen","4":"188.130"},{"1":"Jan","2":"2013","3":"large_dozen","4":"267.500"},{"1":"Jan","2":"2013","3":"large_halfdozen","4":"178.000"},{"1":"February","2":"2013","3":"xlarge_dozen","4":"290.000"},{"1":"February","2":"2013","3":"xlarge_halfdozen","4":"188.130"},{"1":"February","2":"2013","3":"large_dozen","4":"267.500"},{"1":"February","2":"2013","3":"large_halfdozen","4":"178.000"},{"1":"March","2":"2013","3":"xlarge_dozen","4":"290.000"},{"1":"March","2":"2013","3":"xlarge_halfdozen","4":"188.130"},{"1":"March","2":"2013","3":"large_dozen","4":"267.500"},{"1":"March","2":"2013","3":"large_halfdozen","4":"178.000"},{"1":"April","2":"2013","3":"xlarge_dozen","4":"290.000"},{"1":"April","2":"2013","3":"xlarge_halfdozen","4":"188.130"},{"1":"April","2":"2013","3":"large_dozen","4":"267.500"},{"1":"April","2":"2013","3":"large_halfdozen","4":"178.000"},{"1":"May","2":"2013","3":"xlarge_dozen","4":"290.000"},{"1":"May","2":"2013","3":"xlarge_halfdozen","4":"188.130"},{"1":"May","2":"2013","3":"large_dozen","4":"267.500"},{"1":"May","2":"2013","3":"large_halfdozen","4":"178.000"},{"1":"June","2":"2013","3":"xlarge_dozen","4":"290.000"},{"1":"June","2":"2013","3":"xlarge_halfdozen","4":"188.130"},{"1":"June","2":"2013","3":"large_dozen","4":"267.500"},{"1":"June","2":"2013","3":"large_halfdozen","4":"178.000"},{"1":"July","2":"2013","3":"xlarge_dozen","4":"290.000"},{"1":"July","2":"2013","3":"xlarge_halfdozen","4":"188.130"},{"1":"July","2":"2013","3":"large_dozen","4":"267.500"},{"1":"July","2":"2013","3":"large_halfdozen","4":"178.000"},{"1":"August","2":"2013","3":"xlarge_dozen","4":"290.000"},{"1":"August","2":"2013","3":"xlarge_halfdozen","4":"188.130"},{"1":"August","2":"2013","3":"large_dozen","4":"267.500"},{"1":"August","2":"2013","3":"large_halfdozen","4":"178.000"},{"1":"September","2":"2013","3":"xlarge_dozen","4":"290.000"},{"1":"September","2":"2013","3":"xlarge_halfdozen","4":"188.130"},{"1":"September","2":"2013","3":"large_dozen","4":"267.500"},{"1":"September","2":"2013","3":"large_halfdozen","4":"178.000"},{"1":"October","2":"2013","3":"xlarge_dozen","4":"290.000"},{"1":"October","2":"2013","3":"xlarge_halfdozen","4":"188.130"},{"1":"October","2":"2013","3":"large_dozen","4":"267.500"},{"1":"October","2":"2013","3":"large_halfdozen","4":"178.000"},{"1":"November","2":"2013","3":"xlarge_dozen","4":"290.000"},{"1":"November","2":"2013","3":"xlarge_halfdozen","4":"188.130"},{"1":"November","2":"2013","3":"large_dozen","4":"267.500"},{"1":"November","2":"2013","3":"large_halfdozen","4":"178.000"},{"1":"December","2":"2013","3":"xlarge_dozen","4":"290.000"},{"1":"December","2":"2013","3":"xlarge_halfdozen","4":"188.130"},{"1":"December","2":"2013","3":"large_dozen","4":"267.500"},{"1":"December","2":"2013","3":"large_halfdozen","4":"178.000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Well, that was super easy. But wait, what if you are interested in egg <em>size</em> - you want to know how much more expensive extra-large eggs are compared to large eggs. Right now, that will be annoying, as you will have to keep sorting out the egg <em>quantity</em> - whether the price is for a half_dozen or a dozen eggs.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Wouldn’t it be nice if we had two new columns - <em>size</em> and <em>quantity</em> - in place of the existing <em>eggType</em> categorical variable? In other words, to have fully tidy data, we would need 4 grouping variables (year, month, size, and quantity) and the same value (price). So, we want to use pivot longer, but we will be adding <strong>two</strong> new category variables (for a total of 4) and this will cut the number of rows in half (to 240).</p>
<p>How can we let R know what we want it to do?? Thankfully, we created pretty systematic column names for egg types in our original data, following the general pattern: <code>size-quantity</code>. Maybe we can use this to our advantage? Working with patterns in the <code>names_sep</code> option of the pivot functions makes it easier than you would think to pivot four existing columns into two new columns.</p>
<div class="cell" data-hash="challenge3_solutions_cache/html/eggs7_b575a31f89b04d33fc6f3df364e679ff">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>eggs_long<span class="ot">&lt;-</span> eggs<span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">contains</span>(<span class="st">"large"</span>),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"size"</span>, <span class="st">"quantity"</span>),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep=</span><span class="st">"_"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"price"</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>eggs_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["month"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["chr"],"align":["left"]},{"label":["size"],"name":[3],"type":["chr"],"align":["left"]},{"label":["quantity"],"name":[4],"type":["chr"],"align":["left"]},{"label":["price"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Jan","2":"2004","3":"xlarge","4":"dozen","5":"230.000"},{"1":"Jan","2":"2004","3":"xlarge","4":"halfdozen","5":"132.000"},{"1":"Jan","2":"2004","3":"large","4":"dozen","5":"230.000"},{"1":"Jan","2":"2004","3":"large","4":"halfdozen","5":"126.000"},{"1":"February","2":"2004","3":"xlarge","4":"dozen","5":"230.000"},{"1":"February","2":"2004","3":"xlarge","4":"halfdozen","5":"134.500"},{"1":"February","2":"2004","3":"large","4":"dozen","5":"226.250"},{"1":"February","2":"2004","3":"large","4":"halfdozen","5":"128.500"},{"1":"March","2":"2004","3":"xlarge","4":"dozen","5":"230.000"},{"1":"March","2":"2004","3":"xlarge","4":"halfdozen","5":"137.000"},{"1":"March","2":"2004","3":"large","4":"dozen","5":"225.000"},{"1":"March","2":"2004","3":"large","4":"halfdozen","5":"131.000"},{"1":"April","2":"2004","3":"xlarge","4":"dozen","5":"234.500"},{"1":"April","2":"2004","3":"xlarge","4":"halfdozen","5":"137.000"},{"1":"April","2":"2004","3":"large","4":"dozen","5":"225.000"},{"1":"April","2":"2004","3":"large","4":"halfdozen","5":"131.000"},{"1":"May","2":"2004","3":"xlarge","4":"dozen","5":"236.000"},{"1":"May","2":"2004","3":"xlarge","4":"halfdozen","5":"137.000"},{"1":"May","2":"2004","3":"large","4":"dozen","5":"225.000"},{"1":"May","2":"2004","3":"large","4":"halfdozen","5":"131.000"},{"1":"June","2":"2004","3":"xlarge","4":"dozen","5":"241.000"},{"1":"June","2":"2004","3":"xlarge","4":"halfdozen","5":"137.000"},{"1":"June","2":"2004","3":"large","4":"dozen","5":"231.375"},{"1":"June","2":"2004","3":"large","4":"halfdozen","5":"133.500"},{"1":"July","2":"2004","3":"xlarge","4":"dozen","5":"241.000"},{"1":"July","2":"2004","3":"xlarge","4":"halfdozen","5":"137.000"},{"1":"July","2":"2004","3":"large","4":"dozen","5":"233.500"},{"1":"July","2":"2004","3":"large","4":"halfdozen","5":"133.500"},{"1":"August","2":"2004","3":"xlarge","4":"dozen","5":"241.000"},{"1":"August","2":"2004","3":"xlarge","4":"halfdozen","5":"137.000"},{"1":"August","2":"2004","3":"large","4":"dozen","5":"233.500"},{"1":"August","2":"2004","3":"large","4":"halfdozen","5":"133.500"},{"1":"September","2":"2004","3":"xlarge","4":"dozen","5":"241.000"},{"1":"September","2":"2004","3":"xlarge","4":"halfdozen","5":"135.875"},{"1":"September","2":"2004","3":"large","4":"dozen","5":"233.500"},{"1":"September","2":"2004","3":"large","4":"halfdozen","5":"129.750"},{"1":"October","2":"2004","3":"xlarge","4":"dozen","5":"241.000"},{"1":"October","2":"2004","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"October","2":"2004","3":"large","4":"dozen","5":"233.500"},{"1":"October","2":"2004","3":"large","4":"halfdozen","5":"128.500"},{"1":"November","2":"2004","3":"xlarge","4":"dozen","5":"241.000"},{"1":"November","2":"2004","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"November","2":"2004","3":"large","4":"dozen","5":"233.500"},{"1":"November","2":"2004","3":"large","4":"halfdozen","5":"128.500"},{"1":"December","2":"2004","3":"xlarge","4":"dozen","5":"241.000"},{"1":"December","2":"2004","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"December","2":"2004","3":"large","4":"dozen","5":"233.500"},{"1":"December","2":"2004","3":"large","4":"halfdozen","5":"128.500"},{"1":"Jan","2":"2005","3":"xlarge","4":"dozen","5":"241.000"},{"1":"Jan","2":"2005","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"Jan","2":"2005","3":"large","4":"dozen","5":"233.500"},{"1":"Jan","2":"2005","3":"large","4":"halfdozen","5":"128.500"},{"1":"February","2":"2005","3":"xlarge","4":"dozen","5":"241.000"},{"1":"February","2":"2005","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"February","2":"2005","3":"large","4":"dozen","5":"233.500"},{"1":"February","2":"2005","3":"large","4":"halfdozen","5":"128.500"},{"1":"March","2":"2005","3":"xlarge","4":"dozen","5":"241.000"},{"1":"March","2":"2005","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"March","2":"2005","3":"large","4":"dozen","5":"233.500"},{"1":"March","2":"2005","3":"large","4":"halfdozen","5":"128.500"},{"1":"April","2":"2005","3":"xlarge","4":"dozen","5":"241.000"},{"1":"April","2":"2005","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"April","2":"2005","3":"large","4":"dozen","5":"233.500"},{"1":"April","2":"2005","3":"large","4":"halfdozen","5":"128.500"},{"1":"May","2":"2005","3":"xlarge","4":"dozen","5":"241.000"},{"1":"May","2":"2005","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"May","2":"2005","3":"large","4":"dozen","5":"233.500"},{"1":"May","2":"2005","3":"large","4":"halfdozen","5":"128.500"},{"1":"June","2":"2005","3":"xlarge","4":"dozen","5":"241.000"},{"1":"June","2":"2005","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"June","2":"2005","3":"large","4":"dozen","5":"233.500"},{"1":"June","2":"2005","3":"large","4":"halfdozen","5":"128.500"},{"1":"July","2":"2005","3":"xlarge","4":"dozen","5":"241.000"},{"1":"July","2":"2005","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"July","2":"2005","3":"large","4":"dozen","5":"233.500"},{"1":"July","2":"2005","3":"large","4":"halfdozen","5":"128.500"},{"1":"August","2":"2005","3":"xlarge","4":"dozen","5":"241.000"},{"1":"August","2":"2005","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"August","2":"2005","3":"large","4":"dozen","5":"233.500"},{"1":"August","2":"2005","3":"large","4":"halfdozen","5":"128.500"},{"1":"September","2":"2005","3":"xlarge","4":"dozen","5":"241.000"},{"1":"September","2":"2005","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"September","2":"2005","3":"large","4":"dozen","5":"233.500"},{"1":"September","2":"2005","3":"large","4":"halfdozen","5":"128.500"},{"1":"October","2":"2005","3":"xlarge","4":"dozen","5":"241.000"},{"1":"October","2":"2005","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"October","2":"2005","3":"large","4":"dozen","5":"233.500"},{"1":"October","2":"2005","3":"large","4":"halfdozen","5":"128.500"},{"1":"November","2":"2005","3":"xlarge","4":"dozen","5":"241.000"},{"1":"November","2":"2005","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"November","2":"2005","3":"large","4":"dozen","5":"233.500"},{"1":"November","2":"2005","3":"large","4":"halfdozen","5":"128.500"},{"1":"December","2":"2005","3":"xlarge","4":"dozen","5":"241.000"},{"1":"December","2":"2005","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"December","2":"2005","3":"large","4":"dozen","5":"233.500"},{"1":"December","2":"2005","3":"large","4":"halfdozen","5":"128.500"},{"1":"Jan","2":"2006","3":"xlarge","4":"dozen","5":"241.000"},{"1":"Jan","2":"2006","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"Jan","2":"2006","3":"large","4":"dozen","5":"233.500"},{"1":"Jan","2":"2006","3":"large","4":"halfdozen","5":"128.500"},{"1":"February","2":"2006","3":"xlarge","4":"dozen","5":"241.000"},{"1":"February","2":"2006","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"February","2":"2006","3":"large","4":"dozen","5":"233.500"},{"1":"February","2":"2006","3":"large","4":"halfdozen","5":"128.500"},{"1":"March","2":"2006","3":"xlarge","4":"dozen","5":"241.375"},{"1":"March","2":"2006","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"March","2":"2006","3":"large","4":"dozen","5":"233.500"},{"1":"March","2":"2006","3":"large","4":"halfdozen","5":"128.500"},{"1":"April","2":"2006","3":"xlarge","4":"dozen","5":"241.500"},{"1":"April","2":"2006","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"April","2":"2006","3":"large","4":"dozen","5":"233.500"},{"1":"April","2":"2006","3":"large","4":"halfdozen","5":"128.500"},{"1":"May","2":"2006","3":"xlarge","4":"dozen","5":"241.500"},{"1":"May","2":"2006","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"May","2":"2006","3":"large","4":"dozen","5":"233.500"},{"1":"May","2":"2006","3":"large","4":"halfdozen","5":"128.500"},{"1":"June","2":"2006","3":"xlarge","4":"dozen","5":"241.500"},{"1":"June","2":"2006","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"June","2":"2006","3":"large","4":"dozen","5":"233.500"},{"1":"June","2":"2006","3":"large","4":"halfdozen","5":"128.500"},{"1":"July","2":"2006","3":"xlarge","4":"dozen","5":"241.500"},{"1":"July","2":"2006","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"July","2":"2006","3":"large","4":"dozen","5":"233.500"},{"1":"July","2":"2006","3":"large","4":"halfdozen","5":"128.500"},{"1":"August","2":"2006","3":"xlarge","4":"dozen","5":"241.500"},{"1":"August","2":"2006","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"August","2":"2006","3":"large","4":"dozen","5":"233.500"},{"1":"August","2":"2006","3":"large","4":"halfdozen","5":"128.500"},{"1":"September","2":"2006","3":"xlarge","4":"dozen","5":"241.500"},{"1":"September","2":"2006","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"September","2":"2006","3":"large","4":"dozen","5":"233.500"},{"1":"September","2":"2006","3":"large","4":"halfdozen","5":"128.500"},{"1":"October","2":"2006","3":"xlarge","4":"dozen","5":"241.500"},{"1":"October","2":"2006","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"October","2":"2006","3":"large","4":"dozen","5":"233.500"},{"1":"October","2":"2006","3":"large","4":"halfdozen","5":"128.500"},{"1":"November","2":"2006","3":"xlarge","4":"dozen","5":"241.500"},{"1":"November","2":"2006","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"November","2":"2006","3":"large","4":"dozen","5":"233.500"},{"1":"November","2":"2006","3":"large","4":"halfdozen","5":"128.500"},{"1":"December","2":"2006","3":"xlarge","4":"dozen","5":"241.500"},{"1":"December","2":"2006","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"December","2":"2006","3":"large","4":"dozen","5":"233.500"},{"1":"December","2":"2006","3":"large","4":"halfdozen","5":"128.500"},{"1":"Jan","2":"2007","3":"xlarge","4":"dozen","5":"241.500"},{"1":"Jan","2":"2007","3":"xlarge","4":"halfdozen","5":"135.500"},{"1":"Jan","2":"2007","3":"large","4":"dozen","5":"233.500"},{"1":"Jan","2":"2007","3":"large","4":"halfdozen","5":"128.500"},{"1":"February","2":"2007","3":"xlarge","4":"dozen","5":"244.125"},{"1":"February","2":"2007","3":"xlarge","4":"halfdozen","5":"138.125"},{"1":"February","2":"2007","3":"large","4":"dozen","5":"236.125"},{"1":"February","2":"2007","3":"large","4":"halfdozen","5":"131.125"},{"1":"March","2":"2007","3":"xlarge","4":"dozen","5":"245.000"},{"1":"March","2":"2007","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"March","2":"2007","3":"large","4":"dozen","5":"237.000"},{"1":"March","2":"2007","3":"large","4":"halfdozen","5":"132.000"},{"1":"April","2":"2007","3":"xlarge","4":"dozen","5":"245.000"},{"1":"April","2":"2007","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"April","2":"2007","3":"large","4":"dozen","5":"237.000"},{"1":"April","2":"2007","3":"large","4":"halfdozen","5":"132.000"},{"1":"May","2":"2007","3":"xlarge","4":"dozen","5":"245.000"},{"1":"May","2":"2007","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"May","2":"2007","3":"large","4":"dozen","5":"237.000"},{"1":"May","2":"2007","3":"large","4":"halfdozen","5":"132.000"},{"1":"June","2":"2007","3":"xlarge","4":"dozen","5":"245.000"},{"1":"June","2":"2007","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"June","2":"2007","3":"large","4":"dozen","5":"237.000"},{"1":"June","2":"2007","3":"large","4":"halfdozen","5":"132.000"},{"1":"July","2":"2007","3":"xlarge","4":"dozen","5":"245.000"},{"1":"July","2":"2007","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"July","2":"2007","3":"large","4":"dozen","5":"237.000"},{"1":"July","2":"2007","3":"large","4":"halfdozen","5":"132.000"},{"1":"August","2":"2007","3":"xlarge","4":"dozen","5":"245.000"},{"1":"August","2":"2007","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"August","2":"2007","3":"large","4":"dozen","5":"237.000"},{"1":"August","2":"2007","3":"large","4":"halfdozen","5":"132.000"},{"1":"September","2":"2007","3":"xlarge","4":"dozen","5":"245.000"},{"1":"September","2":"2007","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"September","2":"2007","3":"large","4":"dozen","5":"237.000"},{"1":"September","2":"2007","3":"large","4":"halfdozen","5":"132.000"},{"1":"October","2":"2007","3":"xlarge","4":"dozen","5":"245.000"},{"1":"October","2":"2007","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"October","2":"2007","3":"large","4":"dozen","5":"237.000"},{"1":"October","2":"2007","3":"large","4":"halfdozen","5":"132.000"},{"1":"November","2":"2007","3":"xlarge","4":"dozen","5":"245.000"},{"1":"November","2":"2007","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"November","2":"2007","3":"large","4":"dozen","5":"237.000"},{"1":"November","2":"2007","3":"large","4":"halfdozen","5":"132.000"},{"1":"December","2":"2007","3":"xlarge","4":"dozen","5":"245.000"},{"1":"December","2":"2007","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"December","2":"2007","3":"large","4":"dozen","5":"237.000"},{"1":"December","2":"2007","3":"large","4":"halfdozen","5":"132.000"},{"1":"Jan","2":"2008","3":"xlarge","4":"dozen","5":"245.000"},{"1":"Jan","2":"2008","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"Jan","2":"2008","3":"large","4":"dozen","5":"237.000"},{"1":"Jan","2":"2008","3":"large","4":"halfdozen","5":"132.000"},{"1":"February","2":"2008","3":"xlarge","4":"dozen","5":"245.000"},{"1":"February","2":"2008","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"February","2":"2008","3":"large","4":"dozen","5":"237.000"},{"1":"February","2":"2008","3":"large","4":"halfdozen","5":"132.000"},{"1":"March","2":"2008","3":"xlarge","4":"dozen","5":"245.000"},{"1":"March","2":"2008","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"March","2":"2008","3":"large","4":"dozen","5":"237.000"},{"1":"March","2":"2008","3":"large","4":"halfdozen","5":"132.000"},{"1":"April","2":"2008","3":"xlarge","4":"dozen","5":"245.000"},{"1":"April","2":"2008","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"April","2":"2008","3":"large","4":"dozen","5":"237.000"},{"1":"April","2":"2008","3":"large","4":"halfdozen","5":"132.000"},{"1":"May","2":"2008","3":"xlarge","4":"dozen","5":"245.000"},{"1":"May","2":"2008","3":"xlarge","4":"halfdozen","5":"139.000"},{"1":"May","2":"2008","3":"large","4":"dozen","5":"237.000"},{"1":"May","2":"2008","3":"large","4":"halfdozen","5":"132.000"},{"1":"June","2":"2008","3":"xlarge","4":"dozen","5":"285.500"},{"1":"June","2":"2008","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"June","2":"2008","3":"large","4":"dozen","5":"277.500"},{"1":"June","2":"2008","3":"large","4":"halfdozen","5":"174.500"},{"1":"July","2":"2008","3":"xlarge","4":"dozen","5":"285.500"},{"1":"July","2":"2008","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"July","2":"2008","3":"large","4":"dozen","5":"277.500"},{"1":"July","2":"2008","3":"large","4":"halfdozen","5":"174.500"},{"1":"August","2":"2008","3":"xlarge","4":"dozen","5":"285.500"},{"1":"August","2":"2008","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"August","2":"2008","3":"large","4":"dozen","5":"277.500"},{"1":"August","2":"2008","3":"large","4":"halfdozen","5":"174.500"},{"1":"September","2":"2008","3":"xlarge","4":"dozen","5":"285.500"},{"1":"September","2":"2008","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"September","2":"2008","3":"large","4":"dozen","5":"277.500"},{"1":"September","2":"2008","3":"large","4":"halfdozen","5":"174.500"},{"1":"October","2":"2008","3":"xlarge","4":"dozen","5":"285.500"},{"1":"October","2":"2008","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"October","2":"2008","3":"large","4":"dozen","5":"277.500"},{"1":"October","2":"2008","3":"large","4":"halfdozen","5":"174.500"},{"1":"November","2":"2008","3":"xlarge","4":"dozen","5":"285.500"},{"1":"November","2":"2008","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"November","2":"2008","3":"large","4":"dozen","5":"277.500"},{"1":"November","2":"2008","3":"large","4":"halfdozen","5":"174.500"},{"1":"December","2":"2008","3":"xlarge","4":"dozen","5":"285.500"},{"1":"December","2":"2008","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"December","2":"2008","3":"large","4":"dozen","5":"277.500"},{"1":"December","2":"2008","3":"large","4":"halfdozen","5":"174.500"},{"1":"Jan","2":"2009","3":"xlarge","4":"dozen","5":"285.500"},{"1":"Jan","2":"2009","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"Jan","2":"2009","3":"large","4":"dozen","5":"277.500"},{"1":"Jan","2":"2009","3":"large","4":"halfdozen","5":"174.500"},{"1":"February","2":"2009","3":"xlarge","4":"dozen","5":"285.500"},{"1":"February","2":"2009","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"February","2":"2009","3":"large","4":"dozen","5":"277.500"},{"1":"February","2":"2009","3":"large","4":"halfdozen","5":"174.500"},{"1":"March","2":"2009","3":"xlarge","4":"dozen","5":"285.500"},{"1":"March","2":"2009","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"March","2":"2009","3":"large","4":"dozen","5":"277.500"},{"1":"March","2":"2009","3":"large","4":"halfdozen","5":"174.500"},{"1":"April","2":"2009","3":"xlarge","4":"dozen","5":"285.500"},{"1":"April","2":"2009","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"April","2":"2009","3":"large","4":"dozen","5":"277.500"},{"1":"April","2":"2009","3":"large","4":"halfdozen","5":"174.500"},{"1":"May","2":"2009","3":"xlarge","4":"dozen","5":"285.500"},{"1":"May","2":"2009","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"May","2":"2009","3":"large","4":"dozen","5":"277.500"},{"1":"May","2":"2009","3":"large","4":"halfdozen","5":"174.500"},{"1":"June","2":"2009","3":"xlarge","4":"dozen","5":"285.500"},{"1":"June","2":"2009","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"June","2":"2009","3":"large","4":"dozen","5":"277.500"},{"1":"June","2":"2009","3":"large","4":"halfdozen","5":"174.500"},{"1":"July","2":"2009","3":"xlarge","4":"dozen","5":"285.500"},{"1":"July","2":"2009","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"July","2":"2009","3":"large","4":"dozen","5":"277.500"},{"1":"July","2":"2009","3":"large","4":"halfdozen","5":"174.500"},{"1":"August","2":"2009","3":"xlarge","4":"dozen","5":"285.500"},{"1":"August","2":"2009","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"August","2":"2009","3":"large","4":"dozen","5":"271.500"},{"1":"August","2":"2009","3":"large","4":"halfdozen","5":"174.500"},{"1":"September","2":"2009","3":"xlarge","4":"dozen","5":"285.500"},{"1":"September","2":"2009","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"September","2":"2009","3":"large","4":"dozen","5":"271.500"},{"1":"September","2":"2009","3":"large","4":"halfdozen","5":"174.500"},{"1":"October","2":"2009","3":"xlarge","4":"dozen","5":"285.500"},{"1":"October","2":"2009","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"October","2":"2009","3":"large","4":"dozen","5":"271.500"},{"1":"October","2":"2009","3":"large","4":"halfdozen","5":"174.500"},{"1":"November","2":"2009","3":"xlarge","4":"dozen","5":"285.500"},{"1":"November","2":"2009","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"November","2":"2009","3":"large","4":"dozen","5":"271.500"},{"1":"November","2":"2009","3":"large","4":"halfdozen","5":"174.500"},{"1":"December","2":"2009","3":"xlarge","4":"dozen","5":"285.500"},{"1":"December","2":"2009","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"December","2":"2009","3":"large","4":"dozen","5":"271.500"},{"1":"December","2":"2009","3":"large","4":"halfdozen","5":"174.500"},{"1":"Jan","2":"2010","3":"xlarge","4":"dozen","5":"285.500"},{"1":"Jan","2":"2010","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"Jan","2":"2010","3":"large","4":"dozen","5":"271.500"},{"1":"Jan","2":"2010","3":"large","4":"halfdozen","5":"174.500"},{"1":"February","2":"2010","3":"xlarge","4":"dozen","5":"285.500"},{"1":"February","2":"2010","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"February","2":"2010","3":"large","4":"dozen","5":"271.500"},{"1":"February","2":"2010","3":"large","4":"halfdozen","5":"174.500"},{"1":"March","2":"2010","3":"xlarge","4":"dozen","5":"285.500"},{"1":"March","2":"2010","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"March","2":"2010","3":"large","4":"dozen","5":"268.000"},{"1":"March","2":"2010","3":"large","4":"halfdozen","5":"174.500"},{"1":"April","2":"2010","3":"xlarge","4":"dozen","5":"285.500"},{"1":"April","2":"2010","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"April","2":"2010","3":"large","4":"dozen","5":"268.000"},{"1":"April","2":"2010","3":"large","4":"halfdozen","5":"174.500"},{"1":"May","2":"2010","3":"xlarge","4":"dozen","5":"285.500"},{"1":"May","2":"2010","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"May","2":"2010","3":"large","4":"dozen","5":"268.000"},{"1":"May","2":"2010","3":"large","4":"halfdozen","5":"174.500"},{"1":"June","2":"2010","3":"xlarge","4":"dozen","5":"285.500"},{"1":"June","2":"2010","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"June","2":"2010","3":"large","4":"dozen","5":"268.000"},{"1":"June","2":"2010","3":"large","4":"halfdozen","5":"174.500"},{"1":"July","2":"2010","3":"xlarge","4":"dozen","5":"285.500"},{"1":"July","2":"2010","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"July","2":"2010","3":"large","4":"dozen","5":"268.000"},{"1":"July","2":"2010","3":"large","4":"halfdozen","5":"174.500"},{"1":"August","2":"2010","3":"xlarge","4":"dozen","5":"285.500"},{"1":"August","2":"2010","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"August","2":"2010","3":"large","4":"dozen","5":"268.000"},{"1":"August","2":"2010","3":"large","4":"halfdozen","5":"174.500"},{"1":"September","2":"2010","3":"xlarge","4":"dozen","5":"285.500"},{"1":"September","2":"2010","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"September","2":"2010","3":"large","4":"dozen","5":"268.000"},{"1":"September","2":"2010","3":"large","4":"halfdozen","5":"174.500"},{"1":"October","2":"2010","3":"xlarge","4":"dozen","5":"285.500"},{"1":"October","2":"2010","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"October","2":"2010","3":"large","4":"dozen","5":"267.500"},{"1":"October","2":"2010","3":"large","4":"halfdozen","5":"174.500"},{"1":"November","2":"2010","3":"xlarge","4":"dozen","5":"285.500"},{"1":"November","2":"2010","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"November","2":"2010","3":"large","4":"dozen","5":"267.500"},{"1":"November","2":"2010","3":"large","4":"halfdozen","5":"174.500"},{"1":"December","2":"2010","3":"xlarge","4":"dozen","5":"285.500"},{"1":"December","2":"2010","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"December","2":"2010","3":"large","4":"dozen","5":"267.500"},{"1":"December","2":"2010","3":"large","4":"halfdozen","5":"174.500"},{"1":"Jan","2":"2011","3":"xlarge","4":"dozen","5":"285.500"},{"1":"Jan","2":"2011","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"Jan","2":"2011","3":"large","4":"dozen","5":"267.500"},{"1":"Jan","2":"2011","3":"large","4":"halfdozen","5":"174.500"},{"1":"February","2":"2011","3":"xlarge","4":"dozen","5":"285.500"},{"1":"February","2":"2011","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"February","2":"2011","3":"large","4":"dozen","5":"267.500"},{"1":"February","2":"2011","3":"large","4":"halfdozen","5":"174.500"},{"1":"March","2":"2011","3":"xlarge","4":"dozen","5":"285.500"},{"1":"March","2":"2011","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"March","2":"2011","3":"large","4":"dozen","5":"267.500"},{"1":"March","2":"2011","3":"large","4":"halfdozen","5":"174.500"},{"1":"April","2":"2011","3":"xlarge","4":"dozen","5":"285.500"},{"1":"April","2":"2011","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"April","2":"2011","3":"large","4":"dozen","5":"267.500"},{"1":"April","2":"2011","3":"large","4":"halfdozen","5":"174.500"},{"1":"May","2":"2011","3":"xlarge","4":"dozen","5":"285.500"},{"1":"May","2":"2011","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"May","2":"2011","3":"large","4":"dozen","5":"267.500"},{"1":"May","2":"2011","3":"large","4":"halfdozen","5":"174.500"},{"1":"June","2":"2011","3":"xlarge","4":"dozen","5":"285.500"},{"1":"June","2":"2011","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"June","2":"2011","3":"large","4":"dozen","5":"270.000"},{"1":"June","2":"2011","3":"large","4":"halfdozen","5":"174.500"},{"1":"July","2":"2011","3":"xlarge","4":"dozen","5":"285.500"},{"1":"July","2":"2011","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"July","2":"2011","3":"large","4":"dozen","5":"270.000"},{"1":"July","2":"2011","3":"large","4":"halfdozen","5":"174.500"},{"1":"August","2":"2011","3":"xlarge","4":"dozen","5":"285.500"},{"1":"August","2":"2011","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"August","2":"2011","3":"large","4":"dozen","5":"270.000"},{"1":"August","2":"2011","3":"large","4":"halfdozen","5":"174.500"},{"1":"September","2":"2011","3":"xlarge","4":"dozen","5":"285.500"},{"1":"September","2":"2011","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"September","2":"2011","3":"large","4":"dozen","5":"270.000"},{"1":"September","2":"2011","3":"large","4":"halfdozen","5":"174.500"},{"1":"October","2":"2011","3":"xlarge","4":"dozen","5":"285.500"},{"1":"October","2":"2011","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"October","2":"2011","3":"large","4":"dozen","5":"270.000"},{"1":"October","2":"2011","3":"large","4":"halfdozen","5":"174.500"},{"1":"November","2":"2011","3":"xlarge","4":"dozen","5":"285.500"},{"1":"November","2":"2011","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"November","2":"2011","3":"large","4":"dozen","5":"270.000"},{"1":"November","2":"2011","3":"large","4":"halfdozen","5":"174.500"},{"1":"December","2":"2011","3":"xlarge","4":"dozen","5":"285.500"},{"1":"December","2":"2011","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"December","2":"2011","3":"large","4":"dozen","5":"270.000"},{"1":"December","2":"2011","3":"large","4":"halfdozen","5":"174.500"},{"1":"Jan","2":"2012","3":"xlarge","4":"dozen","5":"285.500"},{"1":"Jan","2":"2012","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"Jan","2":"2012","3":"large","4":"dozen","5":"267.500"},{"1":"Jan","2":"2012","3":"large","4":"halfdozen","5":"174.500"},{"1":"February","2":"2012","3":"xlarge","4":"dozen","5":"288.500"},{"1":"February","2":"2012","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"February","2":"2012","3":"large","4":"dozen","5":"267.500"},{"1":"February","2":"2012","3":"large","4":"halfdozen","5":"174.500"},{"1":"March","2":"2012","3":"xlarge","4":"dozen","5":"288.500"},{"1":"March","2":"2012","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"March","2":"2012","3":"large","4":"dozen","5":"267.500"},{"1":"March","2":"2012","3":"large","4":"halfdozen","5":"174.500"},{"1":"April","2":"2012","3":"xlarge","4":"dozen","5":"288.500"},{"1":"April","2":"2012","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"April","2":"2012","3":"large","4":"dozen","5":"267.500"},{"1":"April","2":"2012","3":"large","4":"halfdozen","5":"174.500"},{"1":"May","2":"2012","3":"xlarge","4":"dozen","5":"288.500"},{"1":"May","2":"2012","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"May","2":"2012","3":"large","4":"dozen","5":"267.500"},{"1":"May","2":"2012","3":"large","4":"halfdozen","5":"173.250"},{"1":"June","2":"2012","3":"xlarge","4":"dozen","5":"288.500"},{"1":"June","2":"2012","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"June","2":"2012","3":"large","4":"dozen","5":"267.500"},{"1":"June","2":"2012","3":"large","4":"halfdozen","5":"173.250"},{"1":"July","2":"2012","3":"xlarge","4":"dozen","5":"288.500"},{"1":"July","2":"2012","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"July","2":"2012","3":"large","4":"dozen","5":"267.500"},{"1":"July","2":"2012","3":"large","4":"halfdozen","5":"173.250"},{"1":"August","2":"2012","3":"xlarge","4":"dozen","5":"288.500"},{"1":"August","2":"2012","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"August","2":"2012","3":"large","4":"dozen","5":"267.500"},{"1":"August","2":"2012","3":"large","4":"halfdozen","5":"173.250"},{"1":"September","2":"2012","3":"xlarge","4":"dozen","5":"288.500"},{"1":"September","2":"2012","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"September","2":"2012","3":"large","4":"dozen","5":"267.500"},{"1":"September","2":"2012","3":"large","4":"halfdozen","5":"173.250"},{"1":"October","2":"2012","3":"xlarge","4":"dozen","5":"288.500"},{"1":"October","2":"2012","3":"xlarge","4":"halfdozen","5":"185.500"},{"1":"October","2":"2012","3":"large","4":"dozen","5":"267.500"},{"1":"October","2":"2012","3":"large","4":"halfdozen","5":"173.250"},{"1":"November","2":"2012","3":"xlarge","4":"dozen","5":"290.000"},{"1":"November","2":"2012","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"November","2":"2012","3":"large","4":"dozen","5":"267.500"},{"1":"November","2":"2012","3":"large","4":"halfdozen","5":"178.000"},{"1":"December","2":"2012","3":"xlarge","4":"dozen","5":"290.000"},{"1":"December","2":"2012","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"December","2":"2012","3":"large","4":"dozen","5":"267.500"},{"1":"December","2":"2012","3":"large","4":"halfdozen","5":"178.000"},{"1":"Jan","2":"2013","3":"xlarge","4":"dozen","5":"290.000"},{"1":"Jan","2":"2013","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"Jan","2":"2013","3":"large","4":"dozen","5":"267.500"},{"1":"Jan","2":"2013","3":"large","4":"halfdozen","5":"178.000"},{"1":"February","2":"2013","3":"xlarge","4":"dozen","5":"290.000"},{"1":"February","2":"2013","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"February","2":"2013","3":"large","4":"dozen","5":"267.500"},{"1":"February","2":"2013","3":"large","4":"halfdozen","5":"178.000"},{"1":"March","2":"2013","3":"xlarge","4":"dozen","5":"290.000"},{"1":"March","2":"2013","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"March","2":"2013","3":"large","4":"dozen","5":"267.500"},{"1":"March","2":"2013","3":"large","4":"halfdozen","5":"178.000"},{"1":"April","2":"2013","3":"xlarge","4":"dozen","5":"290.000"},{"1":"April","2":"2013","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"April","2":"2013","3":"large","4":"dozen","5":"267.500"},{"1":"April","2":"2013","3":"large","4":"halfdozen","5":"178.000"},{"1":"May","2":"2013","3":"xlarge","4":"dozen","5":"290.000"},{"1":"May","2":"2013","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"May","2":"2013","3":"large","4":"dozen","5":"267.500"},{"1":"May","2":"2013","3":"large","4":"halfdozen","5":"178.000"},{"1":"June","2":"2013","3":"xlarge","4":"dozen","5":"290.000"},{"1":"June","2":"2013","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"June","2":"2013","3":"large","4":"dozen","5":"267.500"},{"1":"June","2":"2013","3":"large","4":"halfdozen","5":"178.000"},{"1":"July","2":"2013","3":"xlarge","4":"dozen","5":"290.000"},{"1":"July","2":"2013","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"July","2":"2013","3":"large","4":"dozen","5":"267.500"},{"1":"July","2":"2013","3":"large","4":"halfdozen","5":"178.000"},{"1":"August","2":"2013","3":"xlarge","4":"dozen","5":"290.000"},{"1":"August","2":"2013","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"August","2":"2013","3":"large","4":"dozen","5":"267.500"},{"1":"August","2":"2013","3":"large","4":"halfdozen","5":"178.000"},{"1":"September","2":"2013","3":"xlarge","4":"dozen","5":"290.000"},{"1":"September","2":"2013","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"September","2":"2013","3":"large","4":"dozen","5":"267.500"},{"1":"September","2":"2013","3":"large","4":"halfdozen","5":"178.000"},{"1":"October","2":"2013","3":"xlarge","4":"dozen","5":"290.000"},{"1":"October","2":"2013","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"October","2":"2013","3":"large","4":"dozen","5":"267.500"},{"1":"October","2":"2013","3":"large","4":"halfdozen","5":"178.000"},{"1":"November","2":"2013","3":"xlarge","4":"dozen","5":"290.000"},{"1":"November","2":"2013","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"November","2":"2013","3":"large","4":"dozen","5":"267.500"},{"1":"November","2":"2013","3":"large","4":"halfdozen","5":"178.000"},{"1":"December","2":"2013","3":"xlarge","4":"dozen","5":"290.000"},{"1":"December","2":"2013","3":"xlarge","4":"halfdozen","5":"188.130"},{"1":"December","2":"2013","3":"large","4":"dozen","5":"267.500"},{"1":"December","2":"2013","3":"large","4":"halfdozen","5":"178.000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<p>This is another tabular data source published by the <a href="https://www.abs.gov.au/">Australian Bureau of Statistics</a> that requires a decent amount of cleaning. In 2017, Australia conducted a postal survey to gauge citizens’ opinions towards same sex marriage: “Should the law be changed to allow same-sex couples to marry?” All Australian citizens are required to vote in elections, so citizens could respond in one of four ways: vote yes, vote no, vote in an unclear way, or fail to vote. (See the “Explanatory Notes” sheet for more details.)</p>
<p>The provided table includes estimates of the proportion of citizens choosing each of the four options, aggregated by Federal Electoral District, which are nested within one of 8 overarching Electoral Divisions. Here is a quick image showing the original table format.</p>
<p><img src="solution_images/australiandata.png" class="img-fluid" alt="Australian Marriage Data"> ### Identify desired data structure</p>
<p>Inspection reveals several critical issues to address: - Typical long header (skip = 7) - No single row with variable names - Two redundant values (count and percentage - percentage is easy to recover from complete count data) - Total columns that are redundant (remove) - The sum of “Yes” and “No” votes appears to be redundant with Response Clear in columns I and J - District and Division are in the same column</p>
<p>In this example, we are going to identify the desired structure early in the process, because clever naming of variables makes it much easier to use pivot functions. We will skip reading in redundant data (proportions and “totals” columns), and then can identify four potentially distinct pieces of information. Three grouping variables: <em>Division</em> (in column 1), <em>District</em> (also in column 1), and citizen <em>Response</em> (yes, no, unclear, and non-response), plus one value: aggregated response <em>Count</em>.</p>
<p>Our basic data reading and cleaning process should therefore follow these steps:</p>
<ol type="1">
<li>Read in data, skipping unneeded columns and renaming variables</li>
<li>Create <em>Division</em> and <em>District</em> variables using <code>separate()</code> and <code>fill()</code></li>
<li>pivot_longer() four response variables into 2 new <em>Response</em> and <em>Count</em> variables (double the number of rows)</li>
</ol>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Read Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Separate <em>District</em> and <em>Division</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Pivot_longer to tidy format</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>It is best to confine serious hard-coding to the initial data read in step, to make it easy to locate and make changes or replicate in the future. So, we will use a combination of tools introduced earlier to read and reformat the data: <code>skip</code> and col_names to read in the data, <code>select</code> to get rid of unneeded columns, and <code>filter</code> to get rid of unneeded rows. We also use the <code>drop_na</code> function to filter unwanted rows.</p>
<div class="cell" data-hash="challenge3_solutions_cache/html/australia1_cc01b3ecbcad1dcaba595b656adcfa6d">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>vote_orig <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"_data/australian_marriage_law_postal_survey_2017_-_response_final.xls"</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">sheet=</span><span class="st">"Table 2"</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip=</span><span class="dv">7</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"District"</span>, <span class="st">"Yes"</span>, <span class="st">"del"</span>, <span class="st">"No"</span>, <span class="fu">rep</span>(<span class="st">"del"</span>, <span class="dv">6</span>), <span class="st">"Illegible"</span>, <span class="st">"del"</span>, <span class="st">"No Response"</span>, <span class="fu">rep</span>(<span class="st">"del"</span>, <span class="dv">3</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"del"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(District)<span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(District, <span class="st">"(Total)"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_starts</span>(District, <span class="st">"</span><span class="sc">\\</span><span class="st">("</span>))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>vote_orig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["District"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Yes"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["No"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Illegible"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["No Response"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"New South Wales Divisions","2":"NA","3":"NA","4":"NA","5":"NA"},{"1":"Banks","2":"37736","3":"46343","4":"247","5":"20928"},{"1":"Barton","2":"37153","3":"47984","4":"226","5":"24008"},{"1":"Bennelong","2":"42943","3":"43215","4":"244","5":"19973"},{"1":"Berowra","2":"48471","3":"40369","4":"212","5":"16038"},{"1":"Blaxland","2":"20406","3":"57926","4":"220","5":"25883"},{"1":"Bradfield","2":"53681","3":"34927","4":"202","5":"17261"},{"1":"Calare","2":"54091","3":"35779","4":"285","5":"25342"},{"1":"Chifley","2":"32871","3":"46702","4":"263","5":"28180"},{"1":"Cook","2":"47505","3":"38804","4":"229","5":"18713"},{"1":"Cowper","2":"57493","3":"38317","4":"315","5":"25197"},{"1":"Cunningham","2":"60906","3":"31840","4":"268","5":"20607"},{"1":"Dobell","2":"59475","3":"30987","4":"255","5":"24275"},{"1":"Eden-Monaro","2":"57223","3":"30926","4":"249","5":"22139"},{"1":"Farrer","2":"48432","3":"39297","4":"277","5":"25669"},{"1":"Fowler","2":"27847","3":"48782","4":"228","5":"29251"},{"1":"Gilmore","2":"59322","3":"36386","4":"303","5":"23109"},{"1":"Grayndler","2":"73208","3":"18429","4":"136","5":"16074"},{"1":"Greenway","2":"38016","3":"43980","4":"217","5":"25253"},{"1":"Hughes","2":"51337","3":"36558","4":"185","5":"17038"},{"1":"Hume","2":"51284","3":"36271","4":"213","5":"23457"},{"1":"Hunter","2":"59137","3":"32723","4":"251","5":"25253"},{"1":"Kingsford Smith","2":"56297","3":"31510","4":"225","5":"22399"},{"1":"Lindsay","2":"49071","3":"38295","4":"234","5":"26955"},{"1":"Lyne","2":"51416","3":"41539","4":"316","5":"21426"},{"1":"Macarthur","2":"43323","3":"39907","4":"228","5":"27271"},{"1":"Mackellar","2":"62350","3":"29330","4":"208","5":"17500"},{"1":"Macquarie","2":"56180","3":"31778","4":"235","5":"18490"},{"1":"McMahon","2":"29146","3":"53967","4":"242","5":"23721"},{"1":"Mitchell","2":"42112","3":"43652","4":"176","5":"19436"},{"1":"Newcastle","2":"71158","3":"23999","4":"232","5":"19970"},{"1":"New England","2":"44608","3":"40324","4":"256","5":"25581"},{"1":"North Sydney","2":"64813","3":"25473","4":"193","5":"17538"},{"1":"Page","2":"55943","3":"37727","4":"291","5":"25645"},{"1":"Parkes","2":"41408","3":"37108","4":"241","5":"29777"},{"1":"Parramatta","2":"29299","3":"47038","4":"197","5":"25757"},{"1":"Paterson","2":"60915","3":"32059","4":"279","5":"24264"},{"1":"Reid","2":"43567","3":"39061","4":"203","5":"23786"},{"1":"Richmond","2":"62591","3":"29625","4":"274","5":"22719"},{"1":"Riverina","2":"47333","3":"39308","4":"265","5":"25632"},{"1":"Robertson","2":"58689","3":"30614","4":"231","5":"20431"},{"1":"Shortland","2":"62455","3":"29836","4":"255","5":"19675"},{"1":"Sydney","2":"76144","3":"14860","4":"146","5":"22093"},{"1":"Warringah","2":"64999","3":"21660","4":"172","5":"16630"},{"1":"Watson","2":"24915","3":"57160","4":"205","5":"24634"},{"1":"Wentworth","2":"69279","3":"16410","4":"162","5":"18121"},{"1":"Werriwa","2":"30252","3":"53174","4":"269","5":"29282"},{"1":"Whitlam","2":"57562","3":"34879","4":"276","5":"23064"},{"1":"Victoria Divisions","2":"NA","3":"NA","4":"NA","5":"NA"},{"1":"Aston","2":"48455","3":"29730","4":"234","5":"17664"},{"1":"Ballarat","2":"65613","3":"27405","4":"333","5":"20923"},{"1":"Batman","2":"66383","3":"26906","4":"287","5":"17901"},{"1":"Bendigo","2":"63412","3":"28852","4":"333","5":"19360"},{"1":"Bruce","2":"34644","3":"39203","4":"257","5":"21261"},{"1":"Calwell","2":"37839","3":"49823","4":"331","5":"23588"},{"1":"Casey","2":"59959","3":"28144","4":"316","5":"16807"},{"1":"Chisholm","2":"49448","3":"30844","4":"271","5":"17188"},{"1":"Corangamite","2":"69723","3":"27708","4":"326","5":"17123"},{"1":"Corio","2":"62658","3":"29865","4":"359","5":"18255"},{"1":"Deakin","2":"55464","3":"28973","4":"276","5":"15389"},{"1":"Dunkley","2":"62840","3":"24471","4":"285","5":"19322"},{"1":"Flinders","2":"68291","3":"29275","4":"336","5":"21407"},{"1":"Gellibrand","2":"62045","3":"29065","4":"278","5":"19771"},{"1":"Gippsland","2":"51196","3":"33910","4":"338","5":"20370"},{"1":"Goldstein","2":"69726","3":"21663","4":"238","5":"14857"},{"1":"Gorton","2":"49834","3":"43587","4":"347","5":"27479"},{"1":"Higgins","2":"70059","3":"19375","4":"180","5":"16615"},{"1":"Holt","2":"47147","3":"45875","4":"289","5":"28260"},{"1":"Hotham","2":"47986","3":"32524","4":"303","5":"19732"},{"1":"Indi","2":"54563","3":"31925","4":"324","5":"18934"},{"1":"Isaacs","2":"56645","3":"30063","4":"275","5":"20692"},{"1":"Jagajaga","2":"65098","3":"23453","4":"255","5":"15363"},{"1":"Kooyong","2":"63592","3":"22729","4":"231","5":"14147"},{"1":"Lalor","2":"57062","3":"43429","4":"345","5":"30127"},{"1":"La Trobe","2":"61807","3":"29826","4":"268","5":"19002"},{"1":"Mallee","2":"42495","3":"35795","4":"359","5":"21207"},{"1":"Maribyrnong","2":"53208","3":"35658","4":"360","5":"23762"},{"1":"McEwen","2":"73705","3":"39007","4":"377","5":"26966"},{"1":"McMillan","2":"61479","3":"36500","4":"372","5":"22403"},{"1":"Melbourne","2":"81287","3":"15839","4":"182","5":"20154"},{"1":"Melbourne Ports","2":"70589","3":"15523","4":"198","5":"18745"},{"1":"Menzies","2":"47137","3":"35626","4":"258","5":"15745"},{"1":"Murray","2":"48205","3":"35452","4":"357","5":"21560"},{"1":"Scullin","2":"48245","3":"42147","4":"357","5":"22817"},{"1":"Wannon","2":"49340","3":"31529","4":"343","5":"18569"},{"1":"Wills","2":"68450","3":"29399","4":"250","5":"20169"},{"1":"Queensland Divisions","2":"NA","3":"NA","4":"NA","5":"NA"},{"1":"Blair","2":"47194","3":"31433","4":"256","5":"23975"},{"1":"Bonner","2":"52139","3":"31891","4":"209","5":"17981"},{"1":"Bowman","2":"53529","3":"32627","4":"220","5":"19691"},{"1":"Brisbane","2":"72812","3":"18762","4":"159","5":"20656"},{"1":"Capricornia","2":"39917","3":"33917","4":"230","5":"24896"},{"1":"Dawson","2":"42539","3":"34599","4":"205","5":"26943"},{"1":"Dickson","2":"54206","3":"28988","4":"190","5":"18527"},{"1":"Fadden","2":"52154","3":"32218","4":"215","5":"26234"},{"1":"Fairfax","2":"58510","3":"32451","4":"277","5":"21335"},{"1":"Fisher","2":"52023","3":"30783","4":"258","5":"19625"},{"1":"Flynn","2":"39020","3":"36783","4":"262","5":"24529"},{"1":"Forde","2":"46937","3":"30585","4":"231","5":"24423"},{"1":"Griffith","2":"69171","3":"21132","4":"184","5":"20133"},{"1":"Groom","2":"40536","3":"41915","4":"262","5":"20717"},{"1":"Herbert","2":"48110","3":"28441","4":"207","5":"29665"},{"1":"Hinkler","2":"40649","3":"39548","4":"308","5":"22425"},{"1":"Kennedy","2":"33160","3":"37784","4":"263","5":"29794"},{"1":"Leichhardt","2":"47750","3":"27606","4":"239","5":"35841"},{"1":"Lilley","2":"59991","3":"28671","4":"218","5":"20249"},{"1":"Longman","2":"51268","3":"33576","4":"258","5":"24250"},{"1":"Maranoa","2":"35475","3":"45308","4":"352","5":"22553"},{"1":"McPherson","2":"54034","3":"28486","4":"229","5":"23214"},{"1":"Moncrieff","2":"50566","3":"28717","4":"214","5":"25232"},{"1":"Moreton","2":"47418","3":"30413","4":"220","5":"20020"},{"1":"Oxley","2":"44655","3":"29365","4":"224","5":"23348"},{"1":"Petrie","2":"53144","3":"33067","4":"200","5":"23323"},{"1":"Rankin","2":"41570","3":"34621","4":"237","5":"26119"},{"1":"Ryan","2":"64967","3":"24451","4":"162","5":"16223"},{"1":"Wide Bay","2":"46507","3":"37065","4":"319","5":"21645"},{"1":"Wright","2":"47109","3":"35812","4":"280","5":"22144"},{"1":"South Australia Divisions","2":"NA","3":"NA","4":"NA","5":"NA"},{"1":"Adelaide","2":"62769","3":"26771","4":"217","5":"20477"},{"1":"Barker","2":"42498","3":"38827","4":"243","5":"24297"},{"1":"Boothby","2":"62139","3":"28556","4":"234","5":"16919"},{"1":"Grey","2":"40811","3":"35750","4":"260","5":"25327"},{"1":"Hindmarsh","2":"57947","3":"33613","4":"273","5":"20548"},{"1":"Kingston","2":"58863","3":"27567","4":"252","5":"20764"},{"1":"Makin","2":"51547","3":"33743","4":"242","5":"21991"},{"1":"Mayo","2":"57361","3":"31247","4":"261","5":"17239"},{"1":"Port Adelaide","2":"53649","3":"33869","4":"276","5":"27253"},{"1":"Sturt","2":"52308","3":"32655","4":"252","5":"19410"},{"1":"Wakefield","2":"52636","3":"33649","4":"268","5":"27802"},{"1":"Western Australia Divisions","2":"NA","3":"NA","4":"NA","5":"NA"},{"1":"Brand","2":"51953","3":"25481","4":"194","5":"24466"},{"1":"Burt","2":"44058","3":"33275","4":"169","5":"24197"},{"1":"Canning","2":"48486","3":"32019","4":"214","5":"22157"},{"1":"Cowan","2":"44388","3":"31075","4":"184","5":"21330"},{"1":"Curtin","2":"59638","3":"22943","4":"178","5":"15706"},{"1":"Durack","2":"39304","3":"27128","4":"194","5":"31428"},{"1":"Forrest","2":"51612","3":"29285","4":"225","5":"21752"},{"1":"Fremantle","2":"57541","3":"24559","4":"236","5":"19878"},{"1":"Hasluck","2":"47880","3":"28836","4":"230","5":"19570"},{"1":"Moore","2":"56690","3":"26690","4":"195","5":"16916"},{"1":"O'Connor","2":"43554","3":"33987","4":"234","5":"24925"},{"1":"Pearce","2":"54305","3":"30699","4":"209","5":"26401"},{"1":"Perth","2":"57510","3":"22967","4":"177","5":"19479"},{"1":"Stirling","2":"47225","3":"30060","4":"190","5":"21345"},{"1":"Swan","2":"49093","3":"26830","4":"185","5":"21857"},{"1":"Tangney","2":"48338","3":"30090","4":"174","5":"14926"},{"1":"Tasmania Divisions","2":"NA","3":"NA","4":"NA","5":"NA"},{"1":"Bass","2":"36249","3":"22510","4":"145","5":"15487"},{"1":"Braddon","2":"30054","3":"25573","4":"154","5":"17632"},{"1":"Denison","2":"45005","3":"15992","4":"167","5":"13092"},{"1":"Franklin","2":"44746","3":"20322","4":"163","5":"13605"},{"1":"Lyons","2":"35894","3":"25258","4":"176","5":"17204"},{"1":"Northern Territory Divisions","2":"NA","3":"NA","4":"NA","5":"NA"},{"1":"Lingiari(c)","2":"19026","3":"15898","4":"106","5":"34854"},{"1":"Solomon","2":"29660","3":"15792","4":"123","5":"22642"},{"1":"Australian Capital Territory Divisions","2":"NA","3":"NA","4":"NA","5":"NA"},{"1":"Canberra(d)","2":"89590","3":"31361","4":"281","5":"24399"},{"1":"Fenner(e)","2":"85869","3":"30159","4":"253","5":"26196"},{"1":"Australia","2":"NA","3":"NA","4":"NA","5":"NA"},{"1":"© Commonwealth of Australia 2017","2":"NA","3":"NA","4":"NA","5":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>The most glaring remaining issue is that the administrative <em>Division</em> is not in its own column, but is on its own row within the <em>District</em> column. The following code uses case_when to make a new <em>Division</em> variable with an entry (e.g., New South Wales Division) where there is a Division name in the <em>District</em> column, and otherwise it create just an empty space. After that, <code>fill</code> can be used to fill in empty spaces with the most recent Division name. We then filter out rows with only the title information.</p>
<div class="cell" data-hash="challenge3_solutions_cache/html/australia2_6528638da13118b0bb6699c4753e4c2c">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>vote<span class="ot">&lt;-</span> vote_orig<span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Division =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_ends</span>(District, <span class="st">"Divisions"</span>) <span class="sc">~</span> District,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span> ))<span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(Division, <span class="at">.direction =</span> <span class="st">"down"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>vote<span class="ot">&lt;-</span> <span class="fu">filter</span>(vote,<span class="sc">!</span><span class="fu">str_detect</span>(District, <span class="st">"Division|Australia"</span>))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>vote</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["District"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Yes"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["No"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Illegible"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["No Response"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Division"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"Banks","2":"37736","3":"46343","4":"247","5":"20928","6":"New South Wales Divisions"},{"1":"Barton","2":"37153","3":"47984","4":"226","5":"24008","6":"New South Wales Divisions"},{"1":"Bennelong","2":"42943","3":"43215","4":"244","5":"19973","6":"New South Wales Divisions"},{"1":"Berowra","2":"48471","3":"40369","4":"212","5":"16038","6":"New South Wales Divisions"},{"1":"Blaxland","2":"20406","3":"57926","4":"220","5":"25883","6":"New South Wales Divisions"},{"1":"Bradfield","2":"53681","3":"34927","4":"202","5":"17261","6":"New South Wales Divisions"},{"1":"Calare","2":"54091","3":"35779","4":"285","5":"25342","6":"New South Wales Divisions"},{"1":"Chifley","2":"32871","3":"46702","4":"263","5":"28180","6":"New South Wales Divisions"},{"1":"Cook","2":"47505","3":"38804","4":"229","5":"18713","6":"New South Wales Divisions"},{"1":"Cowper","2":"57493","3":"38317","4":"315","5":"25197","6":"New South Wales Divisions"},{"1":"Cunningham","2":"60906","3":"31840","4":"268","5":"20607","6":"New South Wales Divisions"},{"1":"Dobell","2":"59475","3":"30987","4":"255","5":"24275","6":"New South Wales Divisions"},{"1":"Eden-Monaro","2":"57223","3":"30926","4":"249","5":"22139","6":"New South Wales Divisions"},{"1":"Farrer","2":"48432","3":"39297","4":"277","5":"25669","6":"New South Wales Divisions"},{"1":"Fowler","2":"27847","3":"48782","4":"228","5":"29251","6":"New South Wales Divisions"},{"1":"Gilmore","2":"59322","3":"36386","4":"303","5":"23109","6":"New South Wales Divisions"},{"1":"Grayndler","2":"73208","3":"18429","4":"136","5":"16074","6":"New South Wales Divisions"},{"1":"Greenway","2":"38016","3":"43980","4":"217","5":"25253","6":"New South Wales Divisions"},{"1":"Hughes","2":"51337","3":"36558","4":"185","5":"17038","6":"New South Wales Divisions"},{"1":"Hume","2":"51284","3":"36271","4":"213","5":"23457","6":"New South Wales Divisions"},{"1":"Hunter","2":"59137","3":"32723","4":"251","5":"25253","6":"New South Wales Divisions"},{"1":"Kingsford Smith","2":"56297","3":"31510","4":"225","5":"22399","6":"New South Wales Divisions"},{"1":"Lindsay","2":"49071","3":"38295","4":"234","5":"26955","6":"New South Wales Divisions"},{"1":"Lyne","2":"51416","3":"41539","4":"316","5":"21426","6":"New South Wales Divisions"},{"1":"Macarthur","2":"43323","3":"39907","4":"228","5":"27271","6":"New South Wales Divisions"},{"1":"Mackellar","2":"62350","3":"29330","4":"208","5":"17500","6":"New South Wales Divisions"},{"1":"Macquarie","2":"56180","3":"31778","4":"235","5":"18490","6":"New South Wales Divisions"},{"1":"McMahon","2":"29146","3":"53967","4":"242","5":"23721","6":"New South Wales Divisions"},{"1":"Mitchell","2":"42112","3":"43652","4":"176","5":"19436","6":"New South Wales Divisions"},{"1":"Newcastle","2":"71158","3":"23999","4":"232","5":"19970","6":"New South Wales Divisions"},{"1":"New England","2":"44608","3":"40324","4":"256","5":"25581","6":"New South Wales Divisions"},{"1":"North Sydney","2":"64813","3":"25473","4":"193","5":"17538","6":"New South Wales Divisions"},{"1":"Page","2":"55943","3":"37727","4":"291","5":"25645","6":"New South Wales Divisions"},{"1":"Parkes","2":"41408","3":"37108","4":"241","5":"29777","6":"New South Wales Divisions"},{"1":"Parramatta","2":"29299","3":"47038","4":"197","5":"25757","6":"New South Wales Divisions"},{"1":"Paterson","2":"60915","3":"32059","4":"279","5":"24264","6":"New South Wales Divisions"},{"1":"Reid","2":"43567","3":"39061","4":"203","5":"23786","6":"New South Wales Divisions"},{"1":"Richmond","2":"62591","3":"29625","4":"274","5":"22719","6":"New South Wales Divisions"},{"1":"Riverina","2":"47333","3":"39308","4":"265","5":"25632","6":"New South Wales Divisions"},{"1":"Robertson","2":"58689","3":"30614","4":"231","5":"20431","6":"New South Wales Divisions"},{"1":"Shortland","2":"62455","3":"29836","4":"255","5":"19675","6":"New South Wales Divisions"},{"1":"Sydney","2":"76144","3":"14860","4":"146","5":"22093","6":"New South Wales Divisions"},{"1":"Warringah","2":"64999","3":"21660","4":"172","5":"16630","6":"New South Wales Divisions"},{"1":"Watson","2":"24915","3":"57160","4":"205","5":"24634","6":"New South Wales Divisions"},{"1":"Wentworth","2":"69279","3":"16410","4":"162","5":"18121","6":"New South Wales Divisions"},{"1":"Werriwa","2":"30252","3":"53174","4":"269","5":"29282","6":"New South Wales Divisions"},{"1":"Whitlam","2":"57562","3":"34879","4":"276","5":"23064","6":"New South Wales Divisions"},{"1":"Aston","2":"48455","3":"29730","4":"234","5":"17664","6":"Victoria Divisions"},{"1":"Ballarat","2":"65613","3":"27405","4":"333","5":"20923","6":"Victoria Divisions"},{"1":"Batman","2":"66383","3":"26906","4":"287","5":"17901","6":"Victoria Divisions"},{"1":"Bendigo","2":"63412","3":"28852","4":"333","5":"19360","6":"Victoria Divisions"},{"1":"Bruce","2":"34644","3":"39203","4":"257","5":"21261","6":"Victoria Divisions"},{"1":"Calwell","2":"37839","3":"49823","4":"331","5":"23588","6":"Victoria Divisions"},{"1":"Casey","2":"59959","3":"28144","4":"316","5":"16807","6":"Victoria Divisions"},{"1":"Chisholm","2":"49448","3":"30844","4":"271","5":"17188","6":"Victoria Divisions"},{"1":"Corangamite","2":"69723","3":"27708","4":"326","5":"17123","6":"Victoria Divisions"},{"1":"Corio","2":"62658","3":"29865","4":"359","5":"18255","6":"Victoria Divisions"},{"1":"Deakin","2":"55464","3":"28973","4":"276","5":"15389","6":"Victoria Divisions"},{"1":"Dunkley","2":"62840","3":"24471","4":"285","5":"19322","6":"Victoria Divisions"},{"1":"Flinders","2":"68291","3":"29275","4":"336","5":"21407","6":"Victoria Divisions"},{"1":"Gellibrand","2":"62045","3":"29065","4":"278","5":"19771","6":"Victoria Divisions"},{"1":"Gippsland","2":"51196","3":"33910","4":"338","5":"20370","6":"Victoria Divisions"},{"1":"Goldstein","2":"69726","3":"21663","4":"238","5":"14857","6":"Victoria Divisions"},{"1":"Gorton","2":"49834","3":"43587","4":"347","5":"27479","6":"Victoria Divisions"},{"1":"Higgins","2":"70059","3":"19375","4":"180","5":"16615","6":"Victoria Divisions"},{"1":"Holt","2":"47147","3":"45875","4":"289","5":"28260","6":"Victoria Divisions"},{"1":"Hotham","2":"47986","3":"32524","4":"303","5":"19732","6":"Victoria Divisions"},{"1":"Indi","2":"54563","3":"31925","4":"324","5":"18934","6":"Victoria Divisions"},{"1":"Isaacs","2":"56645","3":"30063","4":"275","5":"20692","6":"Victoria Divisions"},{"1":"Jagajaga","2":"65098","3":"23453","4":"255","5":"15363","6":"Victoria Divisions"},{"1":"Kooyong","2":"63592","3":"22729","4":"231","5":"14147","6":"Victoria Divisions"},{"1":"Lalor","2":"57062","3":"43429","4":"345","5":"30127","6":"Victoria Divisions"},{"1":"La Trobe","2":"61807","3":"29826","4":"268","5":"19002","6":"Victoria Divisions"},{"1":"Mallee","2":"42495","3":"35795","4":"359","5":"21207","6":"Victoria Divisions"},{"1":"Maribyrnong","2":"53208","3":"35658","4":"360","5":"23762","6":"Victoria Divisions"},{"1":"McEwen","2":"73705","3":"39007","4":"377","5":"26966","6":"Victoria Divisions"},{"1":"McMillan","2":"61479","3":"36500","4":"372","5":"22403","6":"Victoria Divisions"},{"1":"Melbourne","2":"81287","3":"15839","4":"182","5":"20154","6":"Victoria Divisions"},{"1":"Melbourne Ports","2":"70589","3":"15523","4":"198","5":"18745","6":"Victoria Divisions"},{"1":"Menzies","2":"47137","3":"35626","4":"258","5":"15745","6":"Victoria Divisions"},{"1":"Murray","2":"48205","3":"35452","4":"357","5":"21560","6":"Victoria Divisions"},{"1":"Scullin","2":"48245","3":"42147","4":"357","5":"22817","6":"Victoria Divisions"},{"1":"Wannon","2":"49340","3":"31529","4":"343","5":"18569","6":"Victoria Divisions"},{"1":"Wills","2":"68450","3":"29399","4":"250","5":"20169","6":"Victoria Divisions"},{"1":"Blair","2":"47194","3":"31433","4":"256","5":"23975","6":"Queensland Divisions"},{"1":"Bonner","2":"52139","3":"31891","4":"209","5":"17981","6":"Queensland Divisions"},{"1":"Bowman","2":"53529","3":"32627","4":"220","5":"19691","6":"Queensland Divisions"},{"1":"Brisbane","2":"72812","3":"18762","4":"159","5":"20656","6":"Queensland Divisions"},{"1":"Capricornia","2":"39917","3":"33917","4":"230","5":"24896","6":"Queensland Divisions"},{"1":"Dawson","2":"42539","3":"34599","4":"205","5":"26943","6":"Queensland Divisions"},{"1":"Dickson","2":"54206","3":"28988","4":"190","5":"18527","6":"Queensland Divisions"},{"1":"Fadden","2":"52154","3":"32218","4":"215","5":"26234","6":"Queensland Divisions"},{"1":"Fairfax","2":"58510","3":"32451","4":"277","5":"21335","6":"Queensland Divisions"},{"1":"Fisher","2":"52023","3":"30783","4":"258","5":"19625","6":"Queensland Divisions"},{"1":"Flynn","2":"39020","3":"36783","4":"262","5":"24529","6":"Queensland Divisions"},{"1":"Forde","2":"46937","3":"30585","4":"231","5":"24423","6":"Queensland Divisions"},{"1":"Griffith","2":"69171","3":"21132","4":"184","5":"20133","6":"Queensland Divisions"},{"1":"Groom","2":"40536","3":"41915","4":"262","5":"20717","6":"Queensland Divisions"},{"1":"Herbert","2":"48110","3":"28441","4":"207","5":"29665","6":"Queensland Divisions"},{"1":"Hinkler","2":"40649","3":"39548","4":"308","5":"22425","6":"Queensland Divisions"},{"1":"Kennedy","2":"33160","3":"37784","4":"263","5":"29794","6":"Queensland Divisions"},{"1":"Leichhardt","2":"47750","3":"27606","4":"239","5":"35841","6":"Queensland Divisions"},{"1":"Lilley","2":"59991","3":"28671","4":"218","5":"20249","6":"Queensland Divisions"},{"1":"Longman","2":"51268","3":"33576","4":"258","5":"24250","6":"Queensland Divisions"},{"1":"Maranoa","2":"35475","3":"45308","4":"352","5":"22553","6":"Queensland Divisions"},{"1":"McPherson","2":"54034","3":"28486","4":"229","5":"23214","6":"Queensland Divisions"},{"1":"Moncrieff","2":"50566","3":"28717","4":"214","5":"25232","6":"Queensland Divisions"},{"1":"Moreton","2":"47418","3":"30413","4":"220","5":"20020","6":"Queensland Divisions"},{"1":"Oxley","2":"44655","3":"29365","4":"224","5":"23348","6":"Queensland Divisions"},{"1":"Petrie","2":"53144","3":"33067","4":"200","5":"23323","6":"Queensland Divisions"},{"1":"Rankin","2":"41570","3":"34621","4":"237","5":"26119","6":"Queensland Divisions"},{"1":"Ryan","2":"64967","3":"24451","4":"162","5":"16223","6":"Queensland Divisions"},{"1":"Wide Bay","2":"46507","3":"37065","4":"319","5":"21645","6":"Queensland Divisions"},{"1":"Wright","2":"47109","3":"35812","4":"280","5":"22144","6":"Queensland Divisions"},{"1":"Adelaide","2":"62769","3":"26771","4":"217","5":"20477","6":"South Australia Divisions"},{"1":"Barker","2":"42498","3":"38827","4":"243","5":"24297","6":"South Australia Divisions"},{"1":"Boothby","2":"62139","3":"28556","4":"234","5":"16919","6":"South Australia Divisions"},{"1":"Grey","2":"40811","3":"35750","4":"260","5":"25327","6":"South Australia Divisions"},{"1":"Hindmarsh","2":"57947","3":"33613","4":"273","5":"20548","6":"South Australia Divisions"},{"1":"Kingston","2":"58863","3":"27567","4":"252","5":"20764","6":"South Australia Divisions"},{"1":"Makin","2":"51547","3":"33743","4":"242","5":"21991","6":"South Australia Divisions"},{"1":"Mayo","2":"57361","3":"31247","4":"261","5":"17239","6":"South Australia Divisions"},{"1":"Port Adelaide","2":"53649","3":"33869","4":"276","5":"27253","6":"South Australia Divisions"},{"1":"Sturt","2":"52308","3":"32655","4":"252","5":"19410","6":"South Australia Divisions"},{"1":"Wakefield","2":"52636","3":"33649","4":"268","5":"27802","6":"South Australia Divisions"},{"1":"Brand","2":"51953","3":"25481","4":"194","5":"24466","6":"Western Australia Divisions"},{"1":"Burt","2":"44058","3":"33275","4":"169","5":"24197","6":"Western Australia Divisions"},{"1":"Canning","2":"48486","3":"32019","4":"214","5":"22157","6":"Western Australia Divisions"},{"1":"Cowan","2":"44388","3":"31075","4":"184","5":"21330","6":"Western Australia Divisions"},{"1":"Curtin","2":"59638","3":"22943","4":"178","5":"15706","6":"Western Australia Divisions"},{"1":"Durack","2":"39304","3":"27128","4":"194","5":"31428","6":"Western Australia Divisions"},{"1":"Forrest","2":"51612","3":"29285","4":"225","5":"21752","6":"Western Australia Divisions"},{"1":"Fremantle","2":"57541","3":"24559","4":"236","5":"19878","6":"Western Australia Divisions"},{"1":"Hasluck","2":"47880","3":"28836","4":"230","5":"19570","6":"Western Australia Divisions"},{"1":"Moore","2":"56690","3":"26690","4":"195","5":"16916","6":"Western Australia Divisions"},{"1":"O'Connor","2":"43554","3":"33987","4":"234","5":"24925","6":"Western Australia Divisions"},{"1":"Pearce","2":"54305","3":"30699","4":"209","5":"26401","6":"Western Australia Divisions"},{"1":"Perth","2":"57510","3":"22967","4":"177","5":"19479","6":"Western Australia Divisions"},{"1":"Stirling","2":"47225","3":"30060","4":"190","5":"21345","6":"Western Australia Divisions"},{"1":"Swan","2":"49093","3":"26830","4":"185","5":"21857","6":"Western Australia Divisions"},{"1":"Tangney","2":"48338","3":"30090","4":"174","5":"14926","6":"Western Australia Divisions"},{"1":"Bass","2":"36249","3":"22510","4":"145","5":"15487","6":"Tasmania Divisions"},{"1":"Braddon","2":"30054","3":"25573","4":"154","5":"17632","6":"Tasmania Divisions"},{"1":"Denison","2":"45005","3":"15992","4":"167","5":"13092","6":"Tasmania Divisions"},{"1":"Franklin","2":"44746","3":"20322","4":"163","5":"13605","6":"Tasmania Divisions"},{"1":"Lyons","2":"35894","3":"25258","4":"176","5":"17204","6":"Tasmania Divisions"},{"1":"Lingiari(c)","2":"19026","3":"15898","4":"106","5":"34854","6":"Northern Territory Divisions"},{"1":"Solomon","2":"29660","3":"15792","4":"123","5":"22642","6":"Northern Territory Divisions"},{"1":"Canberra(d)","2":"89590","3":"31361","4":"281","5":"24399","6":"Australian Capital Territory Divisions"},{"1":"Fenner(e)","2":"85869","3":"30159","4":"253","5":"26196","6":"Australian Capital Territory Divisions"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Supposed we wanted to create a stacked bar chart to compare the % who votes Yes to the people who either said No or didn’t vote. Or if we wanted to use division level characteristics to predict the proortion of people voting in a specific way? In both cases, we would need tidy data, which requires us to pivot longer into the original (aggregated) data format: Division, District, Response, Count. We should end up with 600 rows and 4 columns.</p>
<div class="cell" data-hash="challenge3_solutions_cache/html/australia3_7276c0ea506a91b7dcaab9001b458ba8">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>vote_long<span class="ot">&lt;-</span> vote<span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> Yes<span class="sc">:</span><span class="st">`</span><span class="at">No Response</span><span class="st">`</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Response"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Count"</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>vote</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["District"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Yes"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["No"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Illegible"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["No Response"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Division"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"Banks","2":"37736","3":"46343","4":"247","5":"20928","6":"New South Wales Divisions"},{"1":"Barton","2":"37153","3":"47984","4":"226","5":"24008","6":"New South Wales Divisions"},{"1":"Bennelong","2":"42943","3":"43215","4":"244","5":"19973","6":"New South Wales Divisions"},{"1":"Berowra","2":"48471","3":"40369","4":"212","5":"16038","6":"New South Wales Divisions"},{"1":"Blaxland","2":"20406","3":"57926","4":"220","5":"25883","6":"New South Wales Divisions"},{"1":"Bradfield","2":"53681","3":"34927","4":"202","5":"17261","6":"New South Wales Divisions"},{"1":"Calare","2":"54091","3":"35779","4":"285","5":"25342","6":"New South Wales Divisions"},{"1":"Chifley","2":"32871","3":"46702","4":"263","5":"28180","6":"New South Wales Divisions"},{"1":"Cook","2":"47505","3":"38804","4":"229","5":"18713","6":"New South Wales Divisions"},{"1":"Cowper","2":"57493","3":"38317","4":"315","5":"25197","6":"New South Wales Divisions"},{"1":"Cunningham","2":"60906","3":"31840","4":"268","5":"20607","6":"New South Wales Divisions"},{"1":"Dobell","2":"59475","3":"30987","4":"255","5":"24275","6":"New South Wales Divisions"},{"1":"Eden-Monaro","2":"57223","3":"30926","4":"249","5":"22139","6":"New South Wales Divisions"},{"1":"Farrer","2":"48432","3":"39297","4":"277","5":"25669","6":"New South Wales Divisions"},{"1":"Fowler","2":"27847","3":"48782","4":"228","5":"29251","6":"New South Wales Divisions"},{"1":"Gilmore","2":"59322","3":"36386","4":"303","5":"23109","6":"New South Wales Divisions"},{"1":"Grayndler","2":"73208","3":"18429","4":"136","5":"16074","6":"New South Wales Divisions"},{"1":"Greenway","2":"38016","3":"43980","4":"217","5":"25253","6":"New South Wales Divisions"},{"1":"Hughes","2":"51337","3":"36558","4":"185","5":"17038","6":"New South Wales Divisions"},{"1":"Hume","2":"51284","3":"36271","4":"213","5":"23457","6":"New South Wales Divisions"},{"1":"Hunter","2":"59137","3":"32723","4":"251","5":"25253","6":"New South Wales Divisions"},{"1":"Kingsford Smith","2":"56297","3":"31510","4":"225","5":"22399","6":"New South Wales Divisions"},{"1":"Lindsay","2":"49071","3":"38295","4":"234","5":"26955","6":"New South Wales Divisions"},{"1":"Lyne","2":"51416","3":"41539","4":"316","5":"21426","6":"New South Wales Divisions"},{"1":"Macarthur","2":"43323","3":"39907","4":"228","5":"27271","6":"New South Wales Divisions"},{"1":"Mackellar","2":"62350","3":"29330","4":"208","5":"17500","6":"New South Wales Divisions"},{"1":"Macquarie","2":"56180","3":"31778","4":"235","5":"18490","6":"New South Wales Divisions"},{"1":"McMahon","2":"29146","3":"53967","4":"242","5":"23721","6":"New South Wales Divisions"},{"1":"Mitchell","2":"42112","3":"43652","4":"176","5":"19436","6":"New South Wales Divisions"},{"1":"Newcastle","2":"71158","3":"23999","4":"232","5":"19970","6":"New South Wales Divisions"},{"1":"New England","2":"44608","3":"40324","4":"256","5":"25581","6":"New South Wales Divisions"},{"1":"North Sydney","2":"64813","3":"25473","4":"193","5":"17538","6":"New South Wales Divisions"},{"1":"Page","2":"55943","3":"37727","4":"291","5":"25645","6":"New South Wales Divisions"},{"1":"Parkes","2":"41408","3":"37108","4":"241","5":"29777","6":"New South Wales Divisions"},{"1":"Parramatta","2":"29299","3":"47038","4":"197","5":"25757","6":"New South Wales Divisions"},{"1":"Paterson","2":"60915","3":"32059","4":"279","5":"24264","6":"New South Wales Divisions"},{"1":"Reid","2":"43567","3":"39061","4":"203","5":"23786","6":"New South Wales Divisions"},{"1":"Richmond","2":"62591","3":"29625","4":"274","5":"22719","6":"New South Wales Divisions"},{"1":"Riverina","2":"47333","3":"39308","4":"265","5":"25632","6":"New South Wales Divisions"},{"1":"Robertson","2":"58689","3":"30614","4":"231","5":"20431","6":"New South Wales Divisions"},{"1":"Shortland","2":"62455","3":"29836","4":"255","5":"19675","6":"New South Wales Divisions"},{"1":"Sydney","2":"76144","3":"14860","4":"146","5":"22093","6":"New South Wales Divisions"},{"1":"Warringah","2":"64999","3":"21660","4":"172","5":"16630","6":"New South Wales Divisions"},{"1":"Watson","2":"24915","3":"57160","4":"205","5":"24634","6":"New South Wales Divisions"},{"1":"Wentworth","2":"69279","3":"16410","4":"162","5":"18121","6":"New South Wales Divisions"},{"1":"Werriwa","2":"30252","3":"53174","4":"269","5":"29282","6":"New South Wales Divisions"},{"1":"Whitlam","2":"57562","3":"34879","4":"276","5":"23064","6":"New South Wales Divisions"},{"1":"Aston","2":"48455","3":"29730","4":"234","5":"17664","6":"Victoria Divisions"},{"1":"Ballarat","2":"65613","3":"27405","4":"333","5":"20923","6":"Victoria Divisions"},{"1":"Batman","2":"66383","3":"26906","4":"287","5":"17901","6":"Victoria Divisions"},{"1":"Bendigo","2":"63412","3":"28852","4":"333","5":"19360","6":"Victoria Divisions"},{"1":"Bruce","2":"34644","3":"39203","4":"257","5":"21261","6":"Victoria Divisions"},{"1":"Calwell","2":"37839","3":"49823","4":"331","5":"23588","6":"Victoria Divisions"},{"1":"Casey","2":"59959","3":"28144","4":"316","5":"16807","6":"Victoria Divisions"},{"1":"Chisholm","2":"49448","3":"30844","4":"271","5":"17188","6":"Victoria Divisions"},{"1":"Corangamite","2":"69723","3":"27708","4":"326","5":"17123","6":"Victoria Divisions"},{"1":"Corio","2":"62658","3":"29865","4":"359","5":"18255","6":"Victoria Divisions"},{"1":"Deakin","2":"55464","3":"28973","4":"276","5":"15389","6":"Victoria Divisions"},{"1":"Dunkley","2":"62840","3":"24471","4":"285","5":"19322","6":"Victoria Divisions"},{"1":"Flinders","2":"68291","3":"29275","4":"336","5":"21407","6":"Victoria Divisions"},{"1":"Gellibrand","2":"62045","3":"29065","4":"278","5":"19771","6":"Victoria Divisions"},{"1":"Gippsland","2":"51196","3":"33910","4":"338","5":"20370","6":"Victoria Divisions"},{"1":"Goldstein","2":"69726","3":"21663","4":"238","5":"14857","6":"Victoria Divisions"},{"1":"Gorton","2":"49834","3":"43587","4":"347","5":"27479","6":"Victoria Divisions"},{"1":"Higgins","2":"70059","3":"19375","4":"180","5":"16615","6":"Victoria Divisions"},{"1":"Holt","2":"47147","3":"45875","4":"289","5":"28260","6":"Victoria Divisions"},{"1":"Hotham","2":"47986","3":"32524","4":"303","5":"19732","6":"Victoria Divisions"},{"1":"Indi","2":"54563","3":"31925","4":"324","5":"18934","6":"Victoria Divisions"},{"1":"Isaacs","2":"56645","3":"30063","4":"275","5":"20692","6":"Victoria Divisions"},{"1":"Jagajaga","2":"65098","3":"23453","4":"255","5":"15363","6":"Victoria Divisions"},{"1":"Kooyong","2":"63592","3":"22729","4":"231","5":"14147","6":"Victoria Divisions"},{"1":"Lalor","2":"57062","3":"43429","4":"345","5":"30127","6":"Victoria Divisions"},{"1":"La Trobe","2":"61807","3":"29826","4":"268","5":"19002","6":"Victoria Divisions"},{"1":"Mallee","2":"42495","3":"35795","4":"359","5":"21207","6":"Victoria Divisions"},{"1":"Maribyrnong","2":"53208","3":"35658","4":"360","5":"23762","6":"Victoria Divisions"},{"1":"McEwen","2":"73705","3":"39007","4":"377","5":"26966","6":"Victoria Divisions"},{"1":"McMillan","2":"61479","3":"36500","4":"372","5":"22403","6":"Victoria Divisions"},{"1":"Melbourne","2":"81287","3":"15839","4":"182","5":"20154","6":"Victoria Divisions"},{"1":"Melbourne Ports","2":"70589","3":"15523","4":"198","5":"18745","6":"Victoria Divisions"},{"1":"Menzies","2":"47137","3":"35626","4":"258","5":"15745","6":"Victoria Divisions"},{"1":"Murray","2":"48205","3":"35452","4":"357","5":"21560","6":"Victoria Divisions"},{"1":"Scullin","2":"48245","3":"42147","4":"357","5":"22817","6":"Victoria Divisions"},{"1":"Wannon","2":"49340","3":"31529","4":"343","5":"18569","6":"Victoria Divisions"},{"1":"Wills","2":"68450","3":"29399","4":"250","5":"20169","6":"Victoria Divisions"},{"1":"Blair","2":"47194","3":"31433","4":"256","5":"23975","6":"Queensland Divisions"},{"1":"Bonner","2":"52139","3":"31891","4":"209","5":"17981","6":"Queensland Divisions"},{"1":"Bowman","2":"53529","3":"32627","4":"220","5":"19691","6":"Queensland Divisions"},{"1":"Brisbane","2":"72812","3":"18762","4":"159","5":"20656","6":"Queensland Divisions"},{"1":"Capricornia","2":"39917","3":"33917","4":"230","5":"24896","6":"Queensland Divisions"},{"1":"Dawson","2":"42539","3":"34599","4":"205","5":"26943","6":"Queensland Divisions"},{"1":"Dickson","2":"54206","3":"28988","4":"190","5":"18527","6":"Queensland Divisions"},{"1":"Fadden","2":"52154","3":"32218","4":"215","5":"26234","6":"Queensland Divisions"},{"1":"Fairfax","2":"58510","3":"32451","4":"277","5":"21335","6":"Queensland Divisions"},{"1":"Fisher","2":"52023","3":"30783","4":"258","5":"19625","6":"Queensland Divisions"},{"1":"Flynn","2":"39020","3":"36783","4":"262","5":"24529","6":"Queensland Divisions"},{"1":"Forde","2":"46937","3":"30585","4":"231","5":"24423","6":"Queensland Divisions"},{"1":"Griffith","2":"69171","3":"21132","4":"184","5":"20133","6":"Queensland Divisions"},{"1":"Groom","2":"40536","3":"41915","4":"262","5":"20717","6":"Queensland Divisions"},{"1":"Herbert","2":"48110","3":"28441","4":"207","5":"29665","6":"Queensland Divisions"},{"1":"Hinkler","2":"40649","3":"39548","4":"308","5":"22425","6":"Queensland Divisions"},{"1":"Kennedy","2":"33160","3":"37784","4":"263","5":"29794","6":"Queensland Divisions"},{"1":"Leichhardt","2":"47750","3":"27606","4":"239","5":"35841","6":"Queensland Divisions"},{"1":"Lilley","2":"59991","3":"28671","4":"218","5":"20249","6":"Queensland Divisions"},{"1":"Longman","2":"51268","3":"33576","4":"258","5":"24250","6":"Queensland Divisions"},{"1":"Maranoa","2":"35475","3":"45308","4":"352","5":"22553","6":"Queensland Divisions"},{"1":"McPherson","2":"54034","3":"28486","4":"229","5":"23214","6":"Queensland Divisions"},{"1":"Moncrieff","2":"50566","3":"28717","4":"214","5":"25232","6":"Queensland Divisions"},{"1":"Moreton","2":"47418","3":"30413","4":"220","5":"20020","6":"Queensland Divisions"},{"1":"Oxley","2":"44655","3":"29365","4":"224","5":"23348","6":"Queensland Divisions"},{"1":"Petrie","2":"53144","3":"33067","4":"200","5":"23323","6":"Queensland Divisions"},{"1":"Rankin","2":"41570","3":"34621","4":"237","5":"26119","6":"Queensland Divisions"},{"1":"Ryan","2":"64967","3":"24451","4":"162","5":"16223","6":"Queensland Divisions"},{"1":"Wide Bay","2":"46507","3":"37065","4":"319","5":"21645","6":"Queensland Divisions"},{"1":"Wright","2":"47109","3":"35812","4":"280","5":"22144","6":"Queensland Divisions"},{"1":"Adelaide","2":"62769","3":"26771","4":"217","5":"20477","6":"South Australia Divisions"},{"1":"Barker","2":"42498","3":"38827","4":"243","5":"24297","6":"South Australia Divisions"},{"1":"Boothby","2":"62139","3":"28556","4":"234","5":"16919","6":"South Australia Divisions"},{"1":"Grey","2":"40811","3":"35750","4":"260","5":"25327","6":"South Australia Divisions"},{"1":"Hindmarsh","2":"57947","3":"33613","4":"273","5":"20548","6":"South Australia Divisions"},{"1":"Kingston","2":"58863","3":"27567","4":"252","5":"20764","6":"South Australia Divisions"},{"1":"Makin","2":"51547","3":"33743","4":"242","5":"21991","6":"South Australia Divisions"},{"1":"Mayo","2":"57361","3":"31247","4":"261","5":"17239","6":"South Australia Divisions"},{"1":"Port Adelaide","2":"53649","3":"33869","4":"276","5":"27253","6":"South Australia Divisions"},{"1":"Sturt","2":"52308","3":"32655","4":"252","5":"19410","6":"South Australia Divisions"},{"1":"Wakefield","2":"52636","3":"33649","4":"268","5":"27802","6":"South Australia Divisions"},{"1":"Brand","2":"51953","3":"25481","4":"194","5":"24466","6":"Western Australia Divisions"},{"1":"Burt","2":"44058","3":"33275","4":"169","5":"24197","6":"Western Australia Divisions"},{"1":"Canning","2":"48486","3":"32019","4":"214","5":"22157","6":"Western Australia Divisions"},{"1":"Cowan","2":"44388","3":"31075","4":"184","5":"21330","6":"Western Australia Divisions"},{"1":"Curtin","2":"59638","3":"22943","4":"178","5":"15706","6":"Western Australia Divisions"},{"1":"Durack","2":"39304","3":"27128","4":"194","5":"31428","6":"Western Australia Divisions"},{"1":"Forrest","2":"51612","3":"29285","4":"225","5":"21752","6":"Western Australia Divisions"},{"1":"Fremantle","2":"57541","3":"24559","4":"236","5":"19878","6":"Western Australia Divisions"},{"1":"Hasluck","2":"47880","3":"28836","4":"230","5":"19570","6":"Western Australia Divisions"},{"1":"Moore","2":"56690","3":"26690","4":"195","5":"16916","6":"Western Australia Divisions"},{"1":"O'Connor","2":"43554","3":"33987","4":"234","5":"24925","6":"Western Australia Divisions"},{"1":"Pearce","2":"54305","3":"30699","4":"209","5":"26401","6":"Western Australia Divisions"},{"1":"Perth","2":"57510","3":"22967","4":"177","5":"19479","6":"Western Australia Divisions"},{"1":"Stirling","2":"47225","3":"30060","4":"190","5":"21345","6":"Western Australia Divisions"},{"1":"Swan","2":"49093","3":"26830","4":"185","5":"21857","6":"Western Australia Divisions"},{"1":"Tangney","2":"48338","3":"30090","4":"174","5":"14926","6":"Western Australia Divisions"},{"1":"Bass","2":"36249","3":"22510","4":"145","5":"15487","6":"Tasmania Divisions"},{"1":"Braddon","2":"30054","3":"25573","4":"154","5":"17632","6":"Tasmania Divisions"},{"1":"Denison","2":"45005","3":"15992","4":"167","5":"13092","6":"Tasmania Divisions"},{"1":"Franklin","2":"44746","3":"20322","4":"163","5":"13605","6":"Tasmania Divisions"},{"1":"Lyons","2":"35894","3":"25258","4":"176","5":"17204","6":"Tasmania Divisions"},{"1":"Lingiari(c)","2":"19026","3":"15898","4":"106","5":"34854","6":"Northern Territory Divisions"},{"1":"Solomon","2":"29660","3":"15792","4":"123","5":"22642","6":"Northern Territory Divisions"},{"1":"Canberra(d)","2":"89590","3":"31361","4":"281","5":"24399","6":"Australian Capital Territory Divisions"},{"1":"Fenner(e)","2":"85869","3":"30159","4":"253","5":"26196","6":"Australian Capital Territory Divisions"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<p>The excel workbook “USA Households by Total Money Income, Race, and Hispanic Origin of Householder 1967 to 2019” is clearly a table of census-type household data (e.g., Current Population Study or CPS, American Community Study or ACS, etc.) Row 3 of the workbook provides <a href="https://www2.census.gov/programs-surveys/cps/techdocs/cpsmar20.pdf">a link to more details about the origin of the data used to produce the table.</a></p>
<p>The cases in this example are essentially year-identity groups, where I use the term identity to refer to the wide range of ways that the census can cluster racial and identity identity. While there are 12 categories in the data, many of these overlap and/or are not available in specific years. For example, one category is “All Races”, and it overlaps with all other categories but cannot be easily eliminated because it isn’t clear how</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="solution_images/us_hholds.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Excel Workbook Screenshot</figcaption><p></p>
</figure>
</div>
<section id="identify-desired-data-structure" class="level3">
<h3 class="anchored" data-anchor-id="identify-desired-data-structure">Identify desired data structure</h3>
<p>Inspection of the excel workbook reveals several critical features of the data. - column names (of a sort) are in rows 4 and 5 (skip=5 and rename) - first column includes <em>year</em> and <em>race/hispanic origin</em> households - first column appears to have notes of some sort (remove notes) - there are end notes starting in row 358 (n_max = 352) - “Total” column appears to be redundant proportion info</p>
<p>The data appears to have two grouping variables (<em>year</em> and <em>identityity</em>), plus several values:</p>
<ul>
<li>a count of number of households</li>
<li>median and mean income (and associated margin of error)</li>
<li>proportion of households with hhold income in one of 9 designated ranges or brackets</li>
</ul>
<p>The final data should probably</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Read and clean the data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Clean and separate *year” column</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Sanity check for <em>identity</em></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-hash="challenge3_solutions_cache/html/hh1_74326f172408461dd33d6e2ab182c3e9">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>income_brackets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">i1 =</span> <span class="st">"Under $15,000"</span>,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i2 =</span> <span class="st">"$15,000 to $24,999"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i3 =</span> <span class="st">"$25,000 to $34,999"</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i4=</span> <span class="st">"$35,000 to $49,999"</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i5 =</span> <span class="st">"$50,000 to $74,999"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i6 =</span> <span class="st">"$75,000 to $99,999"</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i7 =</span> <span class="st">"$100,000 to $149,999"</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i8 =</span> <span class="st">"$150,000 to $199,999"</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i9 =</span> <span class="st">"$200,000 and over"</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>ushh_orig <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"_data/USA Households by Total Money Income, Race, and Hispanic Origin of Householder 1967 to 2019.xlsx"</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip=</span><span class="dv">5</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n_max =</span> <span class="dv">352</span>,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"hholds"</span>, <span class="st">"del"</span>, </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">str_c</span>(<span class="st">"income"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,<span class="at">sep=</span><span class="st">"_i"</span>),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"median_inc"</span>, <span class="st">"median_se"</span>, <span class="st">"mean_inc"</span>,<span class="st">"mean_se"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>del)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>The current year column still has identityity information on the hholds, as well as notes that need to be removed. Because identityity labels have spaces, we will need to remove those first before our typical approach to removing notes using separate is going to work.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Regex and Regexr
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://stringr.tidyverse.org/articles/regular-expressions.html">Regular expressions</a> are a critical tool for messy, real world data where you will need to search, replace, and extract information from string variables. Learning regex is tough, but <a href="https://regexr.com/">Regexer</a> makes it much easier!</p>
</div>
</div>
<div class="cell" data-hash="challenge3_solutions_cache/html/unnamed-chunk-17_d7aa9a55540b98c2b6106bd9d136f6ff">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ushh_orig<span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(year, <span class="st">"[[:alpha:]]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["year"],"name":[1],"type":["chr"],"align":["left"]},{"label":["hholds"],"name":[2],"type":["chr"],"align":["left"]},{"label":["income_i1"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["income_i2"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["income_i3"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["income_i4"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["income_i5"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["income_i6"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["income_i7"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["income_i8"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["income_i9"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["median_inc"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["median_se"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["mean_inc"],"name":[14],"type":["chr"],"align":["left"]},{"label":["mean_se"],"name":[15],"type":["chr"],"align":["left"]}],"data":[{"1":"ALL RACES","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"WHITE ALONE 24","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"WHITE 25","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"WHITE ALONE, NOT HISPANIC 24","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"WHITE, NOT HISPANIC 25","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"BLACK ALONE OR IN COMBINATION","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"BLACK ALONE 26","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"BLACK 25","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"ASIAN ALONE OR IN COMBINATION","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"ASIAN ALONE 27","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"ASIAN AND PACIFIC ISLANDER 25","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"HISPANIC (ANY RACE) 28","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now that we know how to use regular expressions to find the household identityity information, we can quickly separate out the identityity information from the years, then do the standard fill prior to removing the unneeded category rows.</p>
<p>Once that is done, we can use separate to remove the notes from the year column. Removing notes from the <em>identityity</em> column is a bit trickier, and requires regex to find cases where there is a space then at least one numeric digit</p>
<div class="cell" data-hash="challenge3_solutions_cache/html/unnamed-chunk-18_8b3918c525dac49c5aeb17540775f32d">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ushh_id<span class="ot">&lt;-</span>ushh_orig<span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">identity =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(year, <span class="st">"[[:alpha:]]"</span>) <span class="sc">~</span> year,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  ))<span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(identity)<span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(year, <span class="st">"[[:alpha:]]"</span>))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>ushh_id<span class="ot">&lt;-</span>ushh_id<span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(year, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"delete"</span>), <span class="at">sep=</span><span class="st">" "</span>)<span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">identity =</span> <span class="fu">str_remove</span>(identity, <span class="st">" [0-9]+"</span>),</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> <span class="fu">parse_number</span>(year))<span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>delete)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>Even from the detailed notes, it is difficult to fully understand what is going on with the identity variable, and whether all of the values are available in every year. A simple sanity check is to pick out several years mentioned in the notes and see if the number of households are available for all categories, and also check to see if there are specific categories that add up to the “all races” category.</p>
<div class="cell" data-hash="challenge3_solutions_cache/html/unnamed-chunk-19_4ca228e9967458ae25129fbc995e02a3">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ushh_id<span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1970</span>, <span class="dv">1972</span>, <span class="dv">1980</span>, <span class="dv">2001</span>, <span class="dv">2002</span>))<span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(identity, hholds, year)<span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from=</span>hholds, <span class="at">names_from=</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["identity"],"name":[1],"type":["chr"],"align":["left"]},{"label":["2002"],"name":[2],"type":["chr"],"align":["left"]},{"label":["2001"],"name":[3],"type":["chr"],"align":["left"]},{"label":["1980"],"name":[4],"type":["chr"],"align":["left"]},{"label":["1972"],"name":[5],"type":["chr"],"align":["left"]},{"label":["1970"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"ALL RACES","2":"111278","3":"109297","4":"82368","5":"68251","6":"64778"},{"1":"WHITE ALONE","2":"91645","3":"NA","4":"NA","5":"NA","6":"NA"},{"1":"WHITE","2":"NA","3":"90682","4":"71872","5":"60618","6":"57575"},{"1":"WHITE ALONE, NOT HISPANIC","2":"81166","3":"NA","4":"NA","5":"NA","6":"NA"},{"1":"WHITE, NOT HISPANIC","2":"NA","3":"80818","4":"68106","5":"58005","6":"NA"},{"1":"BLACK ALONE OR IN COMBINATION","2":"13778","3":"NA","4":"NA","5":"NA","6":"NA"},{"1":"BLACK ALONE","2":"13465","3":"NA","4":"NA","5":"NA","6":"NA"},{"1":"BLACK","2":"NA","3":"13315","4":"8847","5":"6809","6":"6180"},{"1":"ASIAN ALONE OR IN COMBINATION","2":"4079","3":"NA","4":"NA","5":"NA","6":"NA"},{"1":"ASIAN ALONE","2":"3917","3":"NA","4":"NA","5":"NA","6":"NA"},{"1":"ASIAN AND PACIFIC ISLANDER","2":"NA","3":"4071","4":"NA","5":"NA","6":"NA"},{"1":"HISPANIC (ANY RACE)","2":"11339","3":"10499","4":"3906","5":"2655","6":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Based on these examples, we can now confirm that the survey did not include a question about Hispanic background prior to 1092<sup>28</sup>, that only “White” and “Black” (and not “Asian”) were systematically recorded prior to 2002, and that other mentioned dates of changes are not relevant to the categories represented in the data. Additionally, we can see from the example years that it would be reasonable to create a consistent time series that collapses the “White” and “White Alone” and “Black” and “Black A labels.</p>
<p>Based on this exploratory data, one reasonable option that will streamline future analysis is to create two new variables “race” and “hispanic” as follows. :::{.callout-tip} ## Keep your original data</p>
<p>Original data that has been carefully documented can be overly detailed and broken into categories that make systematic analysis difficult. When you simplify data categories for exploratory work, keep the original data so that you can reintroduce it at the appropriate point.</p>
</div>
</div>
</div>
<div class="cell" data-hash="challenge3_solutions_cache/html/unnamed-chunk-20_b2ef8ce74731488087298363030d80ce">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ushh <span class="ot">&lt;-</span>ushh_id<span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    identity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"White"</span>, <span class="st">"White Alone"</span>) <span class="sc">~</span> <span class="st">"race_white"</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/DACSS_601_August2022_v2" data-repo-id="R_kgDOH1g84A" data-category="Announcements" data-category-id="DIC_kwDOH1g84M4CQ6Pq" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb30" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Challenge 3 Solutions"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Meredith Rolfe"</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Tidy Data: Pivoting"</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "08/18/2022"</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: false</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - challenge_3</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co">  - solution</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>,</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message=</span><span class="cn">FALSE</span>, <span class="at">cache=</span><span class="cn">TRUE</span>)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a><span class="fu">## Challenge Overview</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>Today's challenge is to:</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>1)  read in a data set, and describe the data set using both words and any supporting information (e.g., tables, etc)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>2)  anticipate the shape of pivoted data, and</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>3)  pivot the data into tidy format using <span class="in">`pivot_longer`</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>The first step in pivoting the data is to try to come up with a concrete vision of what the end product *should* look like - that way you will know whether or not your pivoting was successful.</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>One easy way to do this is to think about the dimensions of your current data (tibble, dataframe, or matrix), and then calculate what the dimensions of the pivoted data should be.</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>Suppose you have a dataset with $n$ rows and $k$ variables. In our example, 3 of the variables are used to identify a case, so you will be pivoting $k-3$ variables into a longer format where the $k-3$ variable names will move into the <span class="in">`names_to`</span> variable and the current values in each of those columns will move into the <span class="in">`values_to`</span> variable. Therefore, we would expect $n * (k-3)$ rows in the pivoted dataframe!</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>Suppose you have a dataset with $n$ rows and $k$ variables. In our example, 3 of the variables are used to identify a case, so you will be pivoting $k-3$ variables into a longer format where the $k-3$ variable names will move into the <span class="in">`names_to`</span> variable and the current values in each of those columns will move into the <span class="in">`values_to`</span> variable. Therefore, we would expect $n * (k-3)$ rows in the pivoted dataframe!</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a><span class="fu">### Find current and future data dimensions</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>Lets see if this works with a simple example.</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Example</span></span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: example1</span></span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">country =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Mexico"</span>, <span class="st">"USA"</span>, <span class="st">"France"</span>),<span class="dv">2</span>),</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a>           <span class="at">year =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1990</span>), <span class="dv">3</span>), </span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>           <span class="at">trade =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"NAFTA"</span>, <span class="st">"NAFTA"</span>, <span class="st">"EU"</span>),<span class="dv">2</span>),</span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>           <span class="at">outgoing =</span> <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean=</span><span class="dv">1000</span>, <span class="at">sd=</span><span class="dv">500</span>),</span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>           <span class="at">incoming =</span> <span class="fu">rlogis</span>(<span class="dv">6</span>, <span class="at">location=</span><span class="dv">1000</span>, </span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>                             <span class="at">scale =</span> <span class="dv">400</span>))</span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a><span class="co">#existing rows/cases</span></span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df)</span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a><span class="co">#existing columns/cases</span></span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(df)</span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a><span class="co">#expected rows/cases</span></span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df) <span class="sc">*</span> (<span class="fu">ncol</span>(df)<span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a><span class="co"># expected columns </span></span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>Or simple example has $n = 6$ rows and $k - 3 = 2$ variables being pivoted, so we expect a new dataframe to have $n * 2 = 12$ rows x $3 + 2 = 5$ columns.</span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pivot the data</span></span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Pivoted Example</span></span>
<span id="cb30-92"><a href="#cb30-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: example2</span></span>
<span id="cb30-93"><a href="#cb30-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb30-94"><a href="#cb30-94" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">pivot_longer</span>(df, <span class="at">col =</span> <span class="fu">c</span>(outgoing, incoming),</span>
<span id="cb30-95"><a href="#cb30-95" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to=</span><span class="st">"trade_direction"</span>,</span>
<span id="cb30-96"><a href="#cb30-96" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">"trade_value"</span>)</span>
<span id="cb30-97"><a href="#cb30-97" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb30-98"><a href="#cb30-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-99"><a href="#cb30-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-100"><a href="#cb30-100" aria-hidden="true" tabindex="-1"></a>Yes, once it is pivoted long, our resulting data are $12x5$ - exactly what we expected!</span>
<span id="cb30-101"><a href="#cb30-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-102"><a href="#cb30-102" aria-hidden="true" tabindex="-1"></a><span class="fu">## Animal Weights ⭐</span></span>
<span id="cb30-103"><a href="#cb30-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-104"><a href="#cb30-104" aria-hidden="true" tabindex="-1"></a>The animal weights dataset contains tabular-style data, with cells representing the average live animal weight (in kg) of 16 types of livestock for each of 9 geographic areas as defined by the <span class="co">[</span><span class="ot">Intergovernmental Panel on Climate Change (IPCC</span><span class="co">](https://www.ipcc.ch/)</span>. Livestock weights are a critical part of the <span class="co">[</span><span class="ot">Global Livestock Envrionmental Assessment Model</span><span class="co">](https://www.fao.org/fileadmin/user_upload/gleam/docs/GLEAM_1.0_Model_description.pdf)</span> used by the FAO.</span>
<span id="cb30-105"><a href="#cb30-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-108"><a href="#cb30-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-109"><a href="#cb30-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: animal1</span></span>
<span id="cb30-110"><a href="#cb30-110" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb30-111"><a href="#cb30-111" aria-hidden="true" tabindex="-1"></a>animal_weight<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"_data/animal_weight.csv"</span>)</span>
<span id="cb30-112"><a href="#cb30-112" aria-hidden="true" tabindex="-1"></a>animal_weight</span>
<span id="cb30-113"><a href="#cb30-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-114"><a href="#cb30-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-115"><a href="#cb30-115" aria-hidden="true" tabindex="-1"></a>Because the animal weights data is in tabular format, it is easy to see that $n=9$ regions (categories or cases) in the original data, and that there are $k=16$ types of livestock (categories or columns). Therefore, we expect the pivoted dataset to have $9 * 16$ = <span class="in">`r 9*16`</span> rows and 3 columns (region, animal type, and animal weight.)</span>
<span id="cb30-116"><a href="#cb30-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-117"><a href="#cb30-117" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb30-118"><a href="#cb30-118" aria-hidden="true" tabindex="-1"></a><span class="fu">## inline R code</span></span>
<span id="cb30-119"><a href="#cb30-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-120"><a href="#cb30-120" aria-hidden="true" tabindex="-1"></a>If you check out the code above, you will see that I didn't use a calculator to figure out $9*16=144$, but used inline r code like this: `<span class="in">` `</span>r</span>
<span id="cb30-121"><a href="#cb30-121" aria-hidden="true" tabindex="-1"></a>9*16` ``.</span>
<span id="cb30-122"><a href="#cb30-122" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-123"><a href="#cb30-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-124"><a href="#cb30-124" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pivot the data</span></span>
<span id="cb30-125"><a href="#cb30-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-128"><a href="#cb30-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-129"><a href="#cb30-129" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: animal2</span></span>
<span id="cb30-130"><a href="#cb30-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-131"><a href="#cb30-131" aria-hidden="true" tabindex="-1"></a>animal_weight_longer<span class="ot">&lt;-</span><span class="fu">pivot_longer</span>(animal_weight, </span>
<span id="cb30-132"><a href="#cb30-132" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">col=</span><span class="sc">-</span><span class="st">`</span><span class="at">IPCC Area</span><span class="st">`</span>,</span>
<span id="cb30-133"><a href="#cb30-133" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">names_to =</span> <span class="st">"Livestock"</span>,</span>
<span id="cb30-134"><a href="#cb30-134" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">values_to =</span> <span class="st">"Weight"</span>)</span>
<span id="cb30-135"><a href="#cb30-135" aria-hidden="true" tabindex="-1"></a>animal_weight_longer</span>
<span id="cb30-136"><a href="#cb30-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-137"><a href="#cb30-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-138"><a href="#cb30-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-139"><a href="#cb30-139" aria-hidden="true" tabindex="-1"></a>Yes, it looks like we ended up with 144 rows and 3 columns, exactly as expected!</span>
<span id="cb30-140"><a href="#cb30-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-141"><a href="#cb30-141" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb30-142"><a href="#cb30-142" aria-hidden="true" tabindex="-1"></a>#Go further</span>
<span id="cb30-143"><a href="#cb30-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-144"><a href="#cb30-144" aria-hidden="true" tabindex="-1"></a><span class="in">`stringr`</span> functions, and <span class="in">`separate`</span> from <span class="in">`tidyr`</span>, would be useful in helping split out additional infromation from the *Livestock* column.</span>
<span id="cb30-145"><a href="#cb30-145" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-146"><a href="#cb30-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-147"><a href="#cb30-147" aria-hidden="true" tabindex="-1"></a><span class="fu">## Eggs ⭐⭐/⭐⭐⭐</span></span>
<span id="cb30-148"><a href="#cb30-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-149"><a href="#cb30-149" aria-hidden="true" tabindex="-1"></a>This section covers pivoting for the organic eggs data, available in both excel and (partially cleaned) .csv format. The data reports the average price per carton paid to the farmer or producer for organic eggs (and organic chicken), reported monthly from 2004 to 20013. Average price is reported by carton type, which can vary in both size (x-large or large) and quantity (half-dozen or dozen.) </span>
<span id="cb30-150"><a href="#cb30-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-151"><a href="#cb30-151" aria-hidden="true" tabindex="-1"></a>If you are using the eggs_tidy.csv, you can skip the first section as your data is in .csv format and already partially cleaned. The first section reviews data read-in and cleaning for the <span class="in">`organicpoultry.xls`</span> file.</span>
<span id="cb30-152"><a href="#cb30-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-153"><a href="#cb30-153" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb30-154"><a href="#cb30-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-155"><a href="#cb30-155" aria-hidden="true" tabindex="-1"></a><span class="fu">### Read and Clean the data</span></span>
<span id="cb30-156"><a href="#cb30-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-157"><a href="#cb30-157" aria-hidden="true" tabindex="-1"></a>There are three sheets in the *organicpoultry.xls* workbook: one titled *Data*, one titled "Organic egg prices, 2004-13" and one with a similar title for chicken prices. While I can tell all of this from inspection, I can also use a ask R to return the sheet names for me.</span>
<span id="cb30-158"><a href="#cb30-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-159"><a href="#cb30-159" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb30-160"><a href="#cb30-160" aria-hidden="true" tabindex="-1"></a><span class="fu">## Get sheet names with `excel_sheets()`</span></span>
<span id="cb30-161"><a href="#cb30-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-162"><a href="#cb30-162" aria-hidden="true" tabindex="-1"></a>Both <span class="in">`readxl`</span> and <span class="in">`googlesheets4`</span> have a function that can return sheet names as a vector. This is really useful if you need to parse and read multiple sheets in the same workbook.</span>
<span id="cb30-163"><a href="#cb30-163" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-164"><a href="#cb30-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-167"><a href="#cb30-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-168"><a href="#cb30-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eggs1</span></span>
<span id="cb30-169"><a href="#cb30-169" aria-hidden="true" tabindex="-1"></a><span class="fu">excel_sheets</span>(<span class="st">"_data/organiceggpoultry.xls"</span>)</span>
<span id="cb30-170"><a href="#cb30-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-171"><a href="#cb30-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-172"><a href="#cb30-172" aria-hidden="true" tabindex="-1"></a>While it may seem like it would be easier to read in the individual egg prices and chicken prices, the amount of formatting introduced into the second and third sheets is pretty intimidating (see the screenshot below.) There are repeated headers to remove, a *year* column to shift, and other formatting issues. Ironically, it may be easier to read in the egg data from the *Data* sheet, with a skip of 5 (to skip the table title, etc), custom column names designed for pivoting to two categories (final section) and only reading in columns B to F.</span>
<span id="cb30-173"><a href="#cb30-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-174"><a href="#cb30-174" aria-hidden="true" tabindex="-1"></a><span class="al">![Organic Poultry Data](solution_images/organicpoultrydata.png)</span></span>
<span id="cb30-175"><a href="#cb30-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-176"><a href="#cb30-176" aria-hidden="true" tabindex="-1"></a><span class="al">![Organic Poultry Egg Prices](solution_images/organicpoultry.png)</span></span>
<span id="cb30-177"><a href="#cb30-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-178"><a href="#cb30-178" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb30-179"><a href="#cb30-179" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hard-coding Table Formats</span></span>
<span id="cb30-180"><a href="#cb30-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-181"><a href="#cb30-181" aria-hidden="true" tabindex="-1"></a>Formatted excel tables are a horrible data source, but may be the only way to get some data. If table formatting is consistent from year to year, hard-coding can be an acceptable approach. If table format is inconsistent, then more powerful tools are needed.</span>
<span id="cb30-182"><a href="#cb30-182" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-183"><a href="#cb30-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-186"><a href="#cb30-186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-187"><a href="#cb30-187" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eggs2</span></span>
<span id="cb30-188"><a href="#cb30-188" aria-hidden="true" tabindex="-1"></a>eggs_orig<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">"_data/organiceggpoultry.xls"</span>,</span>
<span id="cb30-189"><a href="#cb30-189" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sheet=</span><span class="st">"Data"</span>,</span>
<span id="cb30-190"><a href="#cb30-190" aria-hidden="true" tabindex="-1"></a>                      <span class="at">range =</span><span class="fu">cell_limits</span>(<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">2</span>),<span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">6</span>)),</span>
<span id="cb30-191"><a href="#cb30-191" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"xlarge_dozen"</span>,</span>
<span id="cb30-192"><a href="#cb30-192" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"xlarge_halfdozen"</span>, <span class="st">"large_dozen"</span>,</span>
<span id="cb30-193"><a href="#cb30-193" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"large_halfdozen"</span>)</span>
<span id="cb30-194"><a href="#cb30-194" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb30-195"><a href="#cb30-195" aria-hidden="true" tabindex="-1"></a>eggs_orig</span>
<span id="cb30-196"><a href="#cb30-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-197"><a href="#cb30-197" aria-hidden="true" tabindex="-1"></a>Sometimes there are notes in the first column of tables, so lets make sure that isn't an issue.</span>
<span id="cb30-198"><a href="#cb30-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-201"><a href="#cb30-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-202"><a href="#cb30-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eggs3</span></span>
<span id="cb30-203"><a href="#cb30-203" aria-hidden="true" tabindex="-1"></a>eggs_orig<span class="sc">%&gt;%</span></span>
<span id="cb30-204"><a href="#cb30-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(date)</span>
<span id="cb30-205"><a href="#cb30-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-206"><a href="#cb30-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-207"><a href="#cb30-207" aria-hidden="true" tabindex="-1"></a>We need to remove the "note" indicators in two of the rows. Some characters require an <span class="co">[</span><span class="ot">escape</span><span class="co">](https://cran.r-project.org/web/packages/stringr/vignettes/regular-expressions.html)</span> to be included in regular expressions, but this time it is straightforward to find " /1".</span>
<span id="cb30-208"><a href="#cb30-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-211"><a href="#cb30-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-212"><a href="#cb30-212" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eggs4</span></span>
<span id="cb30-213"><a href="#cb30-213" aria-hidden="true" tabindex="-1"></a>eggs<span class="ot">&lt;-</span>eggs_orig<span class="sc">%&gt;%</span></span>
<span id="cb30-214"><a href="#cb30-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">str_remove</span>(date, <span class="st">" /1"</span>))</span>
<span id="cb30-215"><a href="#cb30-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-216"><a href="#cb30-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-217"><a href="#cb30-217" aria-hidden="true" tabindex="-1"></a>One final step is needed to split the year variable away from the month. You will often need to separate out two variables from a single column when working with published tables, and also need to use the equivalent of dragging to fill in a normal spreadsheet. Lets look at the easiest way to fix both of these issues.</span>
<span id="cb30-218"><a href="#cb30-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-219"><a href="#cb30-219" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb30-220"><a href="#cb30-220" aria-hidden="true" tabindex="-1"></a><span class="fu">## tidyr::separate()</span></span>
<span id="cb30-221"><a href="#cb30-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-222"><a href="#cb30-222" aria-hidden="true" tabindex="-1"></a>Separate is a fantastic function for working with strings. It will break a string column into multiple new (named) columns, at the indicated separator character (e.g., "," or " "). The old variable is automatically removed, but can be left.</span>
<span id="cb30-223"><a href="#cb30-223" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-224"><a href="#cb30-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-225"><a href="#cb30-225" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb30-226"><a href="#cb30-226" aria-hidden="true" tabindex="-1"></a><span class="fu">## tidyr::fill()</span></span>
<span id="cb30-227"><a href="#cb30-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-228"><a href="#cb30-228" aria-hidden="true" tabindex="-1"></a>Fill works like dragging to fill functionality in a spreadsheet. You can choose the direction to fill.</span>
<span id="cb30-229"><a href="#cb30-229" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-230"><a href="#cb30-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-233"><a href="#cb30-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-234"><a href="#cb30-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eggs5</span></span>
<span id="cb30-235"><a href="#cb30-235" aria-hidden="true" tabindex="-1"></a>eggs<span class="ot">&lt;-</span>eggs<span class="sc">%&gt;%</span></span>
<span id="cb30-236"><a href="#cb30-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(date, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"month"</span>, <span class="st">"year"</span>), <span class="at">sep=</span><span class="st">" "</span>)<span class="sc">%&gt;%</span></span>
<span id="cb30-237"><a href="#cb30-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(year)</span>
<span id="cb30-238"><a href="#cb30-238" aria-hidden="true" tabindex="-1"></a>eggs</span>
<span id="cb30-239"><a href="#cb30-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-240"><a href="#cb30-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-241"><a href="#cb30-241" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pivot Type Only</span></span>
<span id="cb30-242"><a href="#cb30-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-243"><a href="#cb30-243" aria-hidden="true" tabindex="-1"></a>Looking at the data, we can see that each of the original 120 *cases* consist of a year-month combination (e.g., January 2004), while the *values* are the average price (in cents) of four different types of eggs (e.g., large_half_dozen, large_dozen, etc) So to tidy our data, we should create a matrix with a year-month-eggType combination, with a single price *value* for each case. </span>
<span id="cb30-244"><a href="#cb30-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-245"><a href="#cb30-245" aria-hidden="true" tabindex="-1"></a>To do this (and make our data easier to graph and analyze), we can pivot longer - changing our data from 120 rows with 6 variables (2 grouping and 4 values) to 480 rows of 4 variables (with 3 grouping variables and a single *price* value).</span>
<span id="cb30-246"><a href="#cb30-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-249"><a href="#cb30-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-250"><a href="#cb30-250" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eggs6</span></span>
<span id="cb30-251"><a href="#cb30-251" aria-hidden="true" tabindex="-1"></a>eggs_long<span class="ot">&lt;-</span>eggs<span class="sc">%&gt;%</span></span>
<span id="cb30-252"><a href="#cb30-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">contains</span>(<span class="st">"large"</span>), </span>
<span id="cb30-253"><a href="#cb30-253" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"eggType"</span>,</span>
<span id="cb30-254"><a href="#cb30-254" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"avgPrice"</span></span>
<span id="cb30-255"><a href="#cb30-255" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-256"><a href="#cb30-256" aria-hidden="true" tabindex="-1"></a>eggs_long</span>
<span id="cb30-257"><a href="#cb30-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-258"><a href="#cb30-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-259"><a href="#cb30-259" aria-hidden="true" tabindex="-1"></a>Well, that was super easy. But wait, what if you are interested in egg *size* - you want to know how much more expensive extra-large eggs are compared to large eggs. Right now, that will be annoying, as you will have to keep sorting out the egg *quantity* - whether the price is for a half_dozen or a dozen eggs. </span>
<span id="cb30-260"><a href="#cb30-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-261"><a href="#cb30-261" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pivot Size and Quantity</span></span>
<span id="cb30-262"><a href="#cb30-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-263"><a href="#cb30-263" aria-hidden="true" tabindex="-1"></a>Wouldn't it be nice if we had two new columns - *size* and *quantity* - in place of the existing *eggType* categorical variable? In other words, to have fully tidy data, we would need 4 grouping variables (year, month, size, and quantity) and the same value (price). So, we want to use pivot longer, but we will be adding **two** new category variables (for a total of 4) and this will cut the number of rows in half (to 240). </span>
<span id="cb30-264"><a href="#cb30-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-265"><a href="#cb30-265" aria-hidden="true" tabindex="-1"></a>How can we let R know what we want it to do?? Thankfully, we created pretty systematic column names for egg types in our original data, following the general pattern: <span class="in">`size-quantity`</span>. Maybe we can use this to our advantage? Working with patterns in the <span class="in">`names_sep`</span> option of the pivot functions makes it easier than you would think to pivot four existing columns into two new columns. </span>
<span id="cb30-266"><a href="#cb30-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-269"><a href="#cb30-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-270"><a href="#cb30-270" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eggs7</span></span>
<span id="cb30-271"><a href="#cb30-271" aria-hidden="true" tabindex="-1"></a>eggs_long<span class="ot">&lt;-</span> eggs<span class="sc">%&gt;%</span></span>
<span id="cb30-272"><a href="#cb30-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">contains</span>(<span class="st">"large"</span>),</span>
<span id="cb30-273"><a href="#cb30-273" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"size"</span>, <span class="st">"quantity"</span>),</span>
<span id="cb30-274"><a href="#cb30-274" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep=</span><span class="st">"_"</span>,</span>
<span id="cb30-275"><a href="#cb30-275" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"price"</span></span>
<span id="cb30-276"><a href="#cb30-276" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-277"><a href="#cb30-277" aria-hidden="true" tabindex="-1"></a>eggs_long</span>
<span id="cb30-278"><a href="#cb30-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-279"><a href="#cb30-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-280"><a href="#cb30-280" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-281"><a href="#cb30-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-282"><a href="#cb30-282" aria-hidden="true" tabindex="-1"></a><span class="fu">## Australian Marriage Ballot ⭐⭐⭐</span></span>
<span id="cb30-283"><a href="#cb30-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-284"><a href="#cb30-284" aria-hidden="true" tabindex="-1"></a>This is another tabular data source published by the <span class="co">[</span><span class="ot">Australian Bureau of Statistics</span><span class="co">](https://www.abs.gov.au/)</span> that requires a decent amount of cleaning. In 2017, Australia conducted a postal survey to gauge citizens' opinions towards same sex marriage: "Should the law be changed to allow same-sex couples to marry?" All Australian citizens are required to vote in elections, so citizens could respond in one of four ways: vote yes, vote no, vote in an unclear way, or fail to vote. (See the "Explanatory Notes" sheet for more details.)</span>
<span id="cb30-285"><a href="#cb30-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-286"><a href="#cb30-286" aria-hidden="true" tabindex="-1"></a>The provided table includes estimates of the proportion of citizens choosing each of the four options, aggregated by Federal Electoral District, which are nested within one of 8 overarching Electoral Divisions. Here is a quick image showing the original table format. </span>
<span id="cb30-287"><a href="#cb30-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-288"><a href="#cb30-288" aria-hidden="true" tabindex="-1"></a><span class="al">![Australian Marriage Data](solution_images/australiandata.png)</span></span>
<span id="cb30-289"><a href="#cb30-289" aria-hidden="true" tabindex="-1"></a><span class="fu">### Identify desired data structure</span></span>
<span id="cb30-290"><a href="#cb30-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-291"><a href="#cb30-291" aria-hidden="true" tabindex="-1"></a>Inspection reveals several critical issues to address:</span>
<span id="cb30-292"><a href="#cb30-292" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Typical long header (skip = 7)</span>
<span id="cb30-293"><a href="#cb30-293" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>No single row with variable names</span>
<span id="cb30-294"><a href="#cb30-294" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Two redundant values (count and percentage - percentage is easy to recover from complete count data)</span>
<span id="cb30-295"><a href="#cb30-295" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Total columns that are redundant (remove)</span>
<span id="cb30-296"><a href="#cb30-296" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>The sum of "Yes" and "No" votes appears to be redundant with Response Clear in columns I and J</span>
<span id="cb30-297"><a href="#cb30-297" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>District and Division are in the same column</span>
<span id="cb30-298"><a href="#cb30-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-299"><a href="#cb30-299" aria-hidden="true" tabindex="-1"></a>In this example, we are going to identify the desired structure early in the process, because clever naming of variables makes it much easier to use pivot functions. We will skip reading in redundant data (proportions and "totals" columns), and then can identify four potentially distinct pieces of information. Three grouping variables: *Division* (in column 1), *District* (also in column 1), and citizen *Response* (yes, no, unclear, and non-response), plus one value: aggregated response *Count*.</span>
<span id="cb30-300"><a href="#cb30-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-301"><a href="#cb30-301" aria-hidden="true" tabindex="-1"></a>Our basic data reading and cleaning process should therefore follow these steps:</span>
<span id="cb30-302"><a href="#cb30-302" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-303"><a href="#cb30-303" aria-hidden="true" tabindex="-1"></a><span class="ss">  1. </span>Read in data, skipping unneeded columns and renaming variables</span>
<span id="cb30-304"><a href="#cb30-304" aria-hidden="true" tabindex="-1"></a><span class="ss">  2. </span>Create *Division* and *District* variables using <span class="in">`separate()`</span> and <span class="in">`fill()`</span></span>
<span id="cb30-305"><a href="#cb30-305" aria-hidden="true" tabindex="-1"></a><span class="ss">  3. </span>pivot_longer() four response variables into 2 new *Response* and *Count* variables (double the number of rows)</span>
<span id="cb30-306"><a href="#cb30-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-307"><a href="#cb30-307" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb30-308"><a href="#cb30-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-309"><a href="#cb30-309" aria-hidden="true" tabindex="-1"></a><span class="fu">### Read Data</span></span>
<span id="cb30-310"><a href="#cb30-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-311"><a href="#cb30-311" aria-hidden="true" tabindex="-1"></a>It is best to confine serious hard-coding to the initial data read in step, to make it easy to locate and make changes or replicate in the future. So, we will use a combination of tools introduced earlier to read and reformat the data: <span class="in">`skip`</span> and col_names to read in the data, <span class="in">`select`</span> to get rid of unneeded columns, and <span class="in">`filter`</span> to get rid of unneeded rows. We also use the <span class="in">`drop_na`</span> function to filter unwanted rows.</span>
<span id="cb30-312"><a href="#cb30-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-315"><a href="#cb30-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-316"><a href="#cb30-316" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: australia1</span></span>
<span id="cb30-317"><a href="#cb30-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-318"><a href="#cb30-318" aria-hidden="true" tabindex="-1"></a>vote_orig <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"_data/australian_marriage_law_postal_survey_2017_-_response_final.xls"</span>,</span>
<span id="cb30-319"><a href="#cb30-319" aria-hidden="true" tabindex="-1"></a>           <span class="at">sheet=</span><span class="st">"Table 2"</span>,</span>
<span id="cb30-320"><a href="#cb30-320" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip=</span><span class="dv">7</span>,</span>
<span id="cb30-321"><a href="#cb30-321" aria-hidden="true" tabindex="-1"></a>           <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"District"</span>, <span class="st">"Yes"</span>, <span class="st">"del"</span>, <span class="st">"No"</span>, <span class="fu">rep</span>(<span class="st">"del"</span>, <span class="dv">6</span>), <span class="st">"Illegible"</span>, <span class="st">"del"</span>, <span class="st">"No Response"</span>, <span class="fu">rep</span>(<span class="st">"del"</span>, <span class="dv">3</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb30-322"><a href="#cb30-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"del"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb30-323"><a href="#cb30-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(District)<span class="sc">%&gt;%</span></span>
<span id="cb30-324"><a href="#cb30-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(District, <span class="st">"(Total)"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb30-325"><a href="#cb30-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_starts</span>(District, <span class="st">"</span><span class="sc">\\</span><span class="st">("</span>))</span>
<span id="cb30-326"><a href="#cb30-326" aria-hidden="true" tabindex="-1"></a>vote_orig</span>
<span id="cb30-327"><a href="#cb30-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-328"><a href="#cb30-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-329"><a href="#cb30-329" aria-hidden="true" tabindex="-1"></a><span class="fu">### Separate *District* and *Division*</span></span>
<span id="cb30-330"><a href="#cb30-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-331"><a href="#cb30-331" aria-hidden="true" tabindex="-1"></a>The most glaring remaining issue is that the administrative *Division* is not in its own column, but is on its own row within the *District* column. The following code uses case_when to make a new *Division* variable with an entry (e.g., New South Wales Division) where there is a Division name in the *District* column, and otherwise it create just an empty space. After that, <span class="in">`fill`</span> can be used to fill in empty spaces with the most recent Division name. We then filter out rows with only the title information.</span>
<span id="cb30-332"><a href="#cb30-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-335"><a href="#cb30-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-336"><a href="#cb30-336" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: australia2</span></span>
<span id="cb30-337"><a href="#cb30-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-338"><a href="#cb30-338" aria-hidden="true" tabindex="-1"></a>vote<span class="ot">&lt;-</span> vote_orig<span class="sc">%&gt;%</span></span>
<span id="cb30-339"><a href="#cb30-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Division =</span> <span class="fu">case_when</span>(</span>
<span id="cb30-340"><a href="#cb30-340" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_ends</span>(District, <span class="st">"Divisions"</span>) <span class="sc">~</span> District,</span>
<span id="cb30-341"><a href="#cb30-341" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span> ))<span class="sc">%&gt;%</span></span>
<span id="cb30-342"><a href="#cb30-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(Division, <span class="at">.direction =</span> <span class="st">"down"</span>)</span>
<span id="cb30-343"><a href="#cb30-343" aria-hidden="true" tabindex="-1"></a>vote<span class="ot">&lt;-</span> <span class="fu">filter</span>(vote,<span class="sc">!</span><span class="fu">str_detect</span>(District, <span class="st">"Division|Australia"</span>))</span>
<span id="cb30-344"><a href="#cb30-344" aria-hidden="true" tabindex="-1"></a>vote</span>
<span id="cb30-345"><a href="#cb30-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-346"><a href="#cb30-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-347"><a href="#cb30-347" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pivot_longer to tidy format</span></span>
<span id="cb30-348"><a href="#cb30-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-349"><a href="#cb30-349" aria-hidden="true" tabindex="-1"></a>Supposed we wanted to create a stacked bar chart to compare the % who votes Yes to the people who either said No or didn't vote. Or if we wanted to use division level characteristics to predict the proortion of people voting in a specific way? In both cases, we would need tidy data, which requires us to pivot longer into the original (aggregated) data format: Division, District, Response, Count. We should end up with 600 rows and 4 columns.</span>
<span id="cb30-350"><a href="#cb30-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-353"><a href="#cb30-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-354"><a href="#cb30-354" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: australia3</span></span>
<span id="cb30-355"><a href="#cb30-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb30-356"><a href="#cb30-356" aria-hidden="true" tabindex="-1"></a>vote_long<span class="ot">&lt;-</span> vote<span class="sc">%&gt;%</span></span>
<span id="cb30-357"><a href="#cb30-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb30-358"><a href="#cb30-358" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> Yes<span class="sc">:</span><span class="st">`</span><span class="at">No Response</span><span class="st">`</span>,</span>
<span id="cb30-359"><a href="#cb30-359" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Response"</span>,</span>
<span id="cb30-360"><a href="#cb30-360" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Count"</span></span>
<span id="cb30-361"><a href="#cb30-361" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-362"><a href="#cb30-362" aria-hidden="true" tabindex="-1"></a>vote</span>
<span id="cb30-363"><a href="#cb30-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-364"><a href="#cb30-364" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-365"><a href="#cb30-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-366"><a href="#cb30-366" aria-hidden="true" tabindex="-1"></a><span class="fu">## USA Households  ⭐⭐⭐⭐</span></span>
<span id="cb30-367"><a href="#cb30-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-368"><a href="#cb30-368" aria-hidden="true" tabindex="-1"></a>The excel workbook "USA Households by Total Money Income, Race, and Hispanic Origin of Householder 1967 to 2019" is clearly a table of census-type household data (e.g., Current Population Study or CPS, American Community Study or ACS, etc.) Row 3 of the workbook provides <span class="co">[</span><span class="ot">a link to more details about the origin of the data used to produce the table.</span><span class="co">](https://www2.census.gov/programs-surveys/cps/techdocs/cpsmar20.pdf)</span> </span>
<span id="cb30-369"><a href="#cb30-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-370"><a href="#cb30-370" aria-hidden="true" tabindex="-1"></a>The cases in this example are essentially year-identity groups, where I use the term identity to refer to the wide range of ways that the census can cluster racial and identity identity. While there are 12 categories in the data, many of these overlap and/or are not available in specific years. For example, one category is "All Races", and it overlaps with all other categories but cannot be easily eliminated because it isn't clear how </span>
<span id="cb30-371"><a href="#cb30-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-372"><a href="#cb30-372" aria-hidden="true" tabindex="-1"></a><span class="al">![Excel Workbook Screenshot](solution_images/us_hholds.png)</span></span>
<span id="cb30-373"><a href="#cb30-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-374"><a href="#cb30-374" aria-hidden="true" tabindex="-1"></a><span class="fu">### Identify desired data structure</span></span>
<span id="cb30-375"><a href="#cb30-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-376"><a href="#cb30-376" aria-hidden="true" tabindex="-1"></a>Inspection of the excel workbook reveals several critical features of the data. </span>
<span id="cb30-377"><a href="#cb30-377" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>column names (of a sort) are in rows 4 and 5 (skip=5 and rename)</span>
<span id="cb30-378"><a href="#cb30-378" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>first column includes *year* and *race/hispanic origin* households</span>
<span id="cb30-379"><a href="#cb30-379" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>first column appears to have notes of some sort (remove notes)</span>
<span id="cb30-380"><a href="#cb30-380" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>there are end notes starting in row 358 (n_max = 352)</span>
<span id="cb30-381"><a href="#cb30-381" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>"Total" column appears to be redundant proportion info</span>
<span id="cb30-382"><a href="#cb30-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-383"><a href="#cb30-383" aria-hidden="true" tabindex="-1"></a>The data appears to have two grouping variables (*year* and *identityity*), plus several values:</span>
<span id="cb30-384"><a href="#cb30-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-385"><a href="#cb30-385" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>a count of number of households</span>
<span id="cb30-386"><a href="#cb30-386" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>median and mean income (and associated margin of error)</span>
<span id="cb30-387"><a href="#cb30-387" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>proportion of households with hhold income in one of 9 designated ranges or brackets</span>
<span id="cb30-388"><a href="#cb30-388" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-389"><a href="#cb30-389" aria-hidden="true" tabindex="-1"></a>The final data should probably </span>
<span id="cb30-390"><a href="#cb30-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-391"><a href="#cb30-391" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb30-392"><a href="#cb30-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-393"><a href="#cb30-393" aria-hidden="true" tabindex="-1"></a><span class="fu">### Read and clean the data</span></span>
<span id="cb30-394"><a href="#cb30-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-397"><a href="#cb30-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-398"><a href="#cb30-398" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: hh1</span></span>
<span id="cb30-399"><a href="#cb30-399" aria-hidden="true" tabindex="-1"></a>income_brackets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">i1 =</span> <span class="st">"Under $15,000"</span>,</span>
<span id="cb30-400"><a href="#cb30-400" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i2 =</span> <span class="st">"$15,000 to $24,999"</span>,</span>
<span id="cb30-401"><a href="#cb30-401" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i3 =</span> <span class="st">"$25,000 to $34,999"</span>,</span>
<span id="cb30-402"><a href="#cb30-402" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i4=</span> <span class="st">"$35,000 to $49,999"</span>,</span>
<span id="cb30-403"><a href="#cb30-403" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i5 =</span> <span class="st">"$50,000 to $74,999"</span>,</span>
<span id="cb30-404"><a href="#cb30-404" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i6 =</span> <span class="st">"$75,000 to $99,999"</span>,</span>
<span id="cb30-405"><a href="#cb30-405" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i7 =</span> <span class="st">"$100,000 to $149,999"</span>,</span>
<span id="cb30-406"><a href="#cb30-406" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i8 =</span> <span class="st">"$150,000 to $199,999"</span>,</span>
<span id="cb30-407"><a href="#cb30-407" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i9 =</span> <span class="st">"$200,000 and over"</span>)</span>
<span id="cb30-408"><a href="#cb30-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-409"><a href="#cb30-409" aria-hidden="true" tabindex="-1"></a>ushh_orig <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"_data/USA Households by Total Money Income, Race, and Hispanic Origin of Householder 1967 to 2019.xlsx"</span>,</span>
<span id="cb30-410"><a href="#cb30-410" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip=</span><span class="dv">5</span>,</span>
<span id="cb30-411"><a href="#cb30-411" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n_max =</span> <span class="dv">352</span>,</span>
<span id="cb30-412"><a href="#cb30-412" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"hholds"</span>, <span class="st">"del"</span>, </span>
<span id="cb30-413"><a href="#cb30-413" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">str_c</span>(<span class="st">"income"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,<span class="at">sep=</span><span class="st">"_i"</span>),</span>
<span id="cb30-414"><a href="#cb30-414" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"median_inc"</span>, <span class="st">"median_se"</span>, <span class="st">"mean_inc"</span>,<span class="st">"mean_se"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb30-415"><a href="#cb30-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>del)</span>
<span id="cb30-416"><a href="#cb30-416" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb30-417"><a href="#cb30-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-418"><a href="#cb30-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-419"><a href="#cb30-419" aria-hidden="true" tabindex="-1"></a><span class="fu">### Clean and separate *year" column</span></span>
<span id="cb30-420"><a href="#cb30-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-421"><a href="#cb30-421" aria-hidden="true" tabindex="-1"></a>The current year column still has identityity information on the hholds, as well as notes that need to be removed. Because identityity labels have spaces, we will need to remove those first before our typical approach to removing notes using separate is going to work. </span>
<span id="cb30-422"><a href="#cb30-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-423"><a href="#cb30-423" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb30-424"><a href="#cb30-424" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regex and Regexr</span></span>
<span id="cb30-425"><a href="#cb30-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-426"><a href="#cb30-426" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Regular expressions</span><span class="co">](https://stringr.tidyverse.org/articles/regular-expressions.html)</span> are a critical tool for messy, real world data where you will need to search, replace, and extract information from string variables. Learning regex is tough, but <span class="co">[</span><span class="ot">Regexer</span><span class="co">](https://regexr.com/)</span> makes it much easier!</span>
<span id="cb30-427"><a href="#cb30-427" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-428"><a href="#cb30-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-431"><a href="#cb30-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-432"><a href="#cb30-432" aria-hidden="true" tabindex="-1"></a>ushh_orig<span class="sc">%&gt;%</span></span>
<span id="cb30-433"><a href="#cb30-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(year, <span class="st">"[[:alpha:]]"</span>))</span>
<span id="cb30-434"><a href="#cb30-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-435"><a href="#cb30-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-436"><a href="#cb30-436" aria-hidden="true" tabindex="-1"></a>Now that we know how to use regular expressions to find the household identityity information, we can quickly separate out the identityity information from the years, then do the standard fill prior to removing the unneeded category rows. </span>
<span id="cb30-437"><a href="#cb30-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-438"><a href="#cb30-438" aria-hidden="true" tabindex="-1"></a>Once that is done, we can use separate to remove the notes from the year column. Removing notes from the *identityity* column is a bit trickier, and requires regex to find cases where there is a space then at least one numeric digit</span>
<span id="cb30-439"><a href="#cb30-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-442"><a href="#cb30-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-443"><a href="#cb30-443" aria-hidden="true" tabindex="-1"></a>ushh_id<span class="ot">&lt;-</span>ushh_orig<span class="sc">%&gt;%</span></span>
<span id="cb30-444"><a href="#cb30-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">identity =</span> <span class="fu">case_when</span>(</span>
<span id="cb30-445"><a href="#cb30-445" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(year, <span class="st">"[[:alpha:]]"</span>) <span class="sc">~</span> year,</span>
<span id="cb30-446"><a href="#cb30-446" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb30-447"><a href="#cb30-447" aria-hidden="true" tabindex="-1"></a>  ))<span class="sc">%&gt;%</span></span>
<span id="cb30-448"><a href="#cb30-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(identity)<span class="sc">%&gt;%</span></span>
<span id="cb30-449"><a href="#cb30-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(year, <span class="st">"[[:alpha:]]"</span>))</span>
<span id="cb30-450"><a href="#cb30-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-451"><a href="#cb30-451" aria-hidden="true" tabindex="-1"></a>ushh_id<span class="ot">&lt;-</span>ushh_id<span class="sc">%&gt;%</span></span>
<span id="cb30-452"><a href="#cb30-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(year, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"delete"</span>), <span class="at">sep=</span><span class="st">" "</span>)<span class="sc">%&gt;%</span></span>
<span id="cb30-453"><a href="#cb30-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">identity =</span> <span class="fu">str_remove</span>(identity, <span class="st">" [0-9]+"</span>),</span>
<span id="cb30-454"><a href="#cb30-454" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> <span class="fu">parse_number</span>(year))<span class="sc">%&gt;%</span></span>
<span id="cb30-455"><a href="#cb30-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>delete)</span>
<span id="cb30-456"><a href="#cb30-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-457"><a href="#cb30-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-458"><a href="#cb30-458" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sanity check for *identity*</span></span>
<span id="cb30-459"><a href="#cb30-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-460"><a href="#cb30-460" aria-hidden="true" tabindex="-1"></a>Even from the detailed notes, it is difficult to fully understand what is going on with the identity variable, and whether all of the values are available in every year. A simple sanity check is to pick out several years mentioned in the notes and see if the number of households are available for all categories, and also check to see if there are specific categories that add up to the "all races" category.</span>
<span id="cb30-461"><a href="#cb30-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-464"><a href="#cb30-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-465"><a href="#cb30-465" aria-hidden="true" tabindex="-1"></a>ushh_id<span class="sc">%&gt;%</span></span>
<span id="cb30-466"><a href="#cb30-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1970</span>, <span class="dv">1972</span>, <span class="dv">1980</span>, <span class="dv">2001</span>, <span class="dv">2002</span>))<span class="sc">%&gt;%</span></span>
<span id="cb30-467"><a href="#cb30-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(identity, hholds, year)<span class="sc">%&gt;%</span></span>
<span id="cb30-468"><a href="#cb30-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from=</span>hholds, <span class="at">names_from=</span>year)</span>
<span id="cb30-469"><a href="#cb30-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-470"><a href="#cb30-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-471"><a href="#cb30-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-472"><a href="#cb30-472" aria-hidden="true" tabindex="-1"></a>Based on these examples, we can now confirm that the survey did not include a question about Hispanic background prior to 1092^28^, that only "White" and "Black" (and not "Asian") were systematically recorded prior to 2002, and that other mentioned dates of changes are not relevant to the categories represented in the data. Additionally, we can see from the example years that it would be reasonable to create a consistent time series that collapses the "White" and "White Alone" and "Black" and "Black A labels. </span>
<span id="cb30-473"><a href="#cb30-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-474"><a href="#cb30-474" aria-hidden="true" tabindex="-1"></a>Based on this exploratory data, one reasonable option that will streamline future analysis is to create two new variables "race" and "hispanic" as follows. </span>
<span id="cb30-475"><a href="#cb30-475" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb30-476"><a href="#cb30-476" aria-hidden="true" tabindex="-1"></a><span class="fu">## Keep your original data</span></span>
<span id="cb30-477"><a href="#cb30-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-478"><a href="#cb30-478" aria-hidden="true" tabindex="-1"></a>Original data that has been carefully documented can be overly detailed and broken into categories that make systematic analysis difficult. When you simplify data categories for exploratory work, keep the original data so that you can reintroduce it at the appropriate point.</span>
<span id="cb30-479"><a href="#cb30-479" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-480"><a href="#cb30-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-481"><a href="#cb30-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb30-482"><a href="#cb30-482" aria-hidden="true" tabindex="-1"></a>ushh <span class="ot">&lt;-</span>ushh_id<span class="sc">%&gt;%</span></span>
<span id="cb30-483"><a href="#cb30-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">case_when</span>(</span>
<span id="cb30-484"><a href="#cb30-484" aria-hidden="true" tabindex="-1"></a>    identity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"White"</span>, <span class="st">"White Alone"</span>) <span class="sc">~</span> <span class="st">"race_white"</span></span>
<span id="cb30-485"><a href="#cb30-485" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb30-486"><a href="#cb30-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-487"><a href="#cb30-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-488"><a href="#cb30-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-489"><a href="#cb30-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-490"><a href="#cb30-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-491"><a href="#cb30-491" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>